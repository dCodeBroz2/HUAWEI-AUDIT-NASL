# NASL CODE TO AUDIT HUAWEI ROUTERS/SWITCHES INSIDE NESSUS PRO

<check_type:"Huawei">

######################### MANUAL ADD ONS #########################
##################################################################
##################################################################
<custom_item>
  description : "Set 'login' header"
  info        : "A login header should be set to display any disclaimers or warnings prior to logging into the device."
  solution    : "header login information c line c"
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "header login (information|file)"
</custom_item>



<custom_item>
  description : "Set 'shell' header"
  info        : "A shell header should be set to display information or instructions that a user must know."
  solution    : "header shell information c line c"
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "header shell (information|file)"
</custom_item>


<custom_item>
  description : "Set super password"
  info        : "If rights are reconfigured, you need to run the super command to switch a user from a lower level to a higher level. When a user is switched from a lower level to a higher level, the device authenticates the user identity to prevent unauthorized users from logging in to the device. Users at a higher level can run the super password command to set an authentication password used to switch a user from a lower level to a higher level, so that the device can authenticate the user identity.
Precautions
    The target user level must be lower than or equal to the current user level.
    The entered authentication password must meet the following requirements:
        It is a string of 8 to 16 characters entered only in plain text.
        It must be a combination of at least two of the following: uppercase letters A to Z, lowercase letters a to z, digits, and special characters.
        Special characters include \" ~ ! @ # $ % ^ & * ( ) - _ = + \ | [ { } ] ; : ' \" , < . > / ? spaces.
    The password entered in interactive mode is not displayed on the screen.
    When setting the password in interactive mode, you can press CTRL+C to cancel the password setting.
    If this command is run, passwords entered by users will be saved in cipher text in the configuration file. Therefore, a configured password cannot be retrieved from the system. Keep the password safe."
  solution    : "system-view\n
super password level <level> encryption-type cipher <password>"
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "super password level"
</custom_item>


<custom_item>
  description : "Simple Password Authentication is not used."
  info        : "If a simple password is displayed in the configuration, anyone that is able to view the configuration, on system or on backup, would have access to the password.
If all user-interfaces are configured for authentication and there is a FAILED result, this could be a result of the 'user-interfaces maximum-vty' is configured for more terminals than are configured."
  solution    : "Use password cipher in all configuration files. When configuring on system, a simple password should be converted to cipher.
  Example:
# Set the local authentication password for the Virtual Teletype Terminal (VTY) user interfaces 0-4 to Huawei123$.
<Base> system-view\n
[Base] user-interface vty 0 4\n
[Base-ui-vty0-4] protocol inbound all\n
[Base-ui-vty0-4] authentication-mode password\n
[Base-ui-vty0-4] set authentication password ciper Huawei123$\n"
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "authentication password cipher"
</custom_item>


<custom_item>
  description : "User Interfaces Idle Timeout Less Than 5 Minutes"
  info        : "If a connection remains idle for a time out period, the system automatically terminates the connection. By default, the idle timeout is 5 minutes.
If all user-interfaces are configured for authentication and there is a FAILED result, this could be a result of the 'user-interfaces maximum-vty' is configured for more terminals than are configured."
  solution    : "In system view, undo or lower the idle time out for any user interfaces by:
undo idle-timeout <minutes> [<seconds>]"
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  not_expect  : "idle-timeout [0-9]"
</custom_item>


<custom_item>
  description : "Command Levels Not Changed"
  info        : "Changing the default level of a command is not recommended as some user may be unable to use the command any longer.
  Precautions:
You are advised not to change the default command level. If you need to change it, consult with professional personnel to ensure that routine operations and maintenance are not affected and security risk is avoided.
When you run this command to lower the level of a command, pay attention to relative commands in the upper-layer view of the command. If the level of commands in the upper-layer view is lower the current command level, users of the corresponding level cannot run the command for which the level is lowered because the users cannot enter the upper-layer view."
  solution    : "undo command-privilege level"
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  not_expect  : "command-privilege"
</custom_item>


<custom_item>
  description : "Review Device Info/Version for public vulnerabilities"
  info        : "Review the output of this check for Asset Inventory purposes.
Check the firmware version and its vulnerabilities."
  solution    : "upgrade firmware to the latest version when possible."
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  not_expect  : "version"
</custom_item>


<custom_item>
  description : "Set System Name"
  info        : "Default name of the device is 'Huawei', and should be changed to uniquely identify this device on the network.
   This check will look for the sysname command to verify that there was an effort to change, but will not check for uniqueness."
  solution    : "sysname <unique_name>"
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "^\s*sysname"
</custom_item>


<custom_item>
  description : "Access Control Lists (Try limiting zones, subnets, ports and ip addresses)"
  info        : "An advanced ACL defines rules to filter IPv4 packets based on source IP addresses, destination IP addresses, IP protocol types, TCP source/destination port numbers, UDP source/destination port numbers, fragment information, and time ranges.
Compared with a basic ACL, an advanced ACL is more accurate, flexible, and provides more functions. For example, if you want to filter packets based on source and destination IP addresses, configure an advanced ACL."
  solution    : "1. Check ending deny all rule.
2. Check dangerous ports to be closed.
3. Check organization’s policies are met.
Refer to following the ACL best practices basic and advanced guidelines:
  https://support.huawei.com/enterprise/en/doc/EDOC1000178177/d8968298/configuring-a-basic-acl
  \nhttps://support.huawei.com/enterprise/en/doc/EDOC1000178177/b1e74756/configuring-an-advanced-acl
  \nhttps://support.huawei.com/enterprise/en/doc/EDOC1000069520/968c3cfa/typical-acl-configuration"
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "rule [0-9].* deny"
</custom_item>


<custom_item>
  description : "Configure the password strength function."
  info        : "The system checks the password complexity when setting a user password."
  solution    : "Run the \"user-security-policy enable\" command to enable password complexity check."
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "user-security-policy enable"
</custom_item>


<custom_item>
  description : "VTY authentication security check"
  info        : "he system provides three authentication modes for a VTY user interface: AAA authentication, password authentication, and none authentication.
    AAA authentication: Users must enter both user names and passwords for login. If either a user name or a password is incorrect, the login fails.
    Password authentication: Users must enter passwords for login. Only after a user enters the correct password does the device allow the user to log in.
    None authentication: Users can directly log in without entering any information.
    If non-authentication is used, any user can be successfully authenticated without the need of entering the user name and password. Therefore, you are not advised to use non-authentication for device or network security purposes.
    Regardless of the authentication mode, the system starts the delayed login mechanism in the case of a device login failure. If the first login fails, the user can log in again 5 seconds later. The delay time is increased by 5 seconds every time a login failure occurs. The second login is delayed to 10 seconds, and the third login is delayed to 15 seconds."
  solution    : "Configure AAA authentication.
    Run system-view

    The system view is displayed.
    Run user-interface vty first-ui-number [ last-ui-number ]

    The VTY user interface view is displayed.
    Run protocol inbound { all | telnet }

    The VTY user interface is configured to support the Telnet protocol.
    By default, a VTY user interface supports the SSH protocol.
    Run authentication-mode aaa

    The authentication mode is set to AAA authentication.
    Run quit

    Exit the VTY user interface view.
    Run aaa

    The AAA view is displayed.
    Run local-user user-name password { cipher | irreversible-cipher } password

    A local user account is created and a password is configured.
    Run local-user user-name service-type telnet

    The access type of the local user is set to Telnet.
    Run quit

    Exit the AAA view.

Configure password authentication.
    Run system-view

    The system view is displayed.
    Run user-interface vty first-ui-number [ last-ui-number ]

    The VTY user interface view is displayed.
    Run protocol inbound { all | telnet }

    The VTY user interface is configured to support the Telnet protocol.
    By default, a VTY user interface supports the SSH protocol.
    Run authentication-mode password

    The authentication mode is set to password authentication.
    Run set authentication password [ cipher password ]

    An authentication password is set."
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "authentication-mode (password|aaa|hwtacacs|local|radius)"
</custom_item>


<custom_item>
  description : "Do not use insecure algorithms"
  info        : "The following algorithms should not be used anywhere in the configuration (DES, MD5, CRC).
Secure: AES, SHA2

Insecure: DES, MD5, CRC"
  solution    : "Encryption Algorithms : AES (SECURE), DES (INSECURE)

Hash Algorithms : SHA2 (SECURE), MD5 (INSECURE)

Software Check : SHA2 (SECURE), CRC (INSECURE)

Refer to:
https://support.huawei.com/enterprise/br/doc/EDOC1100082539/b5a1fe51/ssh-server-secure-algorithms-cipher"
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  not_expect  : "(md5|crc)"
</custom_item>


<custom_item>
  description : "Setting a Master Key"
  info        : "A master key is used by a device to encrypt data, safeguarding data transmission.
A fixed default master key is provided before device delivery. In actual network environments, the default master key may be stolen or cracked. Administrators can manually change master keys as required to improve data security."
  solution    : "[این مورد ممکن است تاثیر بر روی سرویس داشته باشد و حتما با مشاوره انجام گردد].
Set a user-defined master key.
<HUAWEI> set master-key"
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "master-key"
</custom_item>


<custom_item>
  description : "Security display"
  info        : "Protocols have different security performances, and some protocols may have security risks. Run the display security risk command to identify security risks in the system. Then clear the security risks according to the repair action in the command output. For example, if SNMPv1 is configured, the display security risk command output will prompt for the use of SNMPv3."
  solution    : ""
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  not_expect  : "security risk"
</custom_item>


<custom_item>
  description : "List of Default Accounts and Default Passwords"
  info        : "Check the default username and passwords to be changed on Huawei devices.
# usernames :
1. Check console password\n
2. root\n
3. ftpvrpv8\n
4. drv\n
5. ftpvrpv8\n
# passwords:
1. vrpv8@huawei.com\n
2. WWW@HUAWEI\n
3. Changeme_123\n"
  solution    : "Change all the default username and passwords."
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  not_expect  : "(root|ftpvrpv8|drv|ftpvrpv8)"
</custom_item>


<custom_item>
  description : "Disabling response to ICMP packets"
  info        : "Device is at the edge of the network. Network attackers often use ICMP packets to detect the internal structure of the network. The identity of the Device must be hidden by disabling response to ICPM packets to ensure the security of the Device and prevent unauthorized users from attacking the Device."
  solution    : "system-view
  
undo icmp name echo receive

undo icmp echo receive

undo icmp echo-reply receive

commit"
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "undo icmp (name echo|echo|echo-reply) receive"
</custom_item>


<custom_item>
  description : "BGP MD5 authentication"
  info        : "BGP uses TCP as a transmission protocol, and BGP considers a packet valid as long as the source IP address, destination IP address, source port, destination port, and TCP sequence number of the packet are correct. Most parameters in a packet can be easily obtained by attackers. Therefore, to protect BGP from attacks, use MD5 authentication over TCP between BGP peers to reduce the possibility of attacks. The simple text passwords configured on both ends must be the same. If the interval between the configuration completions of the two devices is greater than hold-time, the peer relationship is interrupted. Otherwise, the peer relationship is not interrupted.
To prevent an MD5 password configured on the BGP peers from being decrypted, change the MD5 password periodically.
Configuring MD5 is not recommended when high security is required."
  solution    : " Configure MD5 authentication.
An MD5 authentication password is configured for TCP connections, and TCP
implements MD5 authentication of BGP. If authentication fails, no TCP
connections can be established.
a.
Run system-view
The system view is displayed.
b.
Run bgp as-number
The BGP view is displayed.
c.
Run peer { ipv4-address | group-name } password { cipher cipher-
password | simple simple-password }
An MD5 authentication password is set.
An MD5 authentication password can be set in either ciphertext or
cleartext:
▪ cipher cipher-password indicates that a password is set using a
ciphertext string.
▪ simple simple-password indicates that a password is set using a
cleartext string.
● The password must be at least eight characters long and contains at least two
of the following character types: uppercase letters, lowercase letters, digits,
and special characters.
● For security purposes, you are advised to specify the ciphertext mode and to
change the password periodically. If this command is run in the BGP view, the
configuration also takes effect in an extended BGP address family view
because they use the same TCP connection. BGP MD5 authentication and BGP
keychain authentication are mutually exclusive.
d.
Run commit
The configuration is committed.
  Refer to : 
  https://support.huawei.com/enterprise/en/doc/EDOC1100146591/4003eaff/improving-bgp-security"
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "peer.*password (cipher|simple)"
</custom_item>


<custom_item>
  description : "BGP keychain authentication"
  info        : "Configure keychain authentication on both ends of a BGP peer relationship. In addition, the configured keychains must use the same encryption algorithm and password so that TCP connections can be set up, and BGP messages can be exchanged properly."
  solution    : "Refer to : 
  https://support.huawei.com/enterprise/en/doc/EDOC1100146591/4003eaff/improving-bgp-security"
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "peer.*keychain"
</custom_item>


<custom_item>
  description : "BGP GTSM Security"
  info        : "GTSM prevents attacks through TTL detection. An attacker simulates real BGP packets and sends the packets in a large quantity to the router. After receiving the packets, an interface board of the router directly sends the packets to the BGP module of the control plane if the interface board finds that the packets are sent by the local router, without checking the validity of the packets. The control plane of the router needs to process the \"legal\" packets. As a result, the system becomes abnormally busy and the CPU usage is high.
GTSM protects the router by checking whether the TTL value in an IP packet header is within a pre-defined range to enhance the system security."
  solution    : "Refer to following :
  https://support.huawei.com/enterprise/en/doc/EDOC1100055025/d8639794/configuring-bgp-gtsm"
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "valid-ttl-hops"
</custom_item>


<custom_item>
  description : "BGP RPKI"
  info        : "When an RPKI server is available on the network and you want to validate the origin ASs of BGP routes, configure RPKI on a client to accept only the routes that originate from the specified ASs. In addition, you can apply the validation result to BGP route selection to ensure that hosts in the local AS can securely communicate with hosts in other ASs.
For the RPKI function to take effect, you need to start RPKI and configure RPKI session parameters and apply the BGP origin AS validation result to route selection.
GTSM supports only unicast addresses; therefore, GTSM must be configured on all the routers configured with routing protocols."
  solution    : "Refer to the below :
  https://support.huawei.com/enterprise/en/doc/EDOC1100055018/36627f51/improving-bgp-security#dc_vrp_bgp_cfg_3099"
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "rpki"
</custom_item>


<custom_item>
  description : "BGP BMP"
  info        : "The BGP Monitoring Protocol (BMP) is designed to monitor BGP running status, such as BGP peer relationship establishment and termination and route updates.
Without BMP, manual query is required if you want to know about BGP running status.
With BMP, a router can be connected to a monitoring server and configured to report BGP running statistics to the server for monitoring, which improves the network monitoring efficiency.
BMP Messages

Routers send BMP packets carrying Initiation, Peer Up Notification (PU), Route Monitoring (RM), Peer Down Notification (PD), Status Report (SR), or Termination messages to the monitoring server to report BGP running statistics. The functions of these messages are listed as follows:
    Initiation message: Reports to the monitoring server such information as the router vendor and its software version.
    PU message: Notifies the monitoring server that a BGP peer relationship has been established.
    RM message: Sends to the monitoring server all routes received from BGP peers and notifies the server of route addition or deletion in real time.
    PD message: Notifies the monitoring server that a BGP peer has been disconnected.
    SR message: Reports router running statistics to the monitoring server.
    Termination message: Reports to the monitoring server the cause of BMP session termination.
    
    BMP facilitates the monitoring of BGP running status and reports security threats in real time so that preventive measures can be taken promptly."
  solution    : "Refer to :
  https://support.huawei.com/enterprise/en/doc/EDOC1100146591/fef8827b/configuring-bmp"
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "bmp"
</custom_item>


<custom_item>
  description : "BGP TLS authentication"
  info        : "The Secure Sockets Layer (SSL) protocol protects data privacy based on the Internet. It allows a client and a server to communicate in a way designed to prevent eavesdropping. Specifically, to ensure data transmission security on a network, a peer or peer group needs to be configured as an SSL client using the peer ssl-policy role client or as a server using the peer ssl-policy role server command, and the SSL data encryption, identity authentication, and message integrity verification mechanisms need to be used."
  solution    : "Enabling SSL/TLS Authentication for BGP

To ensure data transmission security on a network, SSL/TLS authentication can be enabled for BGP message encryption.
Procedure

    Run system-view

    The system view is displayed.
    Run ssl policy policy-name

    An SSL policy is created, and the SSL policy view is displayed.
    For details about the configuration in the SSL policy view, see Configuring and Binding an SSL Policy.
    Run quit

    Return to the system view.
    Run bgp { as-number-plain | as-number-dot }

    The BGP view is displayed.
    To configure SSL/TLS authentication for BGP, perform the following steps (no sequential order) on the client and server (the priority of the configuration on a peer is higher than that of the configuration on the peer group):
        To configure a peer or peer group as an SSL client or server, run the peer { group-name | ipv4-address } ssl-policyrole { client | server } command.
        To apply the SSL policy to the SSL client or server, run the peer { group-name | ipv4-address } ssl-policyname ssl-policy-name command.
        To enable SSL/TLS authentication, run the peer { group-name | ipv4-address } ssl-server certificate command.
        This operation can be performed only on the server.
    Run commit

    The configuration is committed.
Verifying the Configuration

After enabling SSL/TLS authentication for BGP, verify the configuration.
Run the display bgp peer [ ipv4-address ] verbose command to check the authentication information of BGP peers.
  Refer to :
  https://support.huawei.com/enterprise/en/doc/EDOC1100146876/4003eaff/improving-bgp-security#EN-US_TASK_0172366289"
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "(ssl-policyname|ssl-policyrole)"
</custom_item>


<custom_item>
  description : "Configure LDP MD5 authentication"
  info        : "MD5 authentication can be configured for a TCP connection over which an LDP session is established, improving security. Note that the peers of an LDP session can be configured with different encryption modes, but must be configured with a single password.
The MD5 algorithm is easy to configure and generates a single password which can be changed only manually. MD5 authentication applies to the network requiring short-period encryption.
Keychain authentication and MD5 authentication cannot be both configured on a single LDP peer.
LDP authentication configurations are prioritized in descending order: for a single peer, for a specified peer group, for all peers. Keychain and MD5 configurations of the same priority are mutually exclusive. Keychain or MD5 authentication can be configured simultaneously for a specified LDP peer, for this LDP peer in a specified peer group, and for all LDP peers. The configuration with a higher priority takes effect. For example, if MD5 authentication is configured for Peer1 and then keychain authentication is configured for all LDP peers, MD5 authentication takes effect on Peer1. Keychain authentication takes effect on other peers."
  solution    : "Refer to :
  https://support.huawei.com/enterprise/en/doc/EDOC1100058386/9b7c066d/configuring-ldp-security-features"
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprise/en/doc/EDOC1100058386/9b7c066d/configuring-ldp-security-features"
  expect  : "md5-password"
</custom_item>


<custom_item>
  description : "Configure LDP keychain authentication"
  info        : "MD5 authentication can be configured for a TCP connection over which an LDP session is established, improving security. Note that the peers of an LDP session can be configured with different encryption modes, but must be configured with a single password.
The MD5 algorithm is easy to configure and generates a single password which can be changed only manually. MD5 authentication applies to the network requiring short-period encryption.
Keychain authentication and MD5 authentication cannot be both configured on a single LDP peer.
LDP authentication configurations are prioritized in descending order: for a single peer, for a specified peer group, for all peers. Keychain and MD5 configurations of the same priority are mutually exclusive. Keychain or MD5 authentication can be configured simultaneously for a specified LDP peer, for this LDP peer in a specified peer group, and for all LDP peers. The configuration with a higher priority takes effect. For example, if MD5 authentication is configured for Peer1 and then keychain authentication is configured for all LDP peers, MD5 authentication takes effect on Peer1. Keychain authentication takes effect on other peers."
  solution    : "Refer to :
  https://support.huawei.com/enterprise/en/doc/EDOC1100058386/9b7c066d/configuring-ldp-security-features"
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprise/en/doc/EDOC1100058386/9b7c066d/configuring-ldp-security-features"
  expect  : "authentication key-chain"
</custom_item>


<custom_item>
  description : "Configure the LDP GTSM."
  info        : "The GTSM checks TTL values to verify packets and defends devices against attacks. LDP peers with the GTSM and a valid TTL range configured check TTLs in LDP packets exchanged between them. If the TTL in an LDP packet is out of the valid range, this LDP message is considered invalid and discarded.
The GTSM defends against CPU-based attacks initiated using a great number of forged packets and protects upper-layer protocols"
  solution    : "a. Run system-view
  
The system view is displayed.
b. Run mpls ldp

The MPLS-LDP view is displayed.
c. Run gtsm peer ip-address valid-ttl-hops hops

The LDP GTSM is configured.
hops is the maximum number of valid hops permitted by the GTSM. If a TTL value carried in a received packet is in a specified range of [255 - hops + 1, 255], the packet is accepted; if the TTL value is out of the range, the packet is discarded.
d. Run commit

Refer to :
https://support.huawei.com/enterprise/en/doc/EDOC1100055025/af64a702/configuring-ldp-gtsm"
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "gtsm peer.*valid-ttl-hops"
</custom_item>


<custom_item>
  description : "MPLS RSVP"
  info        : "RSVP transmits packets using raw IP, which does not ensure security. In raw IP, packets are easily tampered with, and devices can be easily attacked. Digests of RSVP messages are verified to protect them from being tampered with and forgery attacks, enhancing network reliability and security.
The most common attacks and prevention methods are as follows:
1. Replay attacks

2. Error packet attacks"
  solution    : "Configure RSVP key authentication in neighbor address-based mode.
a. Run system-view

b. Run interface interface-type interface-number

c. Run mpls rsvp-te authentication { { cipher | plain } auth-key | keychain keychain-name }

d. Run commit

Configure RSVP key authentication in neighbor-based mode.
a. Run system-view

The system view is displayed.
b. Run mpls

The MPLS view is displayed.
c. Run mpls rsvp-te peer peer-address

The RSVP neighbor view is displayed.
d. Run mpls rsvp-te authentication { { cipher | plain } auth-key | keychain keychain-name }

The key for RSVP authentication is configured.
HMAC-MD5 or keychain authentication can be configured based on the selected parameter:
cipher: HMAC-MD5 authentication is used, and a key is displayed in ciphertext.
plain: HMAC-MD5 authentication is used, and a key is displayed in simple text.
keychain: Keychain authentication is used, and a globally configured keychain is referenced."
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "mpls rsvp"
</custom_item>


<custom_item>
  description : "MPLS PCEP"
  info        : "Security Policy

    PCEP keychain authentication :
    Keychain is an enhanced encryption algorithm. It calculates a digest for a piece of information to prevent PCEP packets from being tampered with.
    During keychain authentication, a group of passwords is defined to form a password string, and each password is assigned encryption and decryption algorithms, for example, SHA-2, and an expiration period. When sending or receiving a packet, the system selects a valid password based on the user's configuration. Then, within the lifetime of the password, the system performs the encryption algorithm matching the password to encrypt a packet before sending it. Alternatively, the system performs the decryption algorithm matching the password to decrypt a packet before accepting it. In addition, the system can automatically use a new password after the previous password expires, preventing the password from being decrypted.
    The password of keychain authentication, the encryption and decryption algorithms, and the expiration period of the password can be configured separately on a keychain configuration node. A keychain configuration node at least requires one password and has the encryption and decryption algorithms specified.
    PCEP session authentication can be configured to improve network security and defend against attacks. Keychain authentication can be configured when a session is established between the PCE server and client.
    PCEP TLS :
    TLS is an SSL-based security protocol that ensures data integrity and confidentiality. It prevents the communication between the client and server from being eavesdropped.
    TLS authentication can be configured when a session is established between the PCE server and client to improve network security and prevent network attacks.
    PCEP whitelist :
    The application layer association module checks protocol packets to be sent to the CPU and sends protocol packets that match the whitelist at a high rate to the CPU. The PCEP whitelist feature is enabled by default and does not need to be configured."
  solution    : "Procedure

    Configure PCEP keychain authentication.
    Before configuring PCEP keychain authentication, configure keychain globally. For details, see NE40E Configuration Guide - Security.
        Run system-view

        The system view is displayed.
        Run pce-client

        The PCE client view.
        Run connect-server ip-address

        A candidate server is specified.
        Run authentication_keychain keychain-name

        Keychain authentication is configured for PCEP session established between the PCE client and servers.
        Run commit

        The configuration is committed.
    Configure PCEP TLS authentication.
        Run system-view

        The system view is displayed.
        Run ssl policy policy-name

        An SSL policy is created and the SSL policy view is displayed.
        Run ssl minimum version { tls1.1 | tls1.2 | tls1.3 }

        The minimum SSL version is set for the current SSL policy.
        For details about other configurations in the SSL policy view, see section \"Configuring and Binding an SSL Policy\" of chapter \"User Login Configuration\" in NE40E Configuration Guide - Basic Configuration.
        Run quit

        Return to the system view.
        Run pce-client

        The PCE client view.
        Run connect-server ip-address

        A candidate server is specified.
        Run bind ssl-policy policy-name

        An SSL policy is specified for the PCE client.
        Run commit

        The configuration is committed."
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprise/en/doc/EDOC1100146884/3a1d1df9/control-plane#EN-US_TASK_0194851177"
  expect  : "pce-client"
</custom_item>


<custom_item>
  description : "Configuring OSPF/OSPFv3 Authentication"
  info        : "OSPF/OSPFv3 packet authentication

OSPF/OSPFv3 supports packet authentication. Only OSPF/OSPFv3 packets that are authenticated can be received. If packets fail to be authenticated, a neighbor relationship cannot be established. When area authentication is used, all the routers in an area must have the same area authentication mode and password. Interface authentication is implemented by setting an authentication mode and password between neighboring routers. Interface authentication takes precedence over area authentication.
OSPFv3 IPsec

Relevant standards(Authentication/Confidentiality for OSPFv3) define the use of the IP Security (IPsec) mechanism to authenticate OSPFv3 packets.
    Confidentiality: ESP is used to provide confidentiality. When confidentiality is enabled, a device discards the OSPFv3 packets that are not protected with ESP and the packets that fail confidentiality checks.
    Data authentication: When OSPFv3 authentication is enabled, a device discards the OSPFv3 packets that are not protected with AH or ESP and the packets that fail authentication checks.
All OSPFv3 instances running over the same interface use the same SA.
OSPFv3 starts sending packets using IPsec authentication and notifies the lower layers to check received packets with IPsec authentication. The lower layers will check all the received packets, and the packets which fail the check will be discarded silently.
Attack Methods

OSPF
Packets are often forged to attack OSPF on the network. Measures, such as MD5 authentication, can be taken to identify and discard these packets.
An attacker may use the following methods to initiate attacks:
    Changes the aging time of a packet to the maximum aging time so that all routers flush this packet.
    Advertises the LSAs with valid Max Sequence Numbers or packets similar to valid LSAs.
    Changes the sequence number when a peer router restarts and resets the state of the encryption sequence number.
    Changes peer list information in a Hello packet.
OSPFv3

    DoS attacks

    Routers can be subjected to DoS attacks by pumping OSPFv3 protocol packets from random sources. These packets will be processed by an interface board and sent to a main control board on which they will be dropped by OSPFv3. This wastes bandwidth and CPU resources and reduces system performance.
    Injection of bad routing information

    OSPFv3 will accept any packet from a valid source. It may be possible to attack the device with invalid or incorrect routing information in OSPFv3 packets. With this information the calculated routing database may not be correct, which results in network failures. OSPFv3-IPsec authentication can be used to prevent this problem. When IPsec is configured for OSPFv3 on both communicating neighbors, OSPFv3 will process packets only if the packets are authenticated, which prevents OSPFv3 from accepting incorrect routing data from unauthenticated neighbors."
  solution    : "Refer to : 
  https://support.huawei.com/enterprise/en/doc/EDOC1100125841/3a1d1df9/control-plane#EN-US_CONCEPT_0192251884"
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprise/en/doc/EDOC1100125841/3a1d1df9/control-plane#EN-US_CONCEPT_0192251884"
  expect  : "(ospf|ospfv3) authentication"
</custom_item>


<custom_item>
  description : "Configure OSPF area authentication."
  info        : "
Relevant standards(Authentication/Confidentiality for OSPFv3) define the use of the IP Security (IPsec) mechanism to authenticate OSPFv3 packets.
    Confidentiality: ESP is used to provide confidentiality. When confidentiality is enabled, a device discards the OSPFv3 packets that are not protected with ESP and the packets that fail confidentiality checks.
    Data authentication: When OSPFv3 authentication is enabled, a device discards the OSPFv3 packets that are not protected with AH or ESP and the packets that fail authentication checks.
All OSPFv3 instances running over the same interface use the same SA.
OSPFv3 starts sending packets using IPsec authentication and notifies the lower layers to check received packets with IPsec authentication. The lower layers will check all the received packets, and the packets which fail the check will be discarded silently.
Attack Methods

OSPF
Packets are often forged to attack OSPF on the network. Measures, such as MD5 authentication, can be taken to identify and discard these packets.
An attacker may use the following methods to initiate attacks:
    Changes the aging time of a packet to the maximum aging time so that all routers flush this packet.
    Advertises the LSAs with valid Max Sequence Numbers or packets similar to valid LSAs.
    Changes the sequence number when a peer router restarts and resets the state of the encryption sequence number.
    Changes peer list information in a Hello packet.
OSPFv3

    DoS attacks

    Routers can be subjected to DoS attacks by pumping OSPFv3 protocol packets from random sources. These packets will be processed by an interface board and sent to a main control board on which they will be dropped by OSPFv3. This wastes bandwidth and CPU resources and reduces system performance.
    Injection of bad routing information

    OSPFv3 will accept any packet from a valid source. It may be possible to attack the device with invalid or incorrect routing information in OSPFv3 packets. With this information the calculated routing database may not be correct, which results in network failures. OSPFv3-IPsec authentication can be used to prevent this problem. When IPsec is configured for OSPFv3 on both communicating neighbors, OSPFv3 will process packets only if the packets are authenticated, which prevents OSPFv3 from accepting incorrect routing data from unauthenticated neighbors."
  solution    : "Run system-view

The system view is displayed.

Run ospf [ process-id ]

The OSPF process view is displayed.

Run area area-id

The OSPF area view is displayed.

Run any of the following commands to configure an authentication mode for the OSPF area as needed:

To configure simple authentication for the OSPF area, run:

authentication-mode simple [ [ plain ] plain-text | [ cipher ] cipher-text ]
To configure ciphertext authentication for the OSPF area, run:

authentication-mode { md5 | hmac-md5 | hmac-sha256 } [ key-id { plain plain-text | [ cipher ] cipher-text } ]
To configure keychain authentication for the OSPF area, run:

authentication-mode keychain keychain-name

Before using keychain authentication, run the keychain command to create a keychain. Then, run the key-id, key-string, and algorithm commands to configure a key ID, a password, and an authentication algorithm, respectively, for this keychain. If a keychain or its parameters are not configured, OSPF authentication fails.

For the sake of security, using the HMAC-SHA256 algorithm rather than the MD5 and HMAC-MD5 algorithm is recommended.

Run commit

The configuration is committed."
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprise/en/doc/EDOC1100125841/3a1d1df9/control-plane#EN-US_CONCEPT_0192251884"
  expect  : "authentication-mode.*(plain|cipher)"
</custom_item>


<custom_item>
  description : "Configure OSPFv3 area authentication."
  info        : "
Relevant standards(Authentication/Confidentiality for OSPFv3) define the use of the IP Security (IPsec) mechanism to authenticate OSPFv3 packets.
    Confidentiality: ESP is used to provide confidentiality. When confidentiality is enabled, a device discards the OSPFv3 packets that are not protected with ESP and the packets that fail confidentiality checks.
    Data authentication: When OSPFv3 authentication is enabled, a device discards the OSPFv3 packets that are not protected with AH or ESP and the packets that fail authentication checks.
All OSPFv3 instances running over the same interface use the same SA.
OSPFv3 starts sending packets using IPsec authentication and notifies the lower layers to check received packets with IPsec authentication. The lower layers will check all the received packets, and the packets which fail the check will be discarded silently.
Attack Methods

OSPF
Packets are often forged to attack OSPF on the network. Measures, such as MD5 authentication, can be taken to identify and discard these packets.
An attacker may use the following methods to initiate attacks:
    Changes the aging time of a packet to the maximum aging time so that all routers flush this packet.
    Advertises the LSAs with valid Max Sequence Numbers or packets similar to valid LSAs.
    Changes the sequence number when a peer router restarts and resets the state of the encryption sequence number.
    Changes peer list information in a Hello packet.
OSPFv3

    DoS attacks

    Routers can be subjected to DoS attacks by pumping OSPFv3 protocol packets from random sources. These packets will be processed by an interface board and sent to a main control board on which they will be dropped by OSPFv3. This wastes bandwidth and CPU resources and reduces system performance.
    Injection of bad routing information

    OSPFv3 will accept any packet from a valid source. It may be possible to attack the device with invalid or incorrect routing information in OSPFv3 packets. With this information the calculated routing database may not be correct, which results in network failures. OSPFv3-IPsec authentication can be used to prevent this problem. When IPsec is configured for OSPFv3 on both communicating neighbors, OSPFv3 will process packets only if the packets are authenticated, which prevents OSPFv3 from accepting incorrect routing data from unauthenticated neighbors."
  solution    : "a.
Run system-view
The system view is displayed.
b.
Run ospfv3 [ process-id ]
The OSPFv3 process view is displayed.
c.
Run area area-id
The OSPFv3 area view is displayed.
d.
Run authentication-mode hmac-sha256 key-id key-id { plain plain-text
| [ cipher ] cipher-text }
OSPFv3 area authentication is configured.
If you use OSPFv3 area authentication, authentication and password
configurations on all ME devices in the same area must be the same.
e.
Run commit
The configuration is committed."
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprise/en/doc/EDOC1100125841/3a1d1df9/control-plane#EN-US_CONCEPT_0192251884"
  expect  : "authentication-mode hmac-sha256 key-id.*(plain|cipher)"
</custom_item>


<custom_item>
  description : "Configure OSPFv3 process authentication."
  info        : "When configuring an authentication password, select the ciphertext mode because the password is saved in configuration files in simpletext if you select simpletext mode, which has a high risk. To ensure device security, change the password periodically."
  solution    : "Run system-view
The system view is displayed.

Run ospfv3 [ process-id ]
The OSPFv3 process view is displayed.

Run authentication-mode { hmac-sha256 key-id key-id { plain plain-text | [ cipher ] cipher-text } } [ instance-id instance-id ]
OSPFv3 process authentication is configured.
Run commit
The configuration is committed."
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprise/en/doc/EDOC1100125841/3a1d1df9/control-plane#EN-US_CONCEPT_0192251884"
  expect  : "authentication-mode hmac-sha256 key-id"
</custom_item>



<custom_item>
  description : "Configure IS-IS area authentication."
  info        : "Security Policy

IS-IS authentication encrypts IS-IS packets by adding the authentication field to packets to improve network security. When receiving IS-IS packets from a remote router, the local router discards the packets if they contain authentication passwords different from the authentication password configured using the area-authentication-mode command. This protects the local router.
Attack Methods

Denial of error packets: Attackers can get correct Hello packets or link state packets from a network, forge attack packets with identifiable IS-IS packets, and send these packets to routers. Although routers can identify and discard these attack packets based on authentication information, routers may also discard correct packets because they cannot immediately process these packets. This affects network stability."
  solution    : "Refer to :
  https://support.huawei.com/enterprise/en/doc/EDOC1100125841/3a1d1df9/control-plane#EN-US_TASK_0192251886"
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprise/en/doc/EDOC1100125841/3a1d1df9/control-plane#EN-US_TASK_0192251886"
  expect  : "area-authentication-mode"
</custom_item>


<custom_item>
  description : "Configure IS-IS routing domain authentication."
  info        : "Security Policy

IS-IS authentication encrypts IS-IS packets by adding the authentication field to packets to improve network security. When receiving IS-IS packets from a remote router, the local router discards the packets if they contain authentication passwords different from the authentication password configured using the area-authentication-mode command. This protects the local router.
Attack Methods

Denial of error packets: Attackers can get correct Hello packets or link state packets from a network, forge attack packets with identifiable IS-IS packets, and send these packets to routers. Although routers can identify and discard these attack packets based on authentication information, routers may also discard correct packets because they cannot immediately process these packets. This affects network stability."
  solution    : "Refer to :
  https://support.huawei.com/enterprise/en/doc/EDOC1100125444/155674dc/is-is-configuration"
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprise/en/doc/EDOC1100125444/155674dc/is-is-configuration"
  expect  : "area-authentication-mode"
</custom_item>


<custom_item>
  description : "Configure IS-IS interface authentication."
  info        : "Security Policy

IS-IS authentication encrypts IS-IS packets by adding the authentication field to packets to improve network security. When receiving IS-IS packets from a remote router, the local router discards the packets if they contain authentication passwords different from the authentication password configured using the area-authentication-mode command. This protects the local router.
Attack Methods

Denial of error packets: Attackers can get correct Hello packets or link state packets from a network, forge attack packets with identifiable IS-IS packets, and send these packets to routers. Although routers can identify and discard these attack packets based on authentication information, routers may also discard correct packets because they cannot immediately process these packets. This affects network stability."
  solution    : "Refer to :
  https://support.huawei.com/enterprise/en/doc/EDOC1100125444/155674dc/is-is-configuration"
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprise/en/doc/EDOC1100125444/155674dc/is-is-configuration"
  expect  : "isis authentication-mode"
</custom_item>


<custom_item>
  description : "Configuring VRRP Authentication"
  info        : "Security Policy

    Protocol security policies:
        Authentication mode: VRRP supports simple authentication and HAMC-MD5 authentication. VRRP also supports authentication exemption.
        Packet check: VRRP checks the backup group ID, checksum, TTL, version number, packet type, timer, number of virtual addresses, virtual address, and packet length.
    System security policies:
    Attack packet suppression: If a device receives more than 20 packets within a specified period of time or receives packets originating from itself, the device discards the packets.
Attack Methods

    Attackers send a large number of packets within a short period of time.
    VRRP packets that do not meet packet verification conditions in a VRRP security policy are constructed to attack a device."
  solution    : "Configuration and Maintenance Methods

    Authentication mode: Authentication exemption, simple authentication, or MD5 authentication can be used. In simple authentication, a password can be saved in simple text or ciphertext. In MD5 authentication, a password is saved in ciphertext by default.
    Packet check: This function is supported by default and requires no additional configuration.
Configuration and Maintenance Suggestions

Authentication mode: MD5 authentication is recommended to enhance security."
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "vrrp"
</custom_item>


<custom_item>
  description : "Configure PIM neighbor filtering."
  info        : "Security Policy

    PIM neighbor filtering

    ACL rules can be configured on interfaces to filter received Hello packets. Neighbor relationships can be established only after packet filtering.
    When there are a large number of malicious Hello packets, configure rules on interfaces so that the interfaces only allow specified Hello packets and discard malicious Hello packets.
    PIM Join packet filtering

    ACL rules can be configured on interfaces to filter received Join packets. This can prevent attacks conducted using malicious Join packets.
    When there are a large number of malicious Join packets, configure rules on interfaces so that the interfaces only allow specified Join packets and discard malicious Join packets.
    IPv4/IPv6 PIM IPsec authentication

    Internet Protocol Security (IPsec) can be configured on interfaces to authenticate IPv4/IPv6 PIM messages. Under IPsec, an interface discards IPv4/IPv6 PIM messages that are not protected or authenticated by IPsec.
    MSDP whitelist

    MSDP is implemented using a whitelist. MSDP establishes a stable link with the peer to construct the peer remote address, local interface address, remote port number, local port number, and IP protocol number (TCP), and notifies the lower layer of this information. MSDP reports the messages meeting these conditions first to the CPU for processing (the priority policy depends on the implementation at the lower layer). After the MSDP neighbor relationship is torn down, relevant component interfaces are called to instruct the lower layer to delete the policy based on which packets are preferentially sent to the CPU.
    Packets that do not match the whitelist are discarded to protect the device from attacks.
    MSDP MD5 authentication

    Message digest 5 (MD5) authentication can be configured on MSDP peers to provide security protection. Make sure you enable MD5 authentication and the same authentication password for both MSDP peers. After this function is enabled, the transmit peer sends an MD5-encrypted MSDP message, which is transferred to the receive peer over a TCP connection. The receive peer decrypts the MSDP message by following the uniform MD5 encryption rules and the key contained the message. After decrypting the message successfully, the transmit peer reports the message to the MSDP module for processing. Only MSDP packets passing MD5 authentication are processed. This effectively prevents attacks that are conducted using malicious packets.
    MSDP keychain authentication

    Keychain and new TCP extension options enable each TCP connection to be configured with a password. You can set different encryption algorithms and validity periods for passwords. In addition, passwords can be changed at any time. This significantly improves security of encrypted packets. Only MSDP packets that are authenticated using a keychain are processed. This effectively prevents attacks conducted using malicious packets.
    Source IP address-based IGMP/MLD packet filtering

    ACL rules can be configured on interfaces to filter out received IGMP/MLD packets.
    The interface receives the IGMP/MLD packets only with a specified IP address and discards those with other IP addresses, which prevents the interfaces from potential attacks.
    IGMP/MLD IPsec authentication

    IPsec can be configured on interfaces to authenticate IGMP/MLD messages. Under IPsec, an interface discards IGMP/MLD messages that are not protected or authenticated by IPsec.
Attack Methods

You can configure source IP address-based IGMP/MLD packet filtering on interfaces to discard unmatching IGMP/MLD packets on networks. Potential attacks are as follows:
    Attackers send invalid Report packets of an earlier IGMP/MLD version to join a multicast group. The multicast group is compatible with hosts of the earlier IGMP/MLD version. When hosts leave the multicast group, the multicast keeps sending traffic even if there are no members until the multicast group times out.
    Attackers send Leave packets or IGMP/MLD version 3 status change reports. As a result, only devices and all multicast group members respond to source-specific or source/group-specific information checking, and services of the multicast group or (S, G) are not interrupted.
    Attackers send an IGMP Query message with a small IP address. The querier cannot respond to the event that a member leaves the multicast group. As a result, traffic of the multicast group is still forwarded even if there is no member in the multicast group until the entry of a member times out.
    Attackers send Interception General Query messages to check the members and send a large number of source/group-specific Query messages with many source lists and long query response time. As a result, all routes consume a large number of CPU and memory resources to process the source/group-specific query during the response delay."
  solution    : "For hardening refer to : 
  https://support.huawei.com/enterprise/en/doc/EDOC1100125841/3a1d1df9/control-plane#EN-US_CONCEPT_0192251890"
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "(pim neighbor-policy)"
</custom_item>


<custom_item>
  description : "Layer 2 Multicast"
  info        : "In Layer 2 multicast, group policies can be set to restrict the access of multicast groups (multicast source groups) to a VLAN or an interface.
In Layer 2 multicast, IP policies can be set based on the source IP address to restrict the access of source IP addresses to a VLAN or VSI. Here the source IP address refers to the one carried in the IP header, that is, the host IP address.
In Layer 2 multicast, you can configure router ports not to be learned through packets.
Attack Methods

Malicious users access a device using changed multicast addresses over invalid multicast channels. As a result, many invalid entries are created on the device and use system resources, and common users cannot access services. Multicast group policies can be set to limit the range of multicast groups that users can access.
Malicious users exchange source IP addresses to access the device. Source IP address-based policies can be set to limit the range of valid source IP addresses that can access the device.
Attacks are conducted through query packets. A multicast router port is configured on the device to receive traffic from all multicast groups. As a result, a large amount of traffic is sent over this port and this consumes interface bandwidth. To resolve this problem, configure static ports and configure router ports not to be learned through packets."
  solution    : "Configuration and Maintenance Methods
Set multicast group policies in the VLAN, VSI, or interface view.
igmp-snooping group-policy

Set source IP address-based policies in the VLAN or VSI view.
igmp-snooping ip-policy

Set router ports not to be learned through packets in the VLAN or VSI view.
undo igmp-snooping router-learning

Configuration and Maintenance Suggestions

Based on service deployment, you are recommended to configure group policies for VLANs or VSIs based on the IPTV multicast group address range.
Configure an IGMP snooping group policy in the VLAN or VSI view.
igmp-snooping group-policy acl-number

Specify an IPTV group range in the ACL 2000 view.
rule [ rule-id ] { deny | permit } source source-ip-address source-wildcard"
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "igmp-snooping"
</custom_item>


<custom_item>
  description : "Configure strict ARP learning."
  info        : "Strict ARP learning can be configured globally and in the interface view and takes effect as follows:
– If strict ARP learning is configured globally and in the interface view, only the function configured in the interface view takes effect.
– If strict ARP learning is not configured in the interface view, the function configured globally takes effect."
  solution    : "Enable strict ARP learning globally.
<HUAWEI> system-view
[~HUAWEI] arp learning strict
Enable strict ARP learning in the interface view.
<HUAWEI> system-view
[~HUAWEI] interface gigabitethernet 2/0/3
[~HUAWEI-GigabitEthernet2/0/3] arp learning strict force-enable
Long aging time of ARP fake entries affects service convergence. Therefore,
retaining the default aging time of ARP fake entries (5s) is recommended.
Configure the aging time of dynamic ARP fake entries on a specified interface to 10s.
<HUAWEI> system-view
[~HUAWEI] interface gigabitethernet1/0/0
[~HUAWEI-GigabitEthernet1/0/0] arp-fake expire-time 10
If the memory usage is so high that the traffic forwarding fails, check whether it
caused by failure to learn ARP entries."
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "arp learning strict force-enable"
</custom_item>


<custom_item>
  description : "Configure ARP packet rate limit"
  info        : "A device limits the number of ARP packets that can be processed every second. The excess ARP entries will be discarded, preventing ARP entry overflow. An ARP packet rate can be limited based either on source IP addresses or
destination IP addresses.
– If source-ip is specifies, the ARP packet rate is limited based on source IP
addresses.
– If destination-ip is specifies, the ARP packet rate is limited based on
destination IP addresses."
  solution    : "Configure an limit on the ARP packet rate to 50 pps based on destination IP addresses.
<HUAWEI> system-view
[~HUAWEI] arp speed-limit destination-ip maximum 50"
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "arp speed-limit"
</custom_item>


<custom_item>
  description : "Configure the ARP entry limit."
  info        : "A device limits the number of ARP entries that an interface can learn. The excess ARP entries cannot be added to the ARP entry table, preventing ARP entry overflow."
  solution    : "Configure a limit for the number of ARP entries that a specified interface can learn.
<HUAWEI> system-view
[~HUAWEI] interface gigabitethernet1/0/0
[~HUAWEI-GigabitEthernet1/0/0] arp-limit maximum 20"
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "arp speed-limit"
</custom_item>


<custom_item>
  description : "ARP Broadcast Packet Duplication on a VLAN Termination Sub-Interface with a Large Number of VLAN Tag Pairs Configured"
  info        : "Overview of the Security Policy

    Sending packets to specified VLANs of users who get online through a DHCP relay agent

    A DHCP relay agent stores VLAN information of online users. When online users exist and a VLAN tag termination sub-interface receives ARP Miss packets, the DHCP relay agent broadcasts ARP Request packets only within specified user VLANs.
    Incremental step value and maximum aging time of fake entries on VLAN tag termination sub-interfaces with a large number of VLAN tag pairs configured

    More than 4000 VLAN tag pairs are configured on a VLAN tag termination sub-interface. Upon receipt of ARP Miss packets, the sub-interface keeps broadcasting ARP Request packets, triggering the generation of fake entries. The aging time increases by 15s each time fake entries are generated, and the maximum aging time is 3 minutes.
    Rate at which packets are sent by a board

    If more than 64 VLAN tag pairs are configured on a VLAN tag termination sub-interface, the sub-interface sends complete VLAN information in several ARP broadcast packets to the hardware abstraction layer (HAL) module for replication. The rate at which packets are sent can be set on a board. The maximum rate is 30000 packets per second.
Attack Methods

After a large number of VLAN tag pairs are configured on a Layer 3 termination sub-interface, IP traffic keeps being sent to cause the sub-interface to broadcast ARP Request packets. ARP broadcast packets are replicated and sent to VLANs identified by all VLAN tag pairs that are configured on the sub-interface. Each packet may be replicated tens of thousands of times (depending on the number of VLAN tag pairs configured on the sub-interface).
When ARP broadcast packets are duplicated, a huge number of CPU resources are consumed, adversely affecting the other services."
  solution    : "Configuring Maintenance

Set the rate at which ARP packets are sent.
The rate at which ARP packets are sent is set globally. The default rate is 500 pps. After the rate is set, excess packets are cached before being sent.
<HUAWEI> system-view

[~HUAWEI] arp broadcast-send maximum 500 

Configuration and Maintenance Suggestions

If a device has a large number of VLAN tag pairs configured on a VLAN tag termination sub-interface, you can adjust the rate at which ARP packets are broadcast based on CPU usage. Run the arp pads command to query statistics about packets discarded after the buffer is full of packets to be sent."
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "arp broadcast-send maximum"
</custom_item>


#<custom_item>
#  description : "ARP Security"
#  info        : "Defense Against ARP Spoofing Attacks
#Attack Behavior
#In ARP spoofing attacks, attackers send fake ARP packets to modify ARP entries on gateways or valid hosts. As a result, #valid ARP packets cannot be transmitted.
#    Attackers send forged ARP packets to gateways so that gateways learn incorrect user ARP entries.
#    Attackers send forged ARP packets to other users so that the users learn incorrect ARP entries.
#    Attackers send malformed ARP packets to switches so that the switches learn incorrect ARP entries."
#  solution    : "Refer to below for ARP security:
#  https://support.huawei.com/enterprise/en/doc/EDOC1100038362/d7bb5127/arp-security"
#  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
#  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
#  expect  : "(arp anti-attack packet-check|arp anti-attack rate-limit)"
#</custom_item>
#

<custom_item>
  description : "DHCP Defense Against Pseudo Server Attacks"
  info        : "Security Policy
Trusted and untrusted interfaces can be configured for DHCP snooping to defend against bogus DHCP server attacks.
    Trusted and untrusted interfaces take effect in DHCP snooping.
    The configured trusted or untrusted interface records a maximum of 64 logs about the DHCP server. When 64 logs are generated on the interface, the later logs override the previous ones. In addition, the aging time of logs is 24 hours.
    The DHCP snooping function must have been globally enabled.
Attack Methods

An attacker pretends to be a DHCP server and replies to a DHCP client with an incorrect gateway address, DNS server address, and IP address to prevent the client from accessing networks."
  solution    : "Configuration and Maintenance Methods

Configure GE 1/0/0 as the trusted interface.
<HUAWEI> system-view

[~HUAWEI] interface gigabitethernet1/0/0

[~HUAWEI-Gigabitethernet1/0/0] dhcp snooping trusted

[*HUAWEI-Gigabitethernet1/0/0] commit

Configuration and Maintenance Suggestions

Configure the interface closest to the DHCP server as the trusted interface."
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "dhcp snooping trusted"
</custom_item>


<custom_item>
  description : "DHCP DoS Attack Defense"
  info        : "Security Policy

An attacker keeps applying for IP addresses by changing the CHADDR value in DHCP packets to exhaust DHCP server address resources. You can configure the device to check the CHADDR value in DHCP request packets to defend against such DoS attacks.
Attack Methods

You can configure MAC restriction to defend attacks that an attacker keeps changing the source MAC address in frame headers. However, if an attacker changes the CHADDR value instead of the source MAC address in packets, MAC restriction cannot suppress such attacks because a device determines whether a packet is valid based on its source MAC address. Attack packets can be forwarded."
  solution    : "Configuration and Maintenance Methods

Enable CHADDR check on an interface.
<HUAWEI> system-view

[~HUAWEI] interface gigabitethernet1/0/0

[~HUAWEI-Gigabitethernet1/0/0] dhcp check chaddr enable

[*HUAWEI-Gigabitethernet1/0/0] commit

Configuration and Maintenance Suggestions

Note that configuring CHARDDR check affects user access."
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "dhcp check chaddr enable"
</custom_item>


<custom_item>
  description : "DHCP Defense Against Bogus Packets for Extending the IP Address Lease"
  info        : "Security Policy

An attacker keeps sending DHCP request packets for extending the IP address lease to prevent expired IP addresses from being reclaimed. You can configure the device to match received request packets against the binding table to defend against bogus packets for extending the IP address lease.
Attack Methods

An attacker sends a large number of DHCP request packets carrying incorrect source MAC address, source IP address, VLAN ID, or interface information to attack the DHCP server."
  solution    : "Configuration and Maintenance Methods

Configure an interface to check DHCP request packets for extending the IP address lease.
<HUAWEI> system-view

[~HUAWEI] interface gigabitethernet1/0/0

[~HUAWEI-Gigabitethernet1/0/0] dhcp snooping checkdhcp-request enable

[*HUAWEI-Gigabitethernet1/0/0] commit

Configuration and Maintenance Suggestions

Note that configuring CHARDDR check affects user access."
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprise/br/doc/EDOC1100146597/3a1d1df9/control-plane#EN-US_CONCEPT_0192251906"
  expect  : "dhcp snooping checkdhcp-request enable"
</custom_item>


<custom_item>
  description : "DHCP Defense Against Invalid ARP Packets"
  info        : "Security Policy

The DHCP snooping ARP packet check function, also called DAI function on some products can be configured to defend against invalid ARP packets. The implementations of these two functions are similar.
Attack Methods

An attacker sends a large number of ARP packets carrying incorrect source MAC address, source IP address, VLAN ID, or interface information to attack the DHCP server."
  solution    : "Configuration and Maintenance Methods

Configure the DHCP snooping ARP packet check function on an interface.
<HUAWEI> system-view

[~HUAWEI] interface gigabitethernet1/0/0

[~HUAWEI-Gigabitethernet1/0/0] dhcp snooping check arpenable

[*HUAWEI-Gigabitethernet1/0/0] commit

Configuration and Maintenance Suggestions

Note that configuring this function affects user access."
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprise/br/doc/EDOC1100146597/3a1d1df9/control-plane#EN-US_CONCEPT_0192251907"
  expect  : "dhcp snooping check arpenable"
</custom_item>


<custom_item>
  description : "DHCP Defense Against Invalid IP Packets"
  info        : "Security Policy

After receiving an IP packet, a device checks whether the source IP address, source MAC address, interface information, and VLAN ID carried in the packet match an entry in the DHCP snooping binding table. If a matching entry exists, the device considers the packet valid and forwards it. If no matching entry exists, the device considers the packet invalid and drops it.
The DHCP snooping IP packet check function, also called IP source guard (IPSG) function in some products can be configured to defend against invalid IP packets. The implementations of these two functions are similar.
Attack Methods

An attacker sends a large number of IP packets carrying incorrect source MAC address, source IP address, VLAN ID, or interface information to attack the DHCP server."
  solution    : "Configuration and Maintenance Methods

Configure the DHCP snooping IP packet check function on an interface.
<HUAWEI> system-view

[~HUAWEI] interface gigabitethernet1/0/0

[~HUAWEI-Gigabitethernet1/0/0] dhcp snooping check ip enable

[*HUAWEI-Gigabitethernet1/0/0] commit

Configuration and Maintenance Suggestions

Note that configuring this function affects user access."
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprise/br/doc/EDOC1100146597/3a1d1df9/control-plane#EN-US_CONCEPT_0192251908"
  expect  : "dhcp snooping check ip enable"
</custom_item>


<custom_item>
  description : "MPAC - IPv4 Management Plane Access Control"
  info        : "Security Policy

Management Plane Access Control (MPAC) enhances system security by protecting devices against Denial of Service (DoS) attacks.
In a common deployment scenario, the router may run multiple services at the same time, such as Layer 2 services MSTP, RRPP, routing services OSPF and BGP, MPLS services LDP and RSVP, system service TFTP server, and diagnostic functions ping and tracert.
This enables attackers to send various attack packets to the router. Unless protective features such as MPAC are enabled, the router sends packets destined for its interfaces (including the loopback interface) directly to the CPU without any filtering. As a result, CPU and system resources are wasted and the system comes under DoS attacks.
To prevent such attacks, define an MPAC policy to filter packets.
The NE40E supports definitions of Management Plane Access Control (MPAC) policies that can be applied to sub-interfaces, to interfaces, or globally on the NE40E.
After you define the rules for an MPAC policy, the NE40E filters packets destined for the CPU. If no such policy is defined, the CPU remains vulnerable to attacks."
  solution    : "Configuration and Maintenance Methods

Configure IPv4 MPAC on Device A.
<DeviceA> system-view

[~DeviceA] service-security policy ipv4 test

[*DeviceA-service-sec-test] rule 10 deny protocol ip source-ip 10.10.1.1 0

[*DeviceA-service-sec-test] step 10

[*DeviceA-service-sec-test] description rule 10 is deny ip packet which from 10.10.1.1

[*DeviceA-service-sec-test] commit

[~DeviceA-service-sec-test] quit

[~DeviceA] service-security global-binding ipv4 test

[*DeviceA] commit

[~DeviceA] interface gigabitethernet 1/0/0

[~DeviceA-GigabitEthernet1/0/0] service-security binding ipv4 test

[*DeviceA-GigabitEthernet1/0/0] commit


REFER TO :
https://support.huawei.com/enterprise/en/doc/EDOC1100146597/3a1d1df9/control-plane#EN-US_CONCEPT_0192251874"
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprise/en/doc/EDOC1100146597/3a1d1df9/control-plane#EN-US_CONCEPT_0192251874"
  expect  : "service-security"
</custom_item>


<custom_item>
  description : "Defense Against Malformed Packet Attacks"
  info        : "Security Policy

A malformed packet attack sends malformed IP packets to a target. The target may encounter errors or crash when handling these packets.
Malformed packet attacks are as follows:
    Flood attacks using IP packets with null payload

    Attacks using IGMP packets with null payload

    LAND attacks

    Smurf attacks

    TCP flag invalid attacks

Attack Modes

    Flood attacks using IP packets with null payload

    Flood attackers send massive IP packets without any upper layer data. These massive IP packets form flood attacks. The IP packets without upper layer data are useless, and therefore must be discarded.
    Attacks using IGMP packets with null payload

    An IGMP packet consists of a 20-byte IP header and an 8-byte IGMP body. If an IGMP packet is shorter than 28 bytes, the device considers it malformed and discards it.
    LAND attacks

    LAND attacks were initially by the Hacker organization RootShell and first launched on Nov 20, 1997. The attack exploits the defects in the three handshake processes used in a TCP connection. A LAND attacker creates a special SYN packet with the source IP address and source port the same as the destination IP address and destination port, respectively. After a device receives a SYN packet, it sends to its IP address a SYN+ACK packet. Consequently, it replies to itself a SYN+ACK packet and creates a null connection that persists until expiration. As a result, the destination host resolves the LAND packet using excessive resources, and the network fails.
    Figure 7-6 LAND attack

    If the destination host receives a SYN+ACK packet, it interprets the packet as a connection request (ignoring the ACK packet) and replies with a SYN+ACK packet. The ACK packet is used to acknowledge the last SYN packet. Consequently, the destination host determines that it is receiving a connection request again. The cycle continues.
    Even though the destination host does not consider the SYN+ACK packet as a connection request, it considers the SYN+ACK packet as a half connection as a result of sending of the SYN+ACK packet. If there are excessive packets, it becomes a SYN flood attack. As a result, an excess of half connections is set up, and the system fails.
    The device considers LAND attacks malformed packet attacks. If a received TCP SYN packet carries the same source and destination IP addresses, the device considers it an attack packet and discards it.
    Smurf attacks

    The principle of a Smurf attack is that an attacker sends ICMP Echo Request packets with the destination IP address set to a broadcast IP address and the source IP address set to the target's IP address. All the hosts on the network send reply with packets to the target. The target receives too many packets, leading to high CPU usage. The target interprets packets with their destination set to a broadcast address or a subnet broadcast address as malformed and discards them to defend against Smurf attacks.
    TCP flag invalid attacks

    A TCP packet contains six flag bits, including URG, ACK, PSH, RST, SYN, and FIN. Replies to combinations of these flag bits vary according t systems.
    If the six flag bits are all 1s, the attack is a Christmas tree attack.
    If the six flag bits are all 0s and the TCP port is disabled, the receiver responds with an RST|ACK packet. If the six flag bits are all 0s and the TCP port is enabled, a device running Linux or UNIX does not respond, whereas, but a device running Windows responds with an RST|ACK packet. This helps identify the operating system.
    If ACK is used with another flag bit (except RST) as a combination, the receiver that does not send any request, but still sends an RST response packet, regardless of whether the TCP port is enabled. This helps determine whether a host exists.
    The reception of an SYN+FIN+URG packet triggers the receiver to respond with an RST+ACK packet, regardless of whether the TCP port is enabled. This helps determine whether a host exists.
    Upon receipt of an SYN, SYN+FIN, SYN+PUSH, SYN+FIN+PUSH, SYN+URG, SYN+URG+PUSH, or SYN+FIN+URG+PUSH packet, the receiver responds with an RST+ACK packet if the TCP port is disabled or to respond with an SYN+ACK packet if the TCP port is enabled. This assists in host detection and port detection.
    Upon receipt of a FIN, URG, PUSH, URG+FIN, URG+PUSH, FIN+PUSH, or URG+FIN+PUSH packet, the receiver responds with an RST+ACK reply if the TCP port is disabled. If the TCP port is enabled, the receiver running Linux or UNIX does not respond, whereas the receiver running Windows responds with an RST+ACK packet. This helps identify the operating system.
    The device checks the flag bit in each TCP packet and discards packets the packet if the packet meets any of the following conditions:
        The six flag bits are all 1s.
        The six flag bits are all 0s.
        Both SYN and FIN are 1s."
  solution    : "Configuration and Maintenance Methods

    Enable or disable the defense against malformed packet attacks. By default, the defense against malformed packet attacks is enabled.
    abnormal-packet-defend enable

    undo abnormal-packet-defend enable

    ipv6-abnormal-packet-defend enable

    undo ipv6-abnormal-packet-defend enable

    Display the statistics on malformed packet attacks on a specific or all interface boards.
    display cpu-defend tcpip-defend statistics [ slot slot-number ]

    display cpu-defend tcpip-defend-6 statistics [ slot slot-number ]

    Delete statistics about malformed packet attacks on a specific or all interface boards.
    reset cpu-defend tcpip-defend statistics [ slot slot-number ]

    reset cpu-defend tcpip-defend-6 statistics [ slot slot-number ]

Configuration and Maintenance Suggestions

N/A"
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprise/en/doc/EDOC1100146597/3a1d1df9/control-plane#EN-US_CONCEPT_0192251877"
  expect  : "(abnormal-packet-defend enable|ipv6-abnormal-packet-defend enable)"
</custom_item>


<custom_item>
  description : "Defense Against Packet Fragment Attacks"
  info        : "Security Policy

Teardrop attacks target fragments that are not properly reassembled. To defend a system against teardrop attacks, the system must reassemble packet fragments properly and discard packets that are not properly reassembled. For repeated packet fragment attacks, no effective measures are available. An interface board may fail to receive all fragments due to trunk and load sharing on an IP network. Therefore, packet fragments cannot be reassembled on an interface board. If packet fragments are reassembled on a main control board, the CPU of the main control board and inter-board communication resources are consumed. To defend the system against repeated packet fragment attacks, the forwarding engine sets a committed access rate (CAR) for packet fragments separately on an interface board to prevent great numbers of packet fragments from attacking the CPU. The CAR parameter can be configured.
Attack Modes

Packet fragment attacks are classified into the following categories:
    Excessive fragments

    Attackers produce a great number of fragments with a minimum size of 8 bytes. Normally, the IP header contains 20 bytes, and the maximum IP payload is 65515 bytes. If the data is fragmented and each IP payload contains 8 bytes, a total of 8189.375 fragments are obtained. (If a packet is divided into 8189 fragments, the IP payload does not reach 65515 bytes. If a packet is divided into 8190 fragments, the IP payload exceeds 65515 bytes.) A large number of small fragments are often malicious. If these small fragments are sent to a router, the router attempts to reassemble these fragments, which consumes a large number of CPU resources.
    Teardrop attacks

    The teardrop attack is the most famous IP fragmented attack. Its basis is that the IP packets are incorrectly fragmented, and the second fragment is contained in the first fragment. In the first fragment, the IP payload is 36 bytes, the total length is 56 bytes (correct), the protocol is UDP, and the UDP checksum is 0 (no CRC). In the second fragment, the IP payload is 4 bytes, the total length is 24 bytes (correct), the protocol is UDP, and the offset is 24 (3 x 8), which is incorrect. The correct offset is 36.
    Syndrop attacks

    The principle is similar to that of a teardrop attack, except that the TCP protocol is used, the flag is SYN, and a packet contains padding. In the first fragment, the IP payload is 28 bytes (byte 0 to byte 27, including the TCP header) and the IP header is 20 bytes. In the second fragment, the offset is 24, the total length of the payload is 4 bytes (byte 24 to byte 27), and the IP header is 20 bytes.
    Nesta attacks

    A packet is divided into three fragments. In the first fragment, the IP payload is 18 bytes (byte 0 to byte 17), the protocol is UDP, and the checksum is 0. In the second fragment, the offset is 6 x 8 = 48, the IP payload is 116 bytes. If there is no subsequent fragment, the second fragment is the end fragment. In the third fragment, the offset is 0, the more flag is 1 (indicating there are subsequent fragments), the size of the IP option is 40 bytes (all EOL), and the IP payload is 224 bytes.
    FAWX attacks

    During a FAWX attack, incorrectly fragmented IGMP packets are sent. Two IGMP packet fragments are sent. The first fragment is 9 bytes. In the second fragment, the offset is 8, the IP payload is 16 bytes, and there is no end fragment.
    BONK attacks

    BONK attacks are similar to NewTear attacks, except that the IP payload of the first fragment is 36 bytes and the UDP checksum is 0; the offset of the second fragment is 32; the length is 4 bytes.
    Dead ping attacks

    The total length of an ICMP Echo Request exceeds 65535 bytes, causing the protocol stack to collapse. During this type of attack, IP packets are fragmented to cause the total length of the IP payload and the IP header exceed 65535 bytes.
    Jolt attacks

    Jolt attacks are similar to Dead Ping attacks. A packet contains a total of 173 fragments. The IP payload of each fragment is 380 bytes. Therefore, the total length is 65760 bytes (170 x 380 + 20), which far exceed 65535 bytes.
    Repeated packet fragment attacks

    During this type of attack, the same fragment is sent more than twice. This can bring about two different results. In the first case, the first and second fragments have the same sequence number because both may be retransmitted. In the second case, the first and second fragments have different sequence numbers, and the system needs to determine which fragment is to be reserved and which fragment is to be discarded, or whether both fragments are to be discarded.
    NewTear attacks

    NewTear attacks are similar to Syndrop attacks in terms of fragments, except that the protocol is UDP, the IP payload of the first fragment is 28 bytes (byte 0 to byte 27; including the UDP header; UDP checksum is 0), and the offset of the second fragment is 24. The total payload length is 4 bytes (byte 24 to byte 27).
    Rose attacks

    The IP protocol can be UDP or TCP.
        TCP: There are a total of two fragments. The IP payload length of the first fragment is 48 bytes. The IP payload length of the second fragment is 32 bytes, but the offset is 65408, and the more flag is 0 (indicating there is no subsequent fragment).
        UPD: There are a total of two fragments. The IP payload length of the first fragment is 40 bytes. The IP payload length of the second fragment is 32 bytes, but the offset is 65408, and the more flag is 0 (indicating there is no subsequent fragment)."
  solution    : "Configuration and Maintenance Methods

    Enable or disable defense against packet fragment attacks. By default, the defense against packet fragment attacks is enabled.
    fragment-flood enable

    undo fragment-flood enable

    Display statistics on packet fragment attacks on all the interface boards or a specified interface board.
    display cpu-defend statistics

    Delete statistics on packet fragment attacks on all the interface boards or a specified interface board.
    reset cpu-defend statistics

    View the detailed contents of packets in the packet cache bucket.
    display attack-source-trace verbose

Configuration and Maintenance Suggestions

N/A"
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprise/en/doc/EDOC1100146597/3a1d1df9/control-plane#EN-US_CONCEPT_0192251878"
  expect  : "fragment-flood enable"
</custom_item>


<custom_item>
  description : "TCP Syn Flood Attacks"
  info        : "Security Policy

The TCP Syn Flood attacks are common and effective. The TCP Syn Flood attack is a Denial of Service (DoS) attack, which exploits the TCP connection establishment procedure.
Huawei devices limit the rate of TCP SYN packets to prevent exhaustion of system resources if a TCP Syn Flood attack occurs.
Attack Modes

During the three handshake processes of a TCP connection, when the server receives the initial SYN packet from the client, it sends back a SYN-ACK packet to the client and creates an input interface in memory. While the server is waiting for the final ACK packet from the client, the connection is in half-connected mode. If the server fails to receive the ACK packet, it resends a SYN-ACK packet to the client. If the server sends the SYN-ACK packet multiple times and does not receive any ACK packet from the client, it ends the session and refreshes the session in memory. The time between sending the first SYN-ACK packet and the end of the session is about 30s.
During this time period, the attacker may send thousands of SYN packets to the open port without replying to the SYN-ACK packet sent by the server. The server is quickly overloaded and cannot support new connection requests. Therefore, the server disconnects all the present connections.
The attacker seldom receives SYN-ACK packets. Therefore, they can forge a different source address of the SYN packet to make locating the actual address of attacks more difficult.
The SYN-ACK packet is not sent to the attacker, which conserves bandwidth for the attacker."
  solution    : "Configuration and Maintenance Methods

    Enable or disable the defense against TCP Syn Flood attacks. By default, the defense against TCP Syn Flood attacks is enabled.
    tcpsyn-flood enable

    undo tcpsyn-flood enable

    ipv6-tcpsyn-flood enable

    undo ipv6-tcpsyn-flood enable

    car tcpsyn cir 1000 cbs 10000

    undo car tcpsyn

    Display the statistics on TCP Syn Flood attacks on a specific or all interface boards.
    display cpu-defend car index 48 statistics [ slot slot-number ]

    Delete statistics on TCP Syn Flood attacks on a specific or all interface boards.
    reset cpu-defend car index 48 statistics [ slot slot-number ]"
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprise/en/doc/EDOC1100146597/3a1d1df9/control-plane#EN-US_CONCEPT_0192251879"
  expect  : "tcpsyn-flood enable"
</custom_item>


<custom_item>
  description : "Defense Against UDP Flood Attacks"
  info        : "Security Policy

Packets sent by UDP ports 7, 13, and 19 are considered attack packets and discarded.
You can enable defense against UDP flood attacks.
Attack Modes

    Fraggle attacks

    During a Fraggle attack, attackers use UPD port 7 (UDP echo request) to attack network devices. The service of port 7 is basically the same as that of ICMP echo, that is, port 7 sends back all the received packet payloads without making any modifications to test the network connection between the source IP address and the destination IP address. Fraggle attacks are similar to Smurf attacks. During a Fraggle attack, the IP address of the victim is used as the source IP address and a broadcast address is used as the destination IP address. The destination port ID is 7, and the source port ID may be 7 or another ID. If the UDP echo service is enabled on a lot of hosts on this broadcast network, the victim will receive a lot of response packets. In this way, the victim is attacked.
    UDP diagnosis port attacks

    Packets are sent to a diagnosis port (7-echo, 13-daytime, or 19-Chargen) at random. If a great number of packets are sent simultaneously, UPD packets flood occurs, affecting the normal running of network devices. A lot of vendors enable small servers by default for network diagnosis or device management, which results in potential attacks. For example, during a Pepsi attack, attackers send a huge number of packets to a diagnosis port of a device, causing DoS of the device."
  solution    : "Configuration and Maintenance Methods

    Enable or disable the defense against UDP Flood attacks. (By default, the defense against UDP Flood attacks is enabled.)

    udp-packet-defend enable

    undo udp-packet-defend enable

    ipv6-udp-packet-defend enable

    undo ipv6-udp-packet-defend enable

    Display statistics on UDP flood attacks on a specific or all interface boards.
    display cpu-defend tcpip-defend statistics [ slot slot-number ]

    display cpu-defend tcpip-defend-6 statistics [ slot slot-number ]

    Delete statistics on UDP flood attacks on a specific or all interface boards.
    reset cpu-defend tcpip-defend statistics [ slot slot-number ]

    reset cpu-defend tcpip-defend-6 statistics [ slot slot-number ]"
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprise/en/doc/EDOC1100146597/3a1d1df9/control-plane#EN-US_CONCEPT_0192251880"
  expect  : "udp-packet-defend enable"
</custom_item>


<custom_item>
  description : "Defense Against ICMP Flood Attacks"
  info        : "Security Policy

The rate at which ICMP messages are sent is set on a board, which helps prevent ICMP flood attacks on boards. Defense against ICMP Flood attacks can be enabled based on boards.
Attack Modes

During an ICMP Flood attack, ICMP packets are sent at a high rate. When a program sends more than 1000 packets per second, the program is considered a flood generator. A large number of ICMP Echo Request packets are sent to the target. The target host has to return a large number of ICMP Echo Reply or ICMP unreachable packets. After the attacker forges a source IP address, the target host sends back a large number of ICMP packets to the false address in vain. This consumes the host's system resources, and eventually the server may stop responding. The attack may also originate from other types of ICMP packets."
  solution    : "Configuration and Maintenance Methods

    Enable or disable defense against ICMP Flood attacks. By default, defense against ICMP Flood attacks is enabled.
    car icmp cir 100 cbs 10000

    undo car icmp

    Check statistics about fragments that are used to launch attacks to all boards or a specified board.
    display cpu-defend car icmp statistics [ slot slot-number ]

    Delete statistics about fragments that are used to launch attacks to all boards or a specified board.
    reset cpu-defend car icmp statistics [ slot slot-number ]"
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprise/en/doc/EDOC1100146597/3a1d1df9/control-plane#EN-US_CONCEPT_0192251881"
  expect  : "car icmp cir 100 cbs 10000"
</custom_item>


<custom_item>
  description : "Defense Against Invalid ND Packet Attacks"
  info        : "Security Policy

Defense against invalid ND packet attacks controls the invalid ND packets (IPv6 NS/NA/RS/RA/Redirect/CPS) to be sent to the CPU. The forwarding engine supports the function of identifying NS/NA/RS/RA/Redirect/CPS packets, which has fragmented packets and the non-fragmented packets that do not match the local route discarded. However, the function of identifying NS/NA/RS/RA/Redirect/CPS packets is not enabled by default. You can run a specific command to enable this function.
Attack Modes
Table 7-3 ICMP headers of RS/RA/NS/NA/Redirect/CPS packets

    Non-fragment: RS/RA/NS/NA/Redirect/CPS, with the nextheader field value in the IPv6 header being 0x3A or the source IP address being a non-link-local address.
    Fragment: RS/RA/NS/NA/Redirect/CPS, with the nextheader field value in the IPv6 header being 0x2C or the NextHeader field value in the IPv6 extended header being 0x3A.
The preceding packets are invalid ND packets and waste resources and bring risks if being sent to the CPU.
After defense against invalid ND packets is enabled on a device, the device discards the preceding packets."
  solution    : "Configuration and Maintenance Methods

    Enable or disable defense against invalid ND packet attacks. By default, this function is not enabled.
    set nd packet filter enable

    undo set nd packet filter enable

    Check statistics about the function of defense against invalid ND packet attacks on all interface boards or a specified interface board.
    display nd packet filter statistics [ slot slot-id ]

    Clear statistics about the function of defense against invalid ND packet attacks on all interface boards or a specified interface board.
    reset nd packet filter statistics [ slot slot-id ]"
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprise/en/doc/EDOC1100146597/3a1d1df9/control-plane#EN-US_CONCEPT_0192251882"
  expect  : "set nd packet filter enable"
</custom_item>


<custom_item>
  description : "SOC - HUAWEI Security Operation Center"
  info        : "To ensure system reliability and protect services against attacks, the NE40E supports security techniques, such as rate limiting by committed access rate (CAR), attack detection, and attack defense. However, in absence of a global management center that can summarize and analyze all attack information, attack detection and defense are not comprehensive for the NE40E.
To address this problem, the SOC has been developed to summarize and analyze information reported by all security detection modules in the system. Then the SOC presents attack event reports, attack sources, cause analysis, and solutions in a centralized and concise manner.
Attack Detection
Attack detection allows the SOC to determine whether the device is under attack based on the statistics it collects.
The SOC is triggered by timers to collect the CPU usage, protocol module's state data, including the number of invalid packets and sessions, and CPCAR-related packet loss statistics. After attack detection is enabled, when the CPU usage and the percentage of the number of invalid packets or sessions to the total number of packets or sessions or the packet loss rate exceeds the attack detection threshold, the SOC determines that the NE40E is being attacked and starts attack source tracing. If attack detection is left disabled, the SOC still collects statistics as triggered by timers, but does not determine an attack event or start attack source tracing
Attack Source Tracing

Attack source tracing allows the SOC to locate an attack event and determine the probability and cause of the attack event.
If the NE40E is identified under attack by attack detection, the SOC samples attack packets and collects and analyzes statistics about the sampled attack packets based on multiple criteria, such as the source MAC address, source IP address, broadcast packets, packets with varied source addresses, protocol type, physical interface, logical interface, VLAN ID, and QinQ information. The SOC then lists the top N packets based on each criterion, filters the attack-related objects based on the attack source tracing thresholds, and generates attack event reports as well as alarms.
Attack Defense

Attack defense allows the SOC to automatically deliver attack defense policies and discard attack packets, protecting the NE40E against attacks.
After attack defense is enabled, the SOC classifies attack packets based on the packet characteristics and delivers ACL rules accordingly. The ACL rules specify the attack packet characteristics, interfaces under attack, and the mapping between the ACL rules and committed access rate (CAR) IDs. The CAR action can be sending packets to the CPU or discarding packets.
The SOC counts the number of discarded packets and packets sent to the CPU in real time and cancels the ACL rule if the rate of discarding packets is less than the specified threshold."
  solution    : "Refer to :
  https://support.huawei.com/enterprise/en/doc/EDOC1100055026/86bf1ed5/soc"
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "( soc |attack-defend enable)"
</custom_item>


<custom_item>
  description : "Information Center is not disabled."
  info        : "The information center is the hub of information flow for the device, and thus controls logging of events. If the information center is disabled, there will be no logging."
  solution    : "info-center enable
  Refer to : 
  https://support.huawei.com/enterprise/en/doc/EDOC1100125843/252c8791/information-management-configuration"
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprise/en/doc/EDOC1100125843/252c8791/information-management-configuration"
  expect  : "info-center"
</custom_item>


<custom_item>
  description : "Log Information Security"
  info        : "Functions

Logs record information, such as user operations on devices and device running status. Stored as log files on devices, logs help network administrators monitor the running status of routers and diagnose network faults.
Security Policy

Log security is implemented by the access mode authentication and socket security. Only administrators have rights to view logs.Logs can be viewed in the following modes:
    A user accesses a device to view logs using command lines.
    A user copies log files to a local disk over SFTP.
    A user sends logs to the log server when a log host is configured.
In the preceding modes, users must be authenticated using the password, SSL, AAA, or public-key authentication mode and successfully access devices to view logs online or obtain log files.
To help securely transmit log files, using SSL encryption over TCP is recommended."
  solution    : "Configuration and Maintenance Methods

View configuration maintenance information in the console, Telnet, SSH, TFTP, and socket authentication modes.
Using the TCP-based SSL encryption mode for log transmission on a VPN is recommended.
    Configure a VPN.
    [~HUAWEI] ip vpn-instance vrf2

    [*HUAWEI-vpn-instance-vrf2] route-distinguisher 2:2

    [*HUAWEI-vpn-instance-vrf2-af-ipv4] commit

    [~HUAWEI-vpn-instance-vrf2-af-ipv4] quit

    [~HUAWEI-vpn-instance-vrf2] vpn-target 2:2

    IVT Assignment result:
    Info: VPN-Target assignment is successful.
    EVT Assignment result:
    Info: VPN-Target assignment is successful.
    [*HUAWEI-vpn-instance-vrf2] commit

    [~HUAWEI-vpn-instance-vrf2] quit

    [~HUAWEI] interface gigabitethernet1/0/0

    [~HUAWEI-GigabitEthernet1/0/0] ip binding vpn-instance vrf2

    [*HUAWEI-GigabitEthernet1/0/0] ip address 10.137.130.245 255.255.254.0

    [*HUAWEI-GigabitEthernet1/0/0] commit

    Configure an SSL policy and load certificates.
    [~HUAWEI] ssl policy huawei2014

    [*HUAWEI-ssl-policy-huawei2014] certificate load pem-cert servercert.pem key-pair dsa key-file serverkey.pem auth-code cipher huawei-123456

    [*HUAWEI-ssl-policy-huawei2014] crl load pem-crl server.pem

    [*HUAWEI-ssl-policy-huawei2014] trusted-ca load asn1-ca servercert.der

    [*HUAWEI-ssl-policy-huawei2014] commit

    [~HUAWEI-ssl-policy-huawei2014] quit

    Configure a log host with a VPN attribute, with the TCP-based SSL encryption mode for log transmission.
    [~HUAWEI] info-center loghost 10.137.130.245 vpn-instance vrf2 transport tcp ssl-policy huawei2014

    [*HUAWEI] commit

Configuration and Maintenance Suggestions

See configuration and maintenance suggestions on console, Telnet, SSH, FTP, TFTP, and socket. Using TCP-based SSL encryption to transmit log files helps prevent unauthorized users from obtaining packets."
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprise/en/doc/EDOC1100125841/8be849e2/management-plane#EN-US_CONCEPT_0192229589"
  expect  : "info-center loghost.*vpn-instance.*ssl-policy.*"
</custom_item>


<custom_item>
  description : "Security Audit"
  info        : "Background

Security audit covers identifying, recording, storing, and analyzing information related to security behaviors. The security audit result is used to determine which security behaviors are performed and which users are responsible for these behaviors. The information required for audit must be stored in independent logs, and independent security channels must be allocated to ensure that these logs are not tampered with, deleted, or deciphered. The security level of security logs for audit must be higher than that of common logs. Even if the system is attacked, security logs are not tampered with. Security logs are used to analyze and trace attacks on devices.
Security logs include system startup verification logs, account login logs (such as AAA logs), account management logs, network security event logs, and operation logs such as SElinux unauthorized access logs and certificate key management logs."
  solution    : "Procedure

The following describes how to view the SElinux unauthorized access logs.
If the device is attacked or the system has security risks, run the display logfile cfcard:/security/security.log command in the system view to check specific SElinux logs based on log IDs. You can check the timeline and determine whether unauthorized access occurs during system running.
Run the display logfile cfcard:/security/security.log command to view detailed security log information, including the log time, event type, event content, and event trigger conditions.
<HUAWEI> display logfile cfcard2:/security/security.log 

###############################################################################
#     This logfile is generated at slot 3                                     
#     Digest(0000029124):aea3e0df5dd7b86e5db512c1f67d950299e1f88e3b605526ddc3bcc2c50acac4                
###############################################################################
Jun 11 2019 07:41:21 HUAWEI %%01OPS/5/OPS_LOGIN(s):CID=0x80b40431;Succeeded in establishing the OPS connection.(ServiceType=embedding-script, UserName=_SYSTEM_, Ip=0.0.0.0, VpnName=_public_)"
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "logfile cfcard"
</custom_item>


<custom_item>
  description : "Setting the Timestamp Format of the Information"
  info        : "Usage Scenario

The timestamp format of the information can be set to meet different time requirements in different places. After the configuration is complete, new information is generated according to the set timestamp format.
NOTE:
In this document, timestamp formats of logs, traps, and debugging information are set.
Only physical systems (PSs) support setting the timestamp format of the Information.
Pre-configuration Tasks

Before setting the timestamp format in the information, ensure that the device is powered on correctly and the self-test is successful."
  solution    : "Procedure

    Run system-view

    The system view is displayed.
    Run any of the following commands to set the timestamp format of the information:
        To set the timestamp format of the log information, run the info-center timestamp log { boot | { date | short-date | format-date } [ precision-time { tenth-second | millisecond | second } ] } command.
        To set the timestamp format of the trap, run the info-center timestamp trap { boot | { date | short-date | format-date } [ precision-time { tenth-second | millisecond | second } ] } command.
        To set the timestamp format of the debugging information, run the info-center timestampdebugging { boot | { date | short-date | format-date } [ precision-time { tenth-second | second | millisecond } ] } [ without-timezone ] command.
    Run commit

    The configuration is committed.
Checking the Configurations

Run the display logbuffer command to check whether the timestamp format in the log information is configured successfully."
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprise/en/doc/EDOC1100058392/1359acf2/setting-the-timestamp-format-of-the-information"
  expect  : "info-center timestamp"
</custom_item>


<custom_item>
  description : "Configure appropriate External Syslog server"
  info        : "Configure an IP address of a Syslog server where logging messages will be sent."
  solution    : "system-view
info-center loghost [logging_ip]"
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "info-center loghost"
</custom_item>


<custom_item>
  description : "Configure appropriate NTP server"
  info        : "Configure at least one NTP server. In environments with sycnfonization vlans, broadcast, manycast, or multicast can be used on specific interfaces."
  solution    : "ntp-service unicast-peer ip/hostname"
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "ntp-service unicast-peer"
</custom_item>


<custom_item>
  description : "NTP - Set the authentication key of the key to abc1234 and authentication algorithm to HMAC-SHA256 on the client"
  info        : "Configure security verification for the NTP client and level-1/2 or multi-level servers."
  solution    : "Refer to :
  https://support.huawei.com/enterprise/en/doc/EDOC1100055028/e5772378/example-for-configuring-ntp-authentication-in-broadcast-mode"
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "ntp-service authentication.*hmac-sha256"
</custom_item>


<custom_item>
  description : "Setting the NTP Service Access Permission on the Local Device"
  info        : "Check if the ACL is deployed for NTP."
  solution    : "Refer to:
  https://support.huawei.com/enterprise/en/doc/EDOC1100055028/2e8f99a5/setting-ntp-access-authorities"
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "ntp-service access"
</custom_item>


<custom_item>
  description : "Access Authentication Security"
  info        : "Security Policy

Serial ports are physical interfaces. Isolating serial ports in device deployment and networking can prevent malicious users from accessing devices by means of serial ports.
Serial ports support password authentication and authentication, authorization and accounting (AAA) authentication. Users can log in to a device through serial ports only after being authenticated. Authentication must be configured because no default authentication is available. Passwords used in authentication are encrypted using an irreversible algorithm.
When a device is started for the first time, no authentication configuration is available. Therefore, a user must configure authentication information using a serial port:
    Connect a PC to the serial port of the device, access the serial port, and presses Enter. The system prompts the user to configure and confirm a password. After the password is successfully configured, the user accesses the command line interface.
    The device generates a configuration file, applies the password authentication mode to the serial port ( user-interface console 0 ), and records the configured password.
The user must record the configured password to log in to the serial port for further management. If the user forgets the password and does not configure Telnet or SSH, the user will be unable to access the device.
Attack Methods

Without a serial server used, an attacker may attempt to break down physical isolation. Once an attacker accesses a serial port of a device, the device becomes exposed to the attacker, and the device is insecure. The attacker can damage the device even without obtaining a user name or password.
When a serial server used, attackers may attempt to crack user names and passwords over network connections and obtain the system administrator rights."
  solution    : "Configuration and Maintenance Methods

Configure AAA authentication the first time a device is accessed.
    Run system-view

    The system view is displayed.
    Run aaa

    The AAA view is displayed.
    Run local-user user-name password [ cipher password | irreversible-cipher irreversible-cipher-password ]

    The local user name and password are configured.
    Run local-user user-name service-type terminal

    The user access type is set to terminal.
    Run quit

    Exit the AAA view.
    Run user-interface interface-number

    The console user interface view is displayed.
    Run authentication-mode aaa

    AAA authentication is enabled.
Configuration and Maintenance Suggestions

Configure an appropriate authentication mode for a serial port to improve security.
Password authentication or AAA authentication can be used. It is recommended that AAA authentication be configured to authenticate users based on user names and passwords.
When no authentication mode is configured on a serial port, a user can log in to a device, access the console user interface (user-interface console 0), configure AAA authentication, and configure a user name and password in the AAA view.
Device passwords are stored in ciphertext. Therefore, a user must record the configured password because the user cannot restore the password if the password is lost."
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprise/en/doc/EDOC1100125841/8be849e2/management-plane#EN-US_CONCEPT_0192229585"
  expect  : "local-user.*service-type terminal"
</custom_item>


<custom_item>
  description : "Configure remote user authentication. HWTACACS"
  info        : "AAA is composed of three services: authentication, authorization, and accounting.
Authentication determines which users can access networks.
Authorization authorizes users before users can access some services.
Accounting records how network resources are utilized.
AAA is closely related to services and therefore its configuration is flexible.
Security Policy

    Remote authentication and authorization are supported. User information (including the user names, passwords, and attributes of local users) is configured on an authentication server. Remote authentication and authorization are implemented using Remote Authentication Dial In User Service (RADIUS) or HWTACACS. HWTACACS is an enhancement of relevant standards.
    Remote command authentication is supported. Remote authentication of command execution permission can be enabled for users assigned authorization levels. Information about users' command execution permission is stored on a remote server. When a user runs a command, the server determines whether the user's authorization level permits the user to execute the command. Currently, only HWTACACS can be used for remote command authentication.
    The maximum number of consecutive authentication failures for local users (AAA users) and the unlocking period for a locked user are set to prevent unauthorized logins. Once a pre-defined number of consecutive authentication failures for local users is reached, a user account is locked out for a pre-defined period of time to prevent unauthorized logins. In this way, the attempt success rate decreases, and the device security is enhanced.
    Local user passwords and authorization level upgrading passwords are securely stored in the system using advanced encryption algorithms.
    The none authentication mode cannot be configured for administrator users.
Attack Methods

    An attacker may traverse key information, such as user names and passwords, to acquire access to the system.
    An attacker may attack the remote server to obtain key information, such as user names and passwords.
    An attacker may attack the network between a user and a device to obtain key information, such as entered passwords. Although user information is encrypted when being transmitted over a network to a server, an attacker initiates a collision attack or traverses simple text and ciphertext dictionaries to decrypt user information."
  solution    : "Configuration and Maintenance Methods

    Configure remote user authentication and authorization. HWTACACS authentication and authorization are used as an example.
    # Create an HWTACACS template, and configure an authentication server, authorization server, and shared key.
    [~HUAWEI] hwtacacs-server template 1

    [*HUAWEI-hwtacacs-1] hwtacacs-server authentication 10.138.90.141 

    [*HUAWEI-hwtacacs-1] hwtacacs-server authorization 10.138.90.141

    [*HUAWEI-hwtacacs-1] hwtacacs-server shared-key huawei

    [*HUAWEI-hwtacacs-1] commit

    # Create an authentication scheme and set the authentication mode to HWTACACS in the authentication scheme.
    [~HUAWEI] aaa

    [~HUAWEI-aaa] authentication-scheme 1

    [*HUAWEI-aaa-authen-1] authentication-mode hwtacacs 

    [*HUAWEI-aaa-authen-1] commit

    # Set the authorization mode to HWTACACS in the authorization scheme.
    [~HUAWEI-aaa] authorization-scheme 1

    [*HUAWEI-aaa-author-1] authorization-mode hwtacacs 

    [*HUAWEI-aaa-author-1] commit

    # Specify the authentication scheme, authorization scheme, and HWTACACS template for the domain named dom1.
    [~HUAWEI-aaa] domain dom1

    [*HUAWEI-aaa-domain-dom1] authentication-scheme 1

    [*HUAWEI-aaa-domain-dom1] authorization-scheme 1

    [*HUAWEI-aaa-domain-dom1] hwtacacs-server 1

    [*HUAWEI-aaa-domain-dom1] commit

    # Remote HWTACACS authentication and authorization modes are used for users in dom1.
    RADIUS authentication and authorization cannot be enabled separately. After you set the authentication mode to remote RADIUS, the system automatically performs remote RADIUS authentication and authorization.
    Set the command authentication mode to remote.
    # Set the command authentication mode to remote for level 3 users in the authorization scheme.
    [~HUAWEI] aaa

    [~HUAWEI-aaa] authorization-scheme 1

    [*HUAWEI-aaa-author-1] authorization-cmd 3 hwtacacs

    [*HUAWEI-aaa-author-1] commit

    After the command authentication mode is set to remote, each time a user runs a command, the system sends an authentication request to the remote server, which determines whether the user is allowed to run this command. The status of the network between the device and the remote server affects the response time.
    Set the maximum number of allowed consecutive authentication failures for a local user.
    # Set the maximum number of allowed consecutive authentication failures in 1 minute to 3 for a local user.
    [~HUAWEI] aaa

    [~HUAWEI-aaa] user-block failed-times 3 period 1 

    [*HUAWEI-aaa] commit

    If failed-times is set to 0, the number of consecutive authentication failures is not restricted.
    # Set the unlocking period for a locked user to 30 minutes. The system will automatically unlock the user 30 minutes after the user is locked out because the account has reached the maximum number of consecutive login failures.
    [~HUAWEI-aaa] user-block reactive 30

    [*HUAWEI-aaa] commit

    If this parameter is set to 0, only the administrator can unlock the locked user.
    # Configure the administrator to unlock the locked user.
    <HUAWEI> activate aaa local-user root

    Configure the password strength function.
    [~HUAWEI] user-security-policy enable

    [*HUAWEI-aaa] commit

Configuration and Maintenance Suggestions

If the system displays a message indicating that the password needs to be changed to reduce risks, change the password as prompted."
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprise/en/doc/EDOC1100125841/8be849e2/management-plane#EN-US_CONCEPT_0192229586"
  expect  : "hwtacacs-server authentication"
</custom_item>


<custom_item>
  description : "Configure remote user authorization. HWTACACS"
  info        : "AAA is composed of three services: authentication, authorization, and accounting.
Authentication determines which users can access networks.
Authorization authorizes users before users can access some services.
Accounting records how network resources are utilized.
AAA is closely related to services and therefore its configuration is flexible.
Security Policy

    Remote authentication and authorization are supported. User information (including the user names, passwords, and attributes of local users) is configured on an authentication server. Remote authentication and authorization are implemented using Remote Authentication Dial In User Service (RADIUS) or HWTACACS. HWTACACS is an enhancement of relevant standards.
    Remote command authentication is supported. Remote authentication of command execution permission can be enabled for users assigned authorization levels. Information about users' command execution permission is stored on a remote server. When a user runs a command, the server determines whether the user's authorization level permits the user to execute the command. Currently, only HWTACACS can be used for remote command authentication.
    The maximum number of consecutive authentication failures for local users (AAA users) and the unlocking period for a locked user are set to prevent unauthorized logins. Once a pre-defined number of consecutive authentication failures for local users is reached, a user account is locked out for a pre-defined period of time to prevent unauthorized logins. In this way, the attempt success rate decreases, and the device security is enhanced.
    Local user passwords and authorization level upgrading passwords are securely stored in the system using advanced encryption algorithms.
    The none authentication mode cannot be configured for administrator users.
Attack Methods

    An attacker may traverse key information, such as user names and passwords, to acquire access to the system.
    An attacker may attack the remote server to obtain key information, such as user names and passwords.
    An attacker may attack the network between a user and a device to obtain key information, such as entered passwords. Although user information is encrypted when being transmitted over a network to a server, an attacker initiates a collision attack or traverses simple text and ciphertext dictionaries to decrypt user information."
  solution    : "Configuration and Maintenance Methods

    Configure remote user authentication and authorization. HWTACACS authentication and authorization are used as an example.
    # Create an HWTACACS template, and configure an authentication server, authorization server, and shared key.
    [~HUAWEI] hwtacacs-server template 1

    [*HUAWEI-hwtacacs-1] hwtacacs-server authentication 10.138.90.141 

    [*HUAWEI-hwtacacs-1] hwtacacs-server authorization 10.138.90.141

    [*HUAWEI-hwtacacs-1] hwtacacs-server shared-key huawei

    [*HUAWEI-hwtacacs-1] commit

    # Create an authentication scheme and set the authentication mode to HWTACACS in the authentication scheme.
    [~HUAWEI] aaa

    [~HUAWEI-aaa] authentication-scheme 1

    [*HUAWEI-aaa-authen-1] authentication-mode hwtacacs 

    [*HUAWEI-aaa-authen-1] commit

    # Set the authorization mode to HWTACACS in the authorization scheme.
    [~HUAWEI-aaa] authorization-scheme 1

    [*HUAWEI-aaa-author-1] authorization-mode hwtacacs 

    [*HUAWEI-aaa-author-1] commit

    # Specify the authentication scheme, authorization scheme, and HWTACACS template for the domain named dom1.
    [~HUAWEI-aaa] domain dom1

    [*HUAWEI-aaa-domain-dom1] authentication-scheme 1

    [*HUAWEI-aaa-domain-dom1] authorization-scheme 1

    [*HUAWEI-aaa-domain-dom1] hwtacacs-server 1

    [*HUAWEI-aaa-domain-dom1] commit

    # Remote HWTACACS authentication and authorization modes are used for users in dom1.
    RADIUS authentication and authorization cannot be enabled separately. After you set the authentication mode to remote RADIUS, the system automatically performs remote RADIUS authentication and authorization.
    Set the command authentication mode to remote.
    # Set the command authentication mode to remote for level 3 users in the authorization scheme.
    [~HUAWEI] aaa

    [~HUAWEI-aaa] authorization-scheme 1

    [*HUAWEI-aaa-author-1] authorization-cmd 3 hwtacacs

    [*HUAWEI-aaa-author-1] commit

    After the command authentication mode is set to remote, each time a user runs a command, the system sends an authentication request to the remote server, which determines whether the user is allowed to run this command. The status of the network between the device and the remote server affects the response time.
    Set the maximum number of allowed consecutive authentication failures for a local user.
    # Set the maximum number of allowed consecutive authentication failures in 1 minute to 3 for a local user.
    [~HUAWEI] aaa

    [~HUAWEI-aaa] user-block failed-times 3 period 1 

    [*HUAWEI-aaa] commit

    If failed-times is set to 0, the number of consecutive authentication failures is not restricted.
    # Set the unlocking period for a locked user to 30 minutes. The system will automatically unlock the user 30 minutes after the user is locked out because the account has reached the maximum number of consecutive login failures.
    [~HUAWEI-aaa] user-block reactive 30

    [*HUAWEI-aaa] commit

    If this parameter is set to 0, only the administrator can unlock the locked user.
    # Configure the administrator to unlock the locked user.
    <HUAWEI> activate aaa local-user root

    Configure the password strength function.
    [~HUAWEI] user-security-policy enable

    [*HUAWEI-aaa] commit

Configuration and Maintenance Suggestions

If the system displays a message indicating that the password needs to be changed to reduce risks, change the password as prompted."
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprise/en/doc/EDOC1100125841/8be849e2/management-plane#EN-US_CONCEPT_0192229586"
  expect  : "hwtacacs-server authorization"
</custom_item>


<custom_item>
  description : "User Interfaces Configured Inbound SSH"
  info        : "In order for users to access the system via SSH, each virtual terminal requires the inboud protocol to be enabled.
If all user-interfaces are configured for authentication and there is a FAILED result, this could be a result of the 'user-interfaces maximum-vty' is configured for more terminals than are configured."
  solution    : "Refer to :
  https://support.huawei.com/enterprise/en/doc/EDOC1100125450/8be849e2/management-plane#EN-US_CONCEPT_0192229587"
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "protocol inbound ssh"
</custom_item>


<custom_item>
  description : "SNMP read & write security"
  info        : "SNMP manages network devices. Network administrators can use SNMP to obtain data from devices or configure devices. SNMP supports trap alarms and inform alarms that devices automatically send to notify the NMS to events. The NE40E currently supports only Trap alarms.
Security Policy

SNMPv1, SNMPv2c, and SNMPv3 support different security policies.
SNMPv1 and SNMPv2c support ACLs and the view-based access control model (VACM). An NMS can manage a device with a specified SNMP community configured and access objects in a specified MIB view based on a specified ACL, effectively enhancing system security to some extent. SNMPv1 or SNMPv2c, however, does not support encryption algorithms.
In addition to support for ACLs and VACM, SNMPv3 supports the user-based security model (USM), authentication methods, and encryption algorithms. A supported authentication method can be message digest algorithm 5 (MD5) or secure hash algorithm (SHA). A supported encryption algorithm can be data encryption standard (DES), 3DES, Advanced Encryption Standard (AES), or DASS. Communication data is authenticated and encrypted to prevent security problems, such as message forging, modification, or disclosure.
Configure the lock mechanism for SNMP so that the IP address of a user is locked after the user fails the authentication. The lock mechanism is enabled by default.
To ensure high security, do not use the DES or 3DES algorithm as the SNMPv3 encryption algorithm.
Attack Methods

    User Name and Password Cracking

    An attacker continuously sends SNMPv1/SNMPv2c community names and SNMPv3 user names and passwords to crack authorized user names and passwords.
    Obtaining of Authorized Management Operations

        An attacker changes the source IP address of packets to obtain the authorized operation rights.
        An attacker monitors the communications between the NMS and SNMP agent to obtain the user name, password, and community name for the authorized operation rights.
        An attacker intercepts, reorders, delays, or retransmits SNMP messages to obtain the authorized operation rights.
    DoS Attack

    An attacker launches DoS attacks to slow the device response.
    Invalid Packet Attack

        An attacker sends invalid packets, such as overlong packets, packets with incorrect SNMP version, write-intended packets with the read right, SNMPv3 packets with incorrect contextname field, packets with incorrect security model, and packets with incorrect security level.
        An attacker sends invalid inform reply packets to the device.
    SNMP GetBulk Reply Magnifying DoS Attack

    SNMP packets are transmitted based on UDP, which is connectionless-oriented. To be specific, both the client and server do not record the peer status or implement data verification for the peer. In this case, the source IP address of such request packets sent from the client can be easily spoofed, causing the response packet to be sent to the bogus IP address. The attacker sends a short request packet and triggers response of overlong packets, causing packet flooding.
CPCAR-based security policies can be used to defend against flood attacks. If a device is connected to the public address space of the Internet, the management and control plane of the device may suffer from flood attacks. In this case, you can deploy a CPU attack defense policy to protect the device against traffic attacks."
  solution    : "Refer to :
  https://support.huawei.com/enterprise/en/doc/EDOC1100125450/8be849e2/management-plane#EN-US_CONCEPT_0192229588"
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprise/en/doc/EDOC1100125450/8be849e2/management-plane#EN-US_CONCEPT_0192229588"
  expect  : "snmp-agent community (read|write) cipher"
</custom_item>


<custom_item>
  description : "Configure an ACL to control permission to call in and out."
  info        : "Check to see if SSH access is restricted with ssh"
  solution    : "Refer to :
  https://support.huawei.com/enterprise/en/doc/EDOC1100125450/8be849e2/management-plane#EN-US_CONCEPT_0192229587"
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprise/en/doc/EDOC1100125450/8be849e2/management-plane#EN-US_CONCEPT_0192229588"
  expect  : "ssh server acl"
</custom_item>


<custom_item>
  description : "Change the port number to HIGHPORT."
  info        : "Change default port from 22 to higher ports"
  solution    : "ssh server port 54000"
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprise/en/doc/EDOC1100125450/8be849e2/management-plane#EN-US_CONCEPT_0192229588"
  expect  : "ssh server port"
</custom_item>


<custom_item>
  description : "SSH Server Version"
  info        : "The SSH version 1.0 is considered as unsecure and thus should not be used."
  solution    : "Run the undo ssh server compatible ssh1x enable command to enable SSHv2.
undo ssh server compatible-ssh1x enable"
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "undo ssh server compatible-ssh1x enable"
</custom_item>


<custom_item>
  description : "HTTPS Server is not configured"
  info        : "If management of HTTP is configured, secure HTTP should be used."
  solution    : "undo http server enable"
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  not_expect  : "http server"
</custom_item>


<custom_item>
  description : "SSH Max Retries <= 3"
  info        : "Allow no more than 3 incorrect password attempts. The default value of attempts is 3. Check for commands that would increase the number of attempts"
  solution    : "ssh server authentication-retries 3"
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "ssh server authentication-retries 3"
</custom_item>


<custom_item>
  description : "Disabling the Telnet Service"
  info        : "The Telnet login mode is insecure."
  solution    : "Run 
  \n\"undo telnet server enable\" 
  \n\"undo telnet ipv6 server enable\" 
  \ncommands to disable the Telnet service."
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "undo telnet server enable"
</custom_item>


<custom_item>
  description : "Binding management service protocol to management interface"
  info        : "Management service restrictions"
  solution    : "Refer to : 
  https://support.huawei.com/enterprise/en/doc/EDOC1100125450/12e11858/management-plane"
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprise/en/doc/EDOC1100125450/12e11858/management-plane"
  expect  : "server-source"
</custom_item>


<custom_item>
  description : "Use SFTP"
  info        : "Enable sftp service type on users"
  solution    : "Refer to :
  https://support.huawei.com/enterprise/en/doc/EDOC1100125841/8be849e2/management-plane#EN-US_CONCEPT_0172340756"
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "sftp.*server enable"
</custom_item>


<custom_item>
  description : "Disable FTP."
  info        : "The FTP protocol is insecure. If the FTP service is not used, disable it."
  solution    : "Run the 'undo ftp server' and 'undo ftp ipv6 server' commands to disable the FTP service.
If you have enabled SSH then SFTP is enabled automatically and you can use it."
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "undo FTP server enable"
</custom_item>


<custom_item>
  description : "SNMP is Configured"
  info        : "SNMP traps are configured for monitoring and alerting."
  solution    : "system-view 
configure snmp-agent"
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprise/en/doc/EDOC1100125841/8be849e2/management-plane#EN-US_CONCEPT_0192229588"
  expect  : "snmp-agent"
</custom_item>


<custom_item>
  description : "SNMP agent usm-user password complexity check"
  info        : "Configure password complexity check for SNMPv3 users."
  solution    : "undo snmp-agent [USERNAME] password complexity-check disable"
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "undo snmp-agent.*password complexity-check disable"
</custom_item>


<custom_item>
  description : "SNMP agent ACL"
  info        : "SNMP ACLs are configured to defend against attacks."
  solution    : "Configure SNMP ACLs to restrict this service.
Refer to:
https://support.huawei.com/enterprise/en/doc/EDOC1000141884/3b85e37e/example-for-applying-basic-acls-to-snmp-to-filter-nmss

https://support.huawei.com/enterprise/en/doc/EDOC1100112357/b8b8436/example-for-applying-basic-acls-to-snmp-to-filter-nmss

https://support.huawei.com/enterprise/en/doc/EDOC1000142066/3b85e37e/example-for-applying-basic-acls-to-snmp-to-filter-nmss"
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "snmp-agent.*acl"
</custom_item>


<custom_item>
  description : "Disabling the SNMPV1/V2 Service"
  info        : "The security level of SNMPv1v2 is low. Disable SNMPv1v2."
  solution    : "Run undo snmpagent sysinfo version {v1 | v2c}"
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  not_expect  : "snmp-agent.*version (1|v2c)"
</custom_item>


<custom_item>
  description : "RADIUS User Management"
  info        : "Configuring the RADIUS Authentication and Accounting Servers
    If one server is used for both authentication and accounting, different interfaces should be used for authentication and accounting.
    (Optional) Configuring the Algorithm for Selecting the RADIUS Server
    When there are more than one authentication or accounting server in a RADIUS server group, you can specify either the load balancing or master/backup mode for these RADIUS servers.
    (Optional) Configuring the Negotiated Parameters of the RADIUS Server
    A RADIUS server and the NE40E must use the same RADIUS parameters and message format to communicate.
    (Optional) Disabling RADIUS Attributes
    You must enable RADIUS attribute translation before disabling RADIUS attributes.
    (Optional) Configuring RADIUS Attribute Translation
    The NE40E can communicate with RADIUS servers from different vendors through the RADIUS attribute translation function.
    (Optional) Configuring the Source Interface of the RADIUS Server Group
    When the NE40E connects to multiple RADIUS servers, you can configure the source interface of each RADIUS server on the NE40E to identify the route between the NE40E and each RADIUS server.
    (Optional) Configuring the Status Parameters of the RADIUS Server
    You can configure the status parameters of a RADIUS server on the NE40E to monitor the RADIUS server status.
    (Optional) Configuring the Extended Source Ports of RADIUS
    If you do not want to use the default extended source interface to send and receive RADIUS packets, you can change the default extended source interface of the RADIUS server.
    Configuring DSCP Priorities for RADIUS Packets
    To prevent RADIUS packets sent by the NE40E from being discarded in the case of network congestion, you can configure DSCP values for the RADIUS Packets.
    Verifying the RADIUS Configuration
    After configuring a RADIUS server, you can view the server configurations, RADIUS attributes supported by the system, and statistics on RADIUS packets."
  solution    : "Full guide here :
  https://support.huawei.com/enterprise/en/doc/EDOC1100055025/e0935239/configuring-the-radius-server"
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprise/en/doc/EDOC1100055025/e0935239/configuring-the-radius-server"
  expect  : "radius-server shared-key.*(authentication|accounting)"
</custom_item>


<custom_item>
  description : "HWTACACS User Management"
  info        : "HWTACACS is an enhancement of TACACS+, an access control protocol. Similar to RADIUS, HWTACACS communicates with a TACACS server using the server/client model to implement AAA functions for various users, such as PPP users and login users."
  solution    : "Run the hwtacacs-server shared-key cipher key-string command to configure a shared key for each HWTACACS group. The shared key is used to encrypt passwords transmitted over HWTACACS using MD5, increasing transmission
security. The cipher keyword is used when the shared key is configured. When the shared key is queried, the encrypted key is displayed, increasing key security"
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprise/en/doc/EDOC1100055025/5f3814cf/example-for-configuring-hwtacacs-authentication-and-authorization-for-administrators
  https://support.huawei.com/enterprise/en/doc/EDOC1100055026/8b94027b/deploying-the-tacacs-for-command-line-authorization"
  expect  : "hwtacacs-server shared-key cipher"
</custom_item>


<custom_item>
  description : "Force Authentication"
  info        : "Enable authentication, authorization, and accounting (AAA) authentication to determine if a user can access the privileged command level. Default value for authentication is local users, which provides minimal authentication. Check looks for authentication turned off in any schemes."
  solution    : "Refer to :
  https://support.huawei.com/enterprise/en/doc/EDOC1100146884/8be849e2/management-plane#EN-US_CONCEPT_0192229584"
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  not_expect  : "authentication-mode none"
</custom_item>


<custom_item>
  description : "Force Authorization"
  info        : "Security Policy

Serial ports are physical interfaces. Isolating serial ports in device deployment and networking can prevent malicious users from accessing devices by means of serial ports.
Serial ports support password authentication and authentication, authorization and accounting (AAA) authentication. Users can log in to a device through serial ports only after being authenticated. Authentication must be configured because no default authentication is available. Passwords used in authentication are encrypted using an irreversible algorithm.
When a device is started for the first time, no authentication configuration is available. Therefore, a user must configure authentication information using a serial port:
    Connect a PC to the serial port of the device, access the serial port, and presses Enter. The system prompts the user to configure and confirm a password. After the password is successfully configured, the user accesses the command line interface.
    The device generates a configuration file, applies the password authentication mode to the serial port ( user-interface console 0 ), and records the configured password."
  solution    : "Refer to :
  https://support.huawei.com/enterprise/en/doc/EDOC1100125841/8be849e2/management-plane#EN-US_CONCEPT_0192229584"
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprise/en/doc/EDOC1100125841/8be849e2/management-plane#EN-US_CONCEPT_0192229583"
  not_expect  : "authorization-mode none"
</custom_item>


<custom_item>
  description : "gRPC"
  info        : "Security Policy Introduction

    Supports authentication

    A gRPC server supports AAA authentication. Only authenticated users can log in to a device and perform related operations. If a user repeatedly logs in and cracks the password, the server rejects the login based on the password authentication timeout period.
    Supports the SSL service

    A gRPC server supports SSL certificate authentication.
    Supports function disabling

    If a gRPC server is enabled, the socket listening is enabled for devices. In this case, the devices are easily scanned by attackers. If a gRPC server is not used, the gRPC server and the port listened can be disabled. The gRPC server is disabled by default.
    Supports port number changing

    The port of a gRPC server can be changed to a private port to reduce the probability of being scanned and attacked.
    Supports ACLs

    ACLs can be configured for a gRPC server in the system view. ACLs are used to limit the client IP addresses that can access a device.
    Supports source interface configuration

    Source interfaces supported by a gRPC server can be configured. Users must access a device using the IP addresses of the configured source interfaces. In this way, the access range is controlled and the device security is enhanced.
Attack Method Introduction

    DoS Attack

    A gRPC server supports a limited number of users. When the number of admitted users reaches the upper limit, other users cannot access the device. This situation may appear when users normally use the gRPC server or when the gRPC server is attacked."
  solution    : "Refer to :
  https://support.huawei.com/enterprise/en/doc/EDOC1100146884/12e11858/management-plane#EN-US_CONCEPT_0192229597"
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "grpc.*undo server enable"
</custom_item>


<custom_item>
  description : "Disabling Specific Service Interfaces from Sending Management Protocol Packets to the Management Plane Using MPAC"
  info        : "Networking Requirements

Specific service interfaces are disabled from sending management protocol packets to the management plane so that the management plane receives management protocol packets only from the other service interfaces."
  solution    : "Refer to :
  https://support.huawei.com/enterprise/en/doc/EDOC1100055026/b0142cd2/outband-nms
  
  Configuration Roadmap
Create two MPAC policy profiles: one for global application, and the other for interface application. Configure a rule to disable management protocol packets from being sent to the management plane in the globally applied profile. Configure a rule to allow only specific management protocol packets to be sent to the management plane in the profile applied to an interface. The configuration roadmap is as follows:
    Create two MPAC policy profiles in the system view, with one being applied globally and the other being applied to an interface.
    Disable management protocol packets from being sent to the management plane in the profile for global application, and allow only specific management protocol packets to be sent to the management plane in the profile for interface application.
    Apply the former policy globally and the latter policy to GE 3/0/1 and the management network interface GE 0/0/0.
    Check the configurations and the number of dropped packets.
    Create two MPAC policy profiles in the system view, with one being applied globally and the other being applied to an interface.
    [~HUAWEI] service-security policy ipv4 global
    [*HUAWEI-service-sec-global] commit
    [*HUAWEI-service-sec-global] quit
    [~HUAWEI] service-security policy ipv4 interface
    [*HUAWEI-service-sec-interface] commit
    [*HUAWEI-service-sec-global] quit

    Disable FTP, SNMP, SSH, Telnet, and TFTP protocol packets from being sent to the management plane in the profile for global application, and allow only FTP, SNMP, SSH, Telnet, and TFTP protocol packets to be sent to the management plane in the profile for interface application.
    [*HUAWEI-service-sec-global] rule deny protocol ftp
    [*HUAWEI-service-sec-global] rule deny protocol snmp
    [*HUAWEI-service-sec-global] rule deny protocol ssh
    [*HUAWEI-service-sec-global] rule deny protocol telnet
    [*HUAWEI-service-sec-global] rule deny protocol tftp
    [*HUAWEI-service-sec-global] commit
    [~HUAWEI-service-sec-global] quit
    [*HUAWEI-service-sec-interface] rule permit protocol ftp
    [*HUAWEI-service-sec-interface] rule permit protocol snmp
    [*HUAWEI-service-sec-interface] rule permit protocol ssh
    [*HUAWEI-service-sec-interface] rule permit protocol telnet
    [*HUAWEI-service-sec-interface] rule permit protocol tftp
    [*HUAWEI-service-sec-interface] commit
    [~HUAWEI-service-sec-interface] quit

    Apply the former policy globally and the latter policy to GE 3/0/1 and the management network interface GE 0/0/0.
    [~HUAWEI] interface GigabitEthernet 0/0/0
    [*HUAWEI-GigabitEthernet0/0/0] service-security binding ipv4 interface
    [*HUAWEI-GigabitEthernet0/0/0] commit
    [~HUAWEI-GigabitEthernet0/0/0] quit
    [~HUAWEI] interface GigabitEthernet 3/0/1
    [*HUAWEI-GigabitEthernet3/0/1] service-security binding ipv4 interface
    [*HUAWEI-GigabitEthernet3/0/1] commit
    [~HUAWEI-GigabitEthernet3/0/1] quit
    [*HUAWEI] service-security global-binding ipv4 global
    [*HUAWEI] commit

    Verify the configuration.
    [~HUAWEI] display service-security binding ipv4 
      Configured : Global
      Policy Name: global
      
    Interface  : GigabitEthernet0/0/0
      Policy Name: interface
      
    Interface  : GigabitEthernet3/0/1
      Policy Name: interface
    [~HUAWEI] display service-security policy ipv4
      Policy Name : global
      Step        : 5
       rule 5 deny protocol ftp
       rule 10 deny protocol snmp
       rule 15 deny protocol ssh
       rule 20 deny protocol tftp
       rule 25 deny protocol telnet

    Policy Name : interface
    Step        : 5
     rule 5 permit protocol ftp
     rule 10 permit protocol snmp
     rule 15 permit protocol ssh
     rule 20 permit protocol tftp
     rule 25 permit protocol telnet

    Check whether all management protocol packets are dropped and whether all service interfaces do not send management protocol packets to the management plane.
    [~HUAWEI] display service-security statistics ipv4 
      Policy Name : global
      Step        : 5
       rule 5 deny protocol ftp (9 times matched)
       rule 10 deny protocol snmp (0 times matched)
       rule 15 deny protocol ssh (0 times matched)
       rule 20 deny protocol tftp (0 times matched)
       rule 25 deny protocol telnet (20 times matched)
      
    Policy Name : interface
    Step        : 5
     rule 5 permit protocol ftp (100 times matched)
     rule 10 permit protocol snmp (0 times matched)
     rule 15 permit protocol ssh (0 times matched)
     rule 20 permit protocol tftp (0 times matched)
     rule 25 permit protocol telnet (652 times matched)"
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprise/en/doc/EDOC1100055026/b0142cd2/outband-nms"
  expect  : "service-security binding ipv4 interface"
</custom_item>


<custom_item>
  description : "Binding a Management VPN to a Service Interface"
  info        : "Networking Requirements

An independent VPN is bound to a service interface so that only the service interface can receive management protocol packets.
Configuration Roadmap

Create an mVPN. Bind the mVPN to selected service interfaces and loopback interface and bind another VPN to the other service interfaces so that the interfaces in different VPNs cannot intercommunicate."
  solution    : "Refer to :
  https://support.huawei.com/enterprise/en/doc/EDOC1100058390/291d7d68/vpn-based-inband-nms"
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "ip binding vpn-instance management"
</custom_item>


<custom_item>
  description : "Disabling the Service Plane from Sending Management Protocol Packets to the Management Plane"
  info        : "Networking Requirements

The service plane is disabled from sending management protocol packets to the management plane so that the management plane receives management protocol packets only from the management network interface.
Configuration Roadmap
The configuration roadmap is as follows:
    Create a global MA-defend policy to disable the service plane from sending management protocol packets to the management plane.
    Check the configurations and the number of dropped packets."
  solution    : "Procedure

    Create a global MA-defend policy to disable the service plane from sending FTP, SNMP, SSH, Telnet, and TFTP protocol packets to the management plane.
    [~HUAWEI] ma-defend global-policy

    [*HUAWEI-app-sec-global] protocol ftp deny
    [*HUAWEI-app-sec-global] protocol snmp deny
    [*HUAWEI-app-sec-global] protocol ssh deny
    [*HUAWEI-app-sec-global] protocol telnet deny
    [*HUAWEI-app-sec-global] protocol tftp deny
    [*HUAWEI-app-sec-global] enable
    [*HUAWEI-app-sec-global] commit
    [~HUAWEI-app-sec-global] quit

    Verify the configuration.
    [~HUAWEI] display ma-defend global-policy

    MA-defend policy type: global-policy
    ----------------------------------------------------
      The global-policy is enabled
      --------------------------------------------------
      protocol       rule
      --------------------------------------------------
      FTP            deny
      SSH            deny
      SNMP           deny
      TELNET         deny
      TFTP           deny

    Check whether all the service interfaces drop management protocol packets.
    [~HUAWEI] display cpu-defend ma-defend statistics

    Slot/Intf Attack-Type               Total-Packets Passed-Packets Dropped-Packets
    -------------------------------------------------------------------------------
    3         MA-Defend                            100            0               100
    -------------------------------------------------------------------------------
              FTP SERVER                           100            0               100"
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "ma-defend global-policy"
</custom_item>


<custom_item>
  description : "PPP Authentication Policy"
  info        : "Protocol security policy : Provides optional authentication parameters. By default, no authentication is implemented for communications between two ends. PPP provides two authentication modes: Password Authentication Protocol (PAP) and Challenge Hand Authentication Protocol (CHAP), and supports passwords in simple text and ciphertext.
An attacker sends a large number of PPP packets to a device."
  solution    : " - Configure an authentication mode: no authentication, PAP authentication, or CHAP authentication.
 - Configure the packet validation function. This function is configured by default.
 - Configure CHAP authentication to enhance PPP security."
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprise/en/doc/EDOC1100147911/5e7a58c1/ppp-configuration"
  expect  : "ppp authentication-mode (pap|chap|auto)"
</custom_item>


<custom_item>
  description : "CPU Protection by Limiting the Packet Rate Based on the CP-CAR"
  info        : "The packet rate is limited based on the CP-CAR as follows:
● Packets sent to the CPU are classified based on protocol types.
● The bandwidth, priority, length of packets that are sent from the forwarding
plane to the CPU are controlled based on the CP-CAR.
● The total forwarding bandwidth is controlled.
In this manner, the number of packets sent to the CPU is under control, and the
bandwidth is ensured preferentially for services with higher priorities. In addition,
CPU overload is prevented and an alarm is generated when an attack occurs.
Currently, services are negatively affected when the CPU is attacked because of
the following reasons:
1. Valid protocol packets are not distinguished from invalid protocol packets. The
CPU is busy in processing a large number of invalid protocol packets.
Consequently, the CPU usage rises sharply and valid packets cannot be
processed properly.
2. Packets of some protocols are sent to the CPU through the same channel.
When a loopback occurs on a certain type of protocol packet, the channel is
blocked, affecting the transmission of other protocol packets.
3. The bandwidth of a channel is not set appropriately. When an attack occurs,
processing of protocol packets on other channels is affected. To prevent
security accidents caused by man-made errors or IT management, the
following measures must be taken:
a. Collect and classify protocols related to services running on equipment.
b. Use ACLs to filter Layer 3 packets. Valid protocol packets are put into the
whitelist and a user-defined flow, other packets are put into the blacklist.
c. Plan the priorities, channel bandwidth, and alarm function of the
preceding three lists.
d.Restrict the bandwidths for non-Layer-3 services, and disable services that
are not deployed on the equipment.
In this document, common protocols are classified and related processing
suggestions are proposed based on the services on the live network and the
service attack information. This following describes specific configuration
procedures."
  solution    : "The following example uses CP-CAR configuration to describe how to add a
trusted network segment to a whitelist.
1.
Run system-view
The system view is displayed.
2.
Run acl { [ number ] acl-number | name acl-name [ number acl-number ] }
[ match-order { auto | config } ]
The advanced ACL is configured.
3.
Run rule [ rule-id ] permit [ fragment-type fragment-type-name | source
{ source-ip-address source-wildcard | any } | time-range time-name | vpn-
instance vpn-instance-name ] *
The trusted network segment is specified in an ACL rule.
4.
Run rule [ rule-id ] deny [ fragment-type fragment-type-name | source
{ source-ip-address source-wildcard | any } | time-range time-name | vpn-
instance vpn-instance-name ] *
The trusted network segment is specified in an ACL rule.
5.
Run commit
The configuration is committed.
6.
Run quit
Return to the system view.
7.
Run cpu-defend policy policy-number
An attack defense policy is created.
8.
Run whitelist acl acl-number
A whitelist is created.
By default, the whitelist function is enabled. To disable the whitelist function,
run the whitelist disable command.
9.
Run car whitelist { cir cir-value | cbs cbs-value } *
The bandwidth for incoming packets to be sent to the CPU is configured in
the whitelist.
10. Run priority whitelist { high | middle | low }
The priority of incoming packets to be sent to the CPU is configured in the
whitelist.
11. Run commit
The configuration is committed.
12. Run quit,Exit from the policy view.
13. Run slot slot-number
The interface board view is displayed.
14. Run cpu-defend policy policy-number
The attack defense policy is bound to the interface board.
The attack defense function takes effect on an interface board only after the
interface board is bound to an attack defense policy.
15. Run commit
The configuration is committed."
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "process-sequence tcpsyn-flood fragment-flood dynamic-link-protection.*|cpu-defend policy"
</custom_item>


<custom_item>
  description : "Set the number of the port that receives NTP packets to 1026."
  info        : "Rapid network development poses higher network security requirements. Network
Time Protocol (NTP) packets transmitted over networks may be changed, and
packet attacks may cause network interruption and disturb the synchronization,
which may lead to data loss on the network. Therefore, packets need to be
protected.
NTP supports the following security policies:
● NTP support authentication to prevent receiving of bad synchronization data,
error packets, and replay attacks from the networks.
● NTP supports the whitelist function. NTP creates a whitelist security label for
each known port to rapidly exchange packets. This function is necessary for
quick convergence on the network. If ports that send packets are not in the
whitelist, they will only be assigned a default low bandwidth to prevent DOS
attacks.
● NTP allows you to run commands to change the default port number that
receives NTP packets.
● You can set access authority to protect local NTP services. This is a simple
measure to ensure security.

Attack Methods
If authentication is configured on the client and server, NTP will accept the
packets only if packets are authenticated to prevent accepting packets from
unauthenticated peers.
To protect against subnet attacks, you can choose trusted time servers and allow
only these trusted time servers to be the synchronization source."
  solution    : "NTP allows you to run commands to change the default port number that receives
NTP packets.
Set the number of the port that receives NTP packets to 1026.
[~HUAWEI] ntp-service port 1026"
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "ntp-service port"
</custom_item>


<custom_item>
  description : "NTP - Allow the peers matching IPv4 ACL 2000 and IPv6 ACL 2002 to perform time request, query control, and time synchronization on the local device."
  info        : "Allow the peers matching IPv4 ACL 2000 and IPv6 ACL 2002 to perform time request, query control, and time synchronization on the local device."
  solution    : "# Allow the peers matching IPv4 ACL 2000 and IPv6 ACL 2002 to perform
time request, query control, and time synchronization on the local device.
[~HUAWEI] ntp-service access peer 2000 ipv6 2002
[*HUAWEI] commit
[~HUAWEI] display current-configuration | include ntp
#
ntp-service access peer 2000 ipv6 2002
#
NTP allows you to run commands to change the default port number that receives
NTP packets."
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "ntp-service access peer"
</custom_item>


<custom_item>
  description : "Binding a VPN to Management Interfaces"
  info        : "Configuration Roadmap
Bind the mVPN to the management network interface and the loopback interface for management and bind another VPN to service interfaces so that the service interfaces are isolated from the management plane."
  solution    : "Configuration Procedure
Create a management VPN.

<HUAWEI> system-view
[~HUAWEI] ip vpn-instance management
[*HUAWEI-vpn-instance-management] ipv4-family
[*HUAWEI-vpn-instance-management] commit
[~HUAWEI-vpn-instance-management-af-ipv4] quit
[~HUAWEI-vpn-instance-management] display this 
#                                                                               
ip vpn-instance management                                                      
 ipv4-family                                                                    
#                                                                               
return  
[~HUAWEI-vpn-instance-management] quit
Bind the VPN to the management interface and loopback interface for management.
[~HUAWEI] interface GigabitEthernet0/1/0
[~HUAWEI-GigabitEthernet0/1/0] ip binding vpn-instance management
[*HUAWEI-GigabitEthernet0/1/0] commit
[~HUAWEI-GigabitEthernet0/1/0] quit 
[~HUAWEI] interface LoopBack0
[~HUAWEI-LoopBack0] ip binding vpn-instance management
[*HUAWEI-LoopBack0] commit
[~HUAWEI-LoopBack0] quit
Configure IP addresses for the management interface and loopback interface for management.
[~HUAWEI] interface GigabitEthernet0/1/0
[~HUAWEI-GigabitEthernet0/1/0] ip address 10.10.11.100 24
[*HUAWEI-GigabitEthernet0/1/0] commit
[~HUAWEI-GigabitEthernet0/1/0] display this
#
interface GigabitEthernet0/1/0
 undo shutdown
 ip binding vpn-instance management
 ip address 10.10.11.100 255.255.255.0
#
[~HUAWEI] interface LoopBack0
[~HUAWEI-LoopBack0] ip address 1.1.1.1 32
[*HUAWEI-LoopBack0] commit
[~HUAWEI-LoopBack0] display this
#
interface LoopBack0
 ip binding vpn-instance management
 ip address 1.1.1.1 255.255.255.255
#
return
[~HUAWEI-LoopBack0] quit
View the routing table to check whether routes on the management and control planes are isolated.
[~HUAWEI] display ip routing-table
Route Flags: R - relay, D - download to fib, T - to vpn-instance, B - black hole route
------------------------------------------------------------------------------
Routing Tables: Public
         Destinations : 2        Routes : 2

Destination/Mask    Proto   Pre  Cost      Flags NextHop         Interface

      127.0.0.0/8   Direct  0    0           D   127.0.0.1       InLoopBack0
      127.0.0.1/32  Direct  0    0           D   127.0.0.1       InLoopBack0

[~HUAWEI] display ip routing-table vpn-instance management
Route Flags: R - relay, D - download to fib, T - to vpn-instance, B - black hole route
------------------------------------------------------------------------------
Routing Tables: management
         Destinations : 3        Routes : 3

Destination/Mask    Proto   Pre  Cost      Flags NextHop         Interface

        1.1.1.1/32  Direct  0    0           D   127.0.0.1       LoopBack0
     10.10.11.0/24  Direct  0    0           D   10.10.11.100    GigabitEthernet0/1/0
   10.10.11.100/32  Direct  0    0           D   127.0.0.1       GigabitEthernet0/1/0

Perform the ping operation to check whether routes on the management and control planes are isolated.
<HUAWEI> ping 10.10.11.100
PING 10.10.11.100: 56  data bytes, press CTRL_C to break
    Request time out
    Request time out
    Request time out
    Request time out
    Request time out

  --- 10.10.11.100 ping statistics ---
    5 packet(s) transmitted
    0 packet(s) received
    100.00% packet loss
<HUAWEI> ping -vpn-instance management 10.10.11.100
PING 10.10.11.100: 56  data bytes, press CTRL_C to break
    Reply from 10.10.11.100: bytes=56 Sequence=1 ttl=255 time=1 ms
    Reply from 10.10.11.100: bytes=56 Sequence=2 ttl=255 time=30 ms
    Reply from 10.10.11.100: bytes=56 Sequence=3 ttl=255 time=10 ms
    Reply from 10.10.11.100: bytes=56 Sequence=4 ttl=255 time=30 ms
    Reply from 10.10.11.100: bytes=56 Sequence=5 ttl=255 time=30 ms

  --- 10.10.11.100 ping statistics ---
    5 packet(s) transmitted
    5 packet(s) received
    0.00% packet loss
    round-trip min/avg/max = 1/20/30 ms"
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "ip binding vpn-instance management"
</custom_item>


<custom_item>
  description : "Configure an SNMPv3 user"
  info        : "For security purposes, disabling the insecure SNMPv1 and SNMPv2c is recommended. Configure SNMPv3 users with authentication and encryption configuration, an SNMPv3 authentication encryption mode to manage devices, and associate an ACL and MIB view with the user to control access rights."
  solution    : "Configure an SNMPv3 user named v3user in a group named v3group. Set the authentication mode to AES128 and the password to Hello-2012 entered in user confirmation mode.

[~HUAWEI] snmp-agent usm-user v3 v3user v3group
[*HUAWEI] snmp-agent usm-user v3 v3user v3group acl 2001
[*HUAWEI] snmp-agent usm-user v3 v3user v3group authentication-mode sha Hello-1234 privacy-mode aes128 Hello-2012
[*HUAWEI] commit"
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "snmp-agent.*v3.*authentication-mode sha2.*aes128"
</custom_item>


<custom_item>
  description : "Configure an SNMPv3 group named v3group, associate the read view, write view, and notification view named iso-view with the group, and associate ACL 2001 with the group."
  info        : "SNMPv1, SNMPv2c, and SNMPv3 support different security policies.

SNMPv1 and SNMPv2c support ACLs and the view-based access control model (VACM). An NMS can manage a device with a specified SNMP community configured and access objects in a specified MIB view based on a specified ACL, effectively enhancing system security to some extent. SNMPv1 or SNMPv2c, however, does not support encryption algorithms.

In addition to support for ACLs and VACM, SNMPv3 supports the user-based security model (USM), authentication methods, and encryption algorithms. A supported authentication method can be message digest algorithm 5 (MD5) or secure hash algorithm (SHA). A supported encryption algorithm can be data encryption standard (DES), 3DES, Advanced Encryption Standard (AES), or DASS. Communication data is authenticated and encrypted to prevent security problems, such as message forging, modification, or disclosure.

Configure the lock mechanism for SNMP so that the IP address of a user is locked after the user fails the authentication. The lock mechanism is enabled by default.
Attack Methods
User Name and Password Cracking

An attacker continuously sends SNMPv1/SNMPv2c community names and SNMPv3 user names and passwords to crack authorized user names and passwords.

Obtaining of Authorized Management Operations

An attacker changes the source IP address of packets to obtain the authorized operation rights.

An attacker monitors the communications between the NMS and SNMP agent to obtain the user name, password, and community name for the authorized operation rights.

An attacker intercepts, reorders, delays, or retransmits SNMP messages to obtain the authorized operation rights.

DoS Attack

An attacker launches DoS attacks to slow the device response.

Invalid Packet Attack

An attacker sends invalid packets, such as overlong packets, packets with incorrect SNMP version, write-intended packets with the read right, SNMPv3 packets with incorrect contextname field, packets with incorrect security model, and packets with incorrect security level.

An attacker sends invalid inform reply packets to the device.

SNMP GetBulk Reply Magnifying DoS Attack

SNMP packets are transmitted based on UDP, which is connectionless-oriented. To be specific, both the client and server do not record the peer status or implement data verification for the peer. In this case, the source IP address of such request packets sent from the client can be easily spoofed, causing the response packet to be sent to the bogus IP address. The attacker sends a short request packet and triggers response of overlong packets, causing packet flooding.

CPCAR-based security policies can be used to defend against flood attacks. If a device is connected to the public address space of the Internet, the management and control plane of the device may suffer from flood attacks. In this case, you can deploy a CPU attack defense policy to protect the device against traffic attacks."
  solution    : "Configure an SNMPv3 group named v3group, associate the read view, write view, and notification view named iso-view with the group, and associate ACL 2001 with the group.

[~HUAWEI] snmp-agent group v3 v3group privacy read-view iso-view write-view iso-view notify-view iso-view acl 2001
[*HUAWEI] commit"
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprise/en/doc/EDOC1100125841/8be849e2/management-plane#EN-US_CONCEPT_0192229588"
  expect  : "snmp-agent group v3.*privacy read-view.*write-view.*notify-view .*acl"
</custom_item>


<custom_item>
  description : "Configure a mib-view named iso-view to access nodes under the sub-tree whose root node is the International Organization for Standardization (ISO)."
  info        : "Snmp security should be enforced on all devices."
  solution    : "onfigure a mib-view named iso-view to access nodes under the sub-tree whose root node is the International Organization for Standardization (ISO).

[~HUAWEI] snmp-agent
[*HUAWEI] snmp-agent mib-view included iso-view iso
[*HUAWEI] commit"
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "snmp-agent mib-view included iso-view iso"
</custom_item>


<custom_item>
  description : "Configure an SNMP ACL"
  info        : "Snmp Acls will protect devices from unauthorized access."
  solution    : "Configure an SNMP ACL.

[~HUAWEI] snmp-agent acl 2001
[*HUAWEI] commit"
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "snmp-agent acl"
</custom_item>


<custom_item>
  description : "Disable insecure SNMPv1 and SNMPv2c (if unnecessary)."
  info        : "For security purposes, disabling the insecure SNMPv1 and SNMPv2c is recommended. Configure SNMPv3 users with authentication and encryption configuration, an SNMPv3 authentication encryption mode to manage devices, and associate an ACL and MIB view with the user to control access rights."
  solution    : "Disable insecure SNMPv1 and SNMPv2c (if unnecessary).

[~HUAWEI] undo snmp-agent sys-info version v1 v2c
[*HUAWEI] commit"
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "undo snmp-agent sys-info version v1 v2c"
</custom_item>


<custom_item>
  description : "Specify the source IPv6 address for a user to access the SSH server."
  info        : "Authorized source IP addresses can be configured for accessing SSH service over IPV6"
  solution    : "Specify the source IPv6 address for a user to access the SSH server.

Run system-view

The system view is displayed.

Run ssh ipv6 server-source -a ipv6-address [ -vpn-instance vpn-instance-name ]
The source IPv6 address for an SSH server is specified.

VPN configuration must be successful, to configure the vpn instance using this command.

Run commit

The configuration is committed."
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "ssh ipv6 server-source -a"
</custom_item>


<custom_item>
  description : "Specify the source interface for a user to access the SSH server."
  info        : "Before specifying the source interface of an SSH server, ensure that a loopback interface to be used as a source interface has been created. If a loopback interface has not yet been created, the ssh server-source command cannot be executed.
"
  solution    : "Specify the source interface for a user to access the SSH server.

Run system-view

The system view is displayed.

Run ssh server-source -i loopback interface-number
The source interface for an SSH server is specified.

Run commit

The configuration is committed."
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "ssh server-source -i loopback"
</custom_item>


<custom_item>
  description : "Disable the STelnet server function."
  info        : "Disable Stelnet and use SSH as a best practice."
  solution    : "Disable the STelnet server function.

Run system-view

The system view is displayed.

Run undo stelnet server enable

The STelnet service is disabled. This function is enabled by default, and STelnet enables users to establish SSH connections to a device.

Run commit

The configuration is committed."
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprise/en/doc/EDOC1100125841/8be849e2/management-plane#EN-US_CONCEPT_0192229587"
  expect  : "undo stelnet server enable"
</custom_item>


<custom_item>
  description : "Set the maximum number of allowed consecutive authentication failures for a local user."
  info        : "Set the unlocking period for a locked user to 30 minutes. The system will automatically unlock the user 30 minutes after the user is locked out because the account has reached the maximum number of consecutive login failures."
  solution    : "Set the maximum number of allowed consecutive authentication failures for a local user.

# Set the maximum number of allowed consecutive authentication failures in 1 minute to 3 for a local user.

[~HUAWEI] aaa
[~HUAWEI-aaa] user-block failed-times 3 period 1 
[*HUAWEI-aaa] commit

If failed-times is set to 0, the number of consecutive authentication failures is not restricted.

# Set the unlocking period for a locked user to 30 minutes. The system will automatically unlock the user 30 minutes after the user is locked out because the account has reached the maximum number of consecutive login failures.

[~HUAWEI-aaa] user-block reactive 30
[*HUAWEI-aaa] commit

If this parameter is set to 0, only the administrator can unlock the locked user.

# Configure the administrator to unlock the locked user.

<HUAWEI> activate aaa local-user root"
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "user-block failed-times.*period.*"
</custom_item>


<custom_item>
  description : "Set the command authentication mode to remote."
  info        : "Set the command authentication mode to remote for level 3 users in the authorization scheme."
  solution    : "Set the command authentication mode to remote.
# Set the command authentication mode to remote for level 3 users in the authorization scheme.
[~HUAWEI] aaa
[~HUAWEI-aaa] authorization-scheme 1
[*HUAWEI-aaa-author-1] authorization-cmd 3 hwtacacs
[*HUAWEI-aaa-author-1] commit

After the command authentication mode is set to remote, each time a user runs a command, the system sends an authentication request to the remote server, which determines whether the user is allowed to run this command. The status of the network between the device and the remote server affects the response time."
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "authorization-cmd.*hwtacacs"
</custom_item>


<custom_item>
  description : "IPv6 Management Plane Access Control"
  info        : "Security Policy
Management Plane Access Control (MPAC) enhances system security by protecting devices against Denial of Service (DoS) attacks.

In a common deployment scenario, the router may run multiple services at the same time, such as Layer 2 services MSTP, routing services OSPF and BGP, MPLS services LDP and RSVP, system service TFTP server, and diagnostic functions ping and tracert.

This enables attackers to send various attack packets to the router. Unless protective features such as MPAC are enabled, the router sends packets destined for its interfaces (including the loopback interface) directly to the CPU without any filtering. As a result, CPU and system resources are wasted and the system comes under DoS attacks.

To prevent such attacks, define an MPAC policy to filter packets.

The NE40E supports definitions of Management Plane Access Control (MPAC) policies that can be applied to sub-interfaces, to interfaces, or globally on the NE40E.

After you define the rules for an MPAC policy, the NE40E filters packets destined for the CPU. If no such policy is defined, the CPU remains vulnerable to attacks.

Attack Modes
To prevent an attacker from sending various types of TCP/IP attack packets to paralyze Device A, MPAC is deployed on Device A, as shown in Figure 7-8."
  solution    : "Configuration and Maintenance Methods
Configure IPv6 MPAC on Device A.

<DeviceA> system-view
[DeviceA] service-security policy ipv6 test
[DeviceA-service-sec-test] rule 10 deny protocol ip source-ip 2001:db8:1::1 0
[DeviceA-service-sec-test] step 10
[DeviceA-service-sec-test] description rule 10 is deny ip packet which from 2001:db8:1::1
[DeviceA-service-sec-test] commit
[DeviceA-service-sec-test] quit
[DeviceA] service-security global-binding ipv6 test
[DeviceA] commit
[DeviceA] interface gigabitethernet 1/0/0
[DeviceA-GigabitEthernet1/0/0] service-security binding ipv6 test
[DeviceA-GigabitEthernet1/0/0] commit
"
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprise/br/doc/EDOC1100125841/3a1d1df9/control-plane#EN-US_CONCEPT_0192251902"
  expect  : "service-security binding ipv6"
</custom_item>


<custom_item>
  description : "Enable the IPv6 SEND function."
  info        : "Specify a rate limit for the system to compute or verify the RSA signature in a specified period (1s), the key length that is supported by an interface, and timestamp of ND packets. The received ND packets that do not match these configured parameters are considered invalid."
  solution    : "Enable the IPv6 SEND function.
Run the system-view command to enter the system view.

(Optional) Run the ipv6 nd security rate-limit ratelimit-value command to set limit for the system to compute or verify the RSA signature in a specified period (1s).

By default, no rate limit is set for the system to process the RSA signature.

Run the interface interface-type interface-number command to enter the interface view.

(Optional) Run the ipv6 nd security key-length { minimum keylen-value | maximum keylen-value } * command to configure the key length that is supported by the interface.

By default, the key length that is supported by an interface ranges from 512 to 2048, in bits.

(Optional) Run the ipv6 nd security timestamp { fuzz-factor fuzz-value | delta delta-value | drift drift-value } * command to configure the timestamp of ND packets.

By default, the maximum time difference between an ND packet is sent and received is 300s; the maximum time difference between the sender and receiver is 1% in percentage; the maximum TTL of ND packets is 1s.

Run the ipv6 nd security strict command to enable the strict security mode.

Run the commit command to commit the preceding configurations.

Verify the configuration.

Run the display ipv6 security interface interface-type interface-number command to check the ND security configurations on the interface."
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "ipv6 nd security strict"
</custom_item>


<custom_item>
  description : "Configure an IPv6 CGA address."
  info        : "Before implementing the IPv6 SEND function on an interface, configure an IPv6 CGA address for the interface so that ND packets sent from this interface carry CGA and RSA options and the peer interface checks the options to determine the authenticity of the sender and integrity of the packets."
  solution    : "Run the system-view command to enter the system view.

Run the rsa key-pair label label-name modulus modulus-bits command to create an RSA key pair.

Run the interface interface-type interface-number command to enter the view of the interface for which an IPv6 CGA address is to be configured.

Run the ipv6 security rsakey-pair key-label command to bind an RSA key pair to the interface.

Run the ipv6 security modifier sec-level sec-value [ modifier-value ] command to configure the modifier value and security level.

The modifier value can be set only when the security level is set to 0.

Run the ipv6 address { ipv6-address prefix-length | ipv6-address/prefix-length } cga or ipv6 address ipv6-address link-local cga command to configure an IPv6 CGA address.

Run the commit command to commit the preceding configurations."
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "ipv6 address.*(cga|ipv6 address.*link-local cga)"
</custom_item>


<custom_item>
  description : "BFD"
  info        : "BFD provides configurable negotiation packet authentication to improve system security. The system supports the authentication of static multicast BFD negotiation packets.
  The same authentication mode, key-id field, authentication password, and authentication timeout interval must be configured on a sender and receiver.

key-id is an integer ranging from 1 to 255.
The authentication password is a string of 1 to 20 characters in plaintext or a string of 20 to 148 characters in ciphertext.
The authentication timeout interval ranges from 1 to 10000, in seconds.
After negotiation packet authentication is configured, the A flag in the BFD packet header is set to 1, and the 28-byte authentication field is added to the payload.

A receiver decapsulates a packet. If the A flag in the packet header is different from the local one, the receiver discards the packet. If they are the same, the receiver checks whether the authentication field is the same as the local configuration. If they are different, the authentication field is incorrect.

The authentication password can be configured in two modes. The authentication password is displayed in ciphertext in the configuration file.

Attack Method
An attacker forges BFD packets and sends them to a target."
  solution    : "Configuration Method
Configure authentication in the BFD session view. Only static BFD sessions are supported.

Run the authentication-mode met-sha1 key-id key-id cipher cipher-text nego-packet [ timeout-interval interval-value ] command to configure authentication.

In a specific access scenario, for example, when a multicast BFD session is associated with the protocol status of an interface, configure authentication for the BFD session on the interface. BFD negotiation can succeed, the BFD-associated protocol status of the interface can be activated, and users can access the device through this interface only when the BFD authentication information on both ends is consistent.

Configuration Suggestion
To enhance security, enable BFD negotiation packet authentication on a network requiring high security."
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "authentication-mode met-sha1 key-id.*cipher.*nego-packet"
</custom_item>


<custom_item>
  description : "GRE"
  info        : "Security Policy Introduction
Generic Routing Encapsulation (GRE) provides a configurable Key to enhance system security. A sender configures a key, which is an integer ranging from 0 to 4294967295, and records the 32-bit key in the GRE header before sending the GRE packet out. After receiving the GRE packet, the receiver decapsulates the packet and matches the key against the locally configured key. If they do not match, the receiver considers the GRE packet invalid. The key can be configured in ciphertext or simple text. If the key in ciphertext is configured, the buildrun is displayed in ciphertext.

Attack Method Introduction
An attacker forges GRE packets and sends them to a target."
  solution    : "Configuration Guide
Run the following command in the tunnel interface view of both GRE tunnel ends to configure the key function: gre key { plain key-number | [ cipher ] plain-cipher-text }

Configuration Suggestion
Configure the key function to enhance system security. When the key function is configured, the key works in ciphertext mode by default."
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "gre key (plain|cipher)"
</custom_item>


<custom_item>
  description : "MSTP"
  info        : "Security Policy Introduction
Root protection

To address this issue, the root protection function can be configured to protect the root bridge by preserving the role of the designated port. With this function, when the designated port receives RST BPDUs with a higher priority, the port enters the Discarding state and does not forward the BPDUs. If the port does not receive any RST BPDUs with a higher priority for a certain period (double the Forward Delay), the port transitions to the Forwarding state.

BPDU protection

After BPDU protection is enabled on the device, the device shuts down the edge port if the edge port receives an RST BPDU, and notifies the NMS of the shutdown event. The attributes of the edge port are not changed.

TC protection

TC protection is used to suppress TC-BPDUs. The number of times that TC-BPDUs are processed by a device within a given time period is configurable. If the number of TC-BPDUs that the device receives within the given time exceeds the specified threshold, the device handles TC-BPDUs only for the specified number of times. Excessive TC-BPDUs are processed by the device as a whole for once after the timeout period expires. This protects the device from frequently deleting MAC entries and ARP entries, thus avoiding over-burden.

Loop protection

The loop protection function can be used to prevent such network loops. If the root port or alternate port cannot receive RST BPDUs from the upstream device, the root port is blocked and the device notifies the NMS that the port enters the Discarding state. The blocked port remains in the Blocked state and no longer forwards packets. This prevents loops on the network. The root port restores the Forwarding state after new RST BPDUs are received.

Attack Method Introduction
Root bridge change attack

Due to incorrect configurations or malicious attacks on the network, a root bridge may receive BPDUs with a higher priority. Consequently, the legitimate root bridge is no longer able to serve as the root bridge, and the network topology is illegitimately changed, triggering spanning tree recalculation. This may transfer traffic from high-speed links to low-speed links, causing traffic congestion.

BPDU attack

An edge port changes to be a non-edge port after receiving a BPDU, which triggers spanning tree recalculation. If an attacker keeps sending bogus BPDUs to a device, network flapping occurs.

TC protection

Generally, after receiving TC BPDUs (packets for advertising network topology changes), a device needs to delete MAC entries and ARP entries. Frequent deletion operations will exhaust CPU resources.

Loop protection

A root port or an alternate port will age if link congestion or a one-way link failure occurs. After the root port ages, a device may re-select a root port incorrectly and after the alternate port ages, the port enters the Forwarding state. Loops may occur in such a situation."
  solution    : "Configuration Suggestion
Root protection

Enable root protection on designated interfaces.

BPDU protection

Configure BPDU protection on devices.

TC protection

Configure TC protection on devices.

Loop protection

Enable loop protection on a root port or an alternate port."
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "(Root protection|BPDU protection)"
</custom_item>


<custom_item>
  description : "E-Trunk"
  info        : "This section describes security policies, network attack modes, and configuration and maintenance methods and suggestions applied to Eth-Trunk.

Security Policy Introduction
To improve system security, Eth-Trunk supports the authentication function. Eth-Trunk calculates the packet digest for heartbeat packets at the transmit end based on the preset password. Eth-Trunk calculates the packet digest again after the receive end receives the heartbeat packets. If the two digests are the same, the packets are accepted; otherwise, the packets are discarded.

When error packets are received, Eth-Trunk checks the length, digest, and key parameters of the packets. Invalid packets are discarded.

By default, E-Trunk uses UDP port 1025 to transmit and receive protocol packets. To improve security, E-Trunk allows users to configure the E-Trunk port number.
Attack Method Introduction
Protocol authentication can be configured to defend against attacks. The authentication algorithm can be HMAC-SHA1-96, HMAC-SHA2-256 or ENHANCED-HMAC-SHA256."
  solution    : "Configuration Guide
In the E-Trunk view, run the authentication-mode command to configure the E-Trunk authentication and encryption mode.
Run the following command to authentication command in the Eth-Trunk view: security-key { simple simple-key | cipher { cipher-key1 | cipher-key2 | cipher-key3 } }.

You can store the password in plain text or cipher text mode.
When the password is stored in plain text mode, the password is displayed in plain text in the configuration file.

When the password is encrypted in cipher text mode, the password is displayed as garbled characters in the configuration file but not the real password.

cipher-key1: If the password is entered in ciphertext, the value is a string of 32 to 432 characters.
cipher-key2: A 24-character ciphertext password configured in an earlier version is also supported in this version.
cipher-key3: If the password is entered in simple text, the value is a string of 1 to 255 case-sensitive characters, spaces not supported.

If the simple parameter is configured, the password is saved in the configuration file as plain text. Users at a lower level can easily obtain the password by viewing the configuration file. This threatens network security. Therefore, using the cipher parameter to save the password is recommended.

Run the e-trunk port port-number command in the system view to configure the E-Trunk port number. The value is in the range of 1025 to 65535. The default value is 1025.
Configuration Suggestion
To enhance security, you are recommended to configure the encryption password to be delivered in cipher text.

The E-Trunk authentication and encryption mode of enhanced-hmac-sha256 is recommended."
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "security-key (simple|cipher)"
</custom_item>


<custom_item>
  description : "Configure IPsec authentication for MLD Query messages."
  info        : "Configure IPsec authentication for MLD Query messages."
  solution    : "Configure IPsec authentication for MLD Query messages.
Run system-view
The system view is displayed.

Run mld
The MLD view is displayed.

Run query ipsec sa sa-name
MLD IPsec is configured globally, enabling the device to authenticate the sent and received MLD Query messages based on the specified SA policy.

Run commit
The configuration is committed.


If the ipsec sa and query ipsec sa commands are both configured, the command configured later overrides the command configured earlier."
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "mld query ipsec sa"
</custom_item>


<custom_item>
  description : "Configure IPsec authentication for MLD messages."
  info        : "Configure IPsec authentication for MLD messages."
  solution    : "Configure MLD IPsec in the MLD view.
Configure IPsec authentication for MLD messages.
Run system-view
The system view is displayed.

Run mld
The MLD view is displayed.

Run ipsec sa sa-name
MLD IPsec is configured globally, enabling the device to authenticate the sent and received MLD messages based on the specified SA policy.

Run commit
The configuration is committed."
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "mld ipsec sa"
</custom_item>


<custom_item>
  description : "Configure IPsec authentication for IGMP Query messages."
  info        : "Configure IPsec authentication for IGMP Query messages."
  solution    : "Configure IPsec authentication for IGMP Query messages.
Run system-view
The system view is displayed.

Run igmp [ vpn-instance vpn-instance-name ]
The IGMP view is displayed.

Run query ipsec sa sa-name
IGMP IPsec is configured globally, enabling the device to authenticate the sent and received IGMP Query messages based on the specified SA.
Run commit
The configuration is committed.
If the ipsec sa and query ipsec sa commands are both configured, the command configured later overrides the command configured earlier."
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "igmp query ipsec sa"
</custom_item>


<custom_item>
  description : "Configure IPsec authentication for IGMP messages."
  info        : "Configure IPsec authentication for IGMP messages."
  solution    : "Configure IPsec authentication for IGMP Query messages.
Run system-view
The system view is displayed.

Run interface interface-type interface-number
The interface view is displayed.

Run igmp query ipsec sa sa-name
IGMP IPsec is configured on an interface, enabling the interface to authenticate the sent and received IGMP Query messages based on the specified SA.

Run commit
The configuration is committed.


If the igmp ipsec sa and igmp query ipsec sa commands are both configured, the command configured later overrides the command configured earlier."
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "igmp ipsec sa"
</custom_item>


<custom_item>
  description : "Configure source address-based MLD Query message filtering."
  info        : "If an MLD Query message matches an ACL rule and the action is permit, the interface permits this message.
If an MLD Query message matches an ACL rule and the action is deny, the interface denies this message.
If an MLD Query message does not match any ACL rule, the interface denies this message.
If a specified ACL does not exist or does not contain rules, the interface denies all MLD Query messages."
  solution    : "Configure source address-based MLD Query message filtering.
Run system-view
The system view is displayed.

Configure a basic numbered ACL6 or a naming ACL6 as needed.
Configure a basic numbered ACL6.

Run acl ipv6 [ number ] basic-acl6-number [ match-order { auto | config } ]
A basic numbered ACL6 is created, and the basic numbered ACL6 view is displayed.

Run rule [ rule-id ] [ name rule-name ] { deny | permit } [ fragment | source { source-ipv6-address prefix-length | source-ipv6-address/prefix-length | any } ] *
Rules are configured for the basic numbered ACL6.

Configure a naming ACL6.

Run acl ipv6 name acl6-name basic [ match-order { auto | config } ]
A naming ACL6 is created, and the naming ACL6 view is displayed.

Run rule [ rule-id ] [ name rule-name ] { deny | permit } [ fragment | source { source-ipv6-address prefix-length | source-ipv6-address/prefix-length | any } ] *
Rules are configured for the naming ACL6.

Run quit
Return to the system view.

Run interface interface-type interface-number
The interface view is displayed.

Run mld query ip-source-policy { basic-acl6-number | acl6-name acl6-name }
Source address-based MLD Query message filtering is configured to control querier election.


If an MLD Query message matches an ACL rule and the action is permit, the interface permits this message.
If an MLD Query message matches an ACL rule and the action is deny, the interface denies this message.
If an MLD Query message does not match any ACL rule, the interface denies this message.
If a specified ACL does not exist or does not contain rules, the interface denies all MLD Query messages.
Run commit
The configuration is committed."
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "mld query ip-source-policy"
</custom_item>


<custom_item>
  description : "Configure source address-based MLD Report or Done message filtering."
  info        : "If an MLD Report or Leave message matches an ACL rule and the action is permit, the interface permits this message.
If an MLD Report or Leave message matches an ACL rule and the action is deny, the interface denies this message.
If an MLD Report or Leave message does not match any ACL rule, the interface denies this message.
If a specified ACL does not exist or does not contain rules, the interface denies all MLD Report and Leave messages."
  solution    : "Configure source address-based MLD Report or Done message filtering.
Run system-view
The system view is displayed.

Configure a basic numbered ACL6 or a naming ACL6 as needed.
Configure a basic numbered ACL6.

Run acl ipv6 [ number ] basic-acl6-number [ match-order { auto | config } ]
A basic numbered ACL6 is created, and the basic numbered ACL6 view is displayed.

Run rule [ rule-id ] [ name rule-name ] { deny | permit } [ fragment | source { source-ipv6-address prefix-length | source-ipv6-address/prefix-length | any } ] *
Rules are configured for the basic numbered ACL6.

Configure a naming ACL6.

Run acl ipv6 name acl6-name basic [ match-order { auto | config } ]
A naming ACL6 is created, and the naming ACL6 view is displayed.

Run rule [ rule-id ] [ name rule-name ] { deny | permit } [ fragment | source { source-ipv6-address prefix-length | source-ipv6-address/prefix-length | any } ] *
Rules are configured for the naming ACL6.

Run quit
Return to the system view.

Run interface interface-type interface-number
The interface view is displayed.

Run mld ip-source-policy { basic-acl6-number | acl6-name acl6-name }
Source address-based MLD Report or Done message filtering is configured.


If an MLD Report or Leave message matches an ACL rule and the action is permit, the interface permits this message.
If an MLD Report or Leave message matches an ACL rule and the action is deny, the interface denies this message.
If an MLD Report or Leave message does not match any ACL rule, the interface denies this message.
If a specified ACL does not exist or does not contain rules, the interface denies all MLD Report and Leave messages.
Run commit
The configuration is committed."
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "mld ip-source-policy"
</custom_item>


<custom_item>
  description : "Configure source address-based IGMP Query message filtering"
  info        : "If an IGMP Query message matches an ACL rule and the action is permit, the interface permits this message.
If an IGMP Query message matches an ACL rule and the action is deny, the interface denies this message.
If an IGMP Query message does not match any ACL rule, the interface denies this message.
If a specified ACL does not exist or does not contain rules, the interface denies all IGMP Query messages."
  solution    : "Configure source address-based IGMP Query message filtering
Run system-view
The system view is displayed.

Configure a basic numbered ACL or a naming ACL as needed.
Configure a basic numbered ACL.

Run acl [ number ] basic-acl-number [ match-order { auto | config } ]
A basic numbered ACL is created, and the basic numbered ACL view is displayed.

Run rule [ rule-id ] [ name rule-name ] { deny | permit } source { source-ip-address { source-wildcard | 0 } | any }
Rules are configured for the basic numbered ACL.

Configure a naming ACL.

Run acl name acl-name basic [ match-order { auto | config } ]
A naming ACL is created, and the naming ACL view is displayed.

Run rule [ rule-id ] [ name rule-name ] { deny | permit } source { source-ip-address { source-wildcard | 0 } | any }
Rules are configured for the naming ACL.

Run quit
Return to the system view.

Run interface interface-type interface-number
The interface view is displayed.

Run igmp query ip-source-policy { basic-acl-number | acl-name acl-name }
Source address-based IGMP Query message filtering is configured to control querier election.


If an IGMP Query message matches an ACL rule and the action is permit, the interface permits this message.
If an IGMP Query message matches an ACL rule and the action is deny, the interface denies this message.
If an IGMP Query message does not match any ACL rule, the interface denies this message.
If a specified ACL does not exist or does not contain rules, the interface denies all IGMP Query messages.
Run commit
The configuration is committed."
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "igmp query ip-source-policy"
</custom_item>


<custom_item>
  description : "Configure source address-based IGMP Report or Leave message filtering"
  info        : "If an IGMP Report or Leave message matches an ACL rule and the action is permit, the interface permits this message.
If an IGMP Report or Leave message matches an ACL rule and the action is deny, the interface denies this message.
If an IGMP Report or Leave message does not match any ACL rule, the interface denies this message.
If a specified ACL does not exist or does not contain rules, the interface denies all IGMP Report and Leave messages."
  solution    : "Configure source address-based IGMP Report or Leave message filtering
Run system-view
The system view is displayed.

Configure a basic numbered ACL or a naming ACL as needed.
Configure a basic numbered ACL.

Run acl [ number ] basic-acl-number [ match-order { auto | config } ]
A basic numbered ACL is created, and the basic numbered ACL view is displayed.

Run rule [ rule-id ] [ name rule-name ] { deny | permit } source { source-ip-address { source-wildcard | 0 } | any }
Rules are configured for the basic numbered ACL.

Configure a naming ACL.

Run acl name acl-name basic [ match-order { auto | config } ]
A naming ACL is created, and the naming ACL view is displayed.

Run rule [ rule-id ] [ name rule-name ] { deny | permit } source { source-ip-address { source-wildcard | 0 } | any }
Rules are configured for the naming ACL.

Run quit
Return to the system view.

Run interface interface-type interface-number
The interface view is displayed.

Run igmp ip-source-policy [ basic-acl-number | acl-name acl-name ]
Source address-based IGMP Report or Leave message filtering is configured.


If an ACL is not configured in this command, the device permits an IGMP Report or Leave message if the message's source address is 0.0.0.0 or if the message's source address is on the same network segment as the address of the interface that receives the message, but discards the message if the message's source address is on a different network segment from the address of the interface that receives the message.
If an ACL is configured on an interface, the interface uses configured ACL rules to filter source addresses in IGMP Report or Leave messages.
If an IGMP Report or Leave message matches an ACL rule and the action is permit, the interface permits this message.
If an IGMP Report or Leave message matches an ACL rule and the action is deny, the interface denies this message.
If an IGMP Report or Leave message does not match any ACL rule, the interface denies this message.
If a specified ACL does not exist or does not contain rules, the interface denies all IGMP Report and Leave messages.
Run commit
The configuration is committed."
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "igmp ip-source-policy"
</custom_item>


<custom_item>
  description : "Configure IPsec authentication for IPv6 PIM Hello messages."
  info        : "Configure IPsec authentication for IPv6 PIM Hello messages."
  solution    : "Run system-view
The system view is displayed.

Run pim-ipv6
The IPv6 PIM view is displayed.

Run hello ipsec sa sa-name
IPv6 PIM IPsec is configured globally, enabling the device to authenticate the sent and received IPv6 PIM Hello messages based on the specified SA policy.

Run commit
The configuration is committed.


If the ipsec sa and hello ipsec sa commands are both configured, the command configured later overrides the command configured earlier."
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "pim ipv6 hello ipsec sa"
</custom_item>


<custom_item>
  description : "Configure IPsec authentication for IPv6 PIM messages."
  info        : "Configure IPsec authentication for IPv6 PIM messages."
  solution    : "Run system-view
The system view is displayed.

Run pim-ipv6
The IPv6 PIM view is displayed.

Run ipsec [ unicast-message ] sa sa-name
IPv6 PIM IPsec is configured globally, enabling the device to authenticate the sent and received IPv6 PIM messages based on the specified SA policy. If you specify unicast-message in the command, the device authenticates only the sent and received IPv6 PIM unicast messages based on the specified SA policy.

Run commit
The configuration is committed."
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "pim ipv6 ipsec sa"
</custom_item>


<custom_item>
  description : "Configure IPsec authentication for IPv4 PIM Hello messages."
  info        : "Configure IPsec authentication for IPv4 PIM Hello messages."
  solution    : "Run system-view
The system view is displayed.

Run pim [ vpn-instance vpn-instance-name ]
The PIM view is displayed.

Run hello ipsec sa sa-name
IPv4 PIM IPsec is configured globally, enabling the device to authenticate the sent and received IPv4 PIM Hello messages based on the specified SA.

Run commit
The configuration is committed.


If the ipsec sa and hello ipsec sa commands are both configured, the command configured later overrides the command configured earlier."
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "pim hello ipsec sa"
</custom_item>


<custom_item>
  description : "Configure IPsec authentication for IPv4 PIM messages."
  info        : "Configure IPv4 PIM IPsec in the PIM view."
  solution    : "Configure IPsec authentication for IPv4 PIM messages.

Run system-view
The system view is displayed.

Run pim [ vpn-instance vpn-instance-name ]
The PIM view is displayed.

Run ipsec [ unicast-message ] sa sa-name
IPv4 PIM IPsec is configured globally, enabling the device to authenticate the sent and received IPv4 PIM messages based on the specified SA.

If you specify unicast-message in the command, the device authenticates only the sent and received IPv4 PIM unicast messages based on the specified SA.

Run commit
The configuration is committed."
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "pim ipsec sa"
</custom_item>


<custom_item>
  description : "Configure IPv4 PIM IPsec in the PIM view."
  info        : "Configure IPv4 PIM IPsec in the PIM view"
  solution    : "Configure IPsec authentication for IPv4 PIM messages.

Run system-view
The system view is displayed.

Run pim [ vpn-instance vpn-instance-name ]
The PIM view is displayed.

Run ipsec [ unicast-message ] sa sa-name
IPv4 PIM IPsec is configured globally, enabling the device to authenticate the sent and received IPv4 PIM messages based on the specified SA.

If you specify unicast-message in the command, the device authenticates only the sent and received IPv4 PIM unicast messages based on the specified SA.

Run commit
The configuration is committed."
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "ipsec unicast-message sa"
</custom_item>


<custom_item>
  description : "Configure PIM Join packet filtering."
  info        : "If a Join message's join information matches an ACL rule and the action is permit, the device permits this message.
If a Join message's join information matches an ACL rule and the action is deny, the device denies this message.
If a Join message's join information does not match any ACL rule, the device denies this message.
If a specified ACL does not exist or does not contain rules, the device denies all Join messages that contain join information."
  solution    : "Configure PIM Join packet filtering.
Run system-view
The system view is displayed.

Configure a basic or an advanced ACL as needed.
Configure a basic ACL.

Run acl [ number ] basic-acl-number [ match-order { auto | config } ]
A basic ACL is created, and the basic ACL view is displayed.

Run rule [ rule-id ] [ name rule-name ] { deny | permit } source { source-ip-address { source-wildcard | 0 } | any }
Rules are configured for the basic ACL.

Configure an advanced ACL.

Run acl { name advance-acl-name [ advance | [ advance ] number advance-acl-number ] | [ number ] advance-acl-number } [ match-order { config | auto } ]

An advanced ACL is created, and the advanced ACL view is displayed.

Run rule [ rule-id ] [ name rule-name ] { deny | permit } ip [ destination { destination-ip-address { destination-wildcard | 0 } | any } | source { source-ip-address { source-wildcard | 0 } | any } ] *

Rules are configured for the advanced ACL.

Run quit
Return to the system view.

Run interface interface-type interface-number
The PIM interface view is displayed.

Run pim join-policy { { advanced-acl-number | acl-name acl-name } | asm { basic-acl-number | acl-name acl-name } | ssm { advanced-acl-number | acl-name acl-name } }
A policy is created for filtering join information in Join/Prune messages.

The router filters join information in Join/Prune messages based on source addresses or both source and group addresses.

If asm is specified, run the rule command in the basic ACL view and set the source parameter to the multicast group address range of join information.

If ssm is specified, run the rule command in the advanced ACL view, set the source parameter to the multicast source address range of join information, and set the destination parameter to the multicast group address range of join information.

Run commit
The configuration is committed."
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "pim join-policy"
</custom_item>


<custom_item>
  description : "Configure PCEP TLS authentication."
  info        : "Configure PCEP TLS authentication."
  solution    : "Run system-view
The system view is displayed.

Run ssl policy policy-name
An SSL policy is created and the SSL policy view is displayed.

Run ssl minimum version { tls1.1 | tls1.2 | tls1.3 }
The minimum SSL version is set for the current SSL policy.

For details about other configurations in the SSL policy view, see section \"Configuring and Binding an SSL Policy\" of chapter \"User Login Configuration\" in NE40E Configuration Guide - Basic Configuration.

Run quit
Return to the system view.

Run pce-client
The PCE client view.

Run connect-server ip-address
A candidate server is specified.

Run bind ssl-policy policy-name
An SSL policy is specified for the PCE client.

Run commit
The configuration is committed."
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "ssl minimum version (tls1.1|tls1.2|tls1.3)"
</custom_item>


<custom_item>
  description : "(Optional) Configuring the message window function - MPLS RSVP"
  info        : "(Optional) Configuring the message window function in the interface view
The message window function prevents RSVP message mis-sequence.

The default window size is 1. This allows a local device to store only the largest sequence number of the latest RSVP message sent by a neighbor node.

If the window size is greater than 1, the local device stores several latest valid sequence numbers."
  solution    : "Run system-view
The system view is displayed.

Run interface interface-type interface-number
The view of the interface on which the MPLS TE tunnel is established is displayed.

Run mpls rsvp-te authentication handshake
The handshake function is enabled.


The task of \"Configuring an RSVP Authentication Mode\" must be complete before the RSVP handshake function is configured. The handshake can only take effect after it is configured on both ends of an RSVP authentication relationship.

Run mpls rsvp-te authentication window-size window-size
The message window function is configured. The value is the number of valid sequence numbers of received RSVP messages that can be stored.

If RSVP is enabled on an Eth-Trunk or IP-Trunk interface, only one neighbor relationship is established on the trunk interface between RSVP neighbors. This means any trunk member interface receives RSVP messages in a random order, which results in message mis-sequence. An RSVP message window size is configured to address this problem. If the sliding window is too small, received RSVP messages with sequence numbers outside the window size are discarded, which terminates an RSVP neighbor relationship.

Run commit
The configuration is committed."
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "(mpls rsvp-te authentication window-size|pce-client)"
</custom_item>


<custom_item>
  description : "(Optional) Configuring the message window function in the MPLS RSVP-TE peer view"
  info        : "(Optional) Configuring the message window function in the interface view
The message window function prevents RSVP message mis-sequence.

The default window size is 1. This allows a local device to store only the largest sequence number of the latest RSVP message sent by a neighbor node.

If the window size is greater than 1, the local device stores several latest valid sequence numbers."
  solution    : "a.
Run system-view
The system view is displayed.
b.
Run mpls
The MPLS view is displayed.
c.
Run mpls rsvp-te peer ip-address
The MPLS RSVP-TE peer view is displayed.
▪ If ip-address is set to an interface IP address of a neighbor, not the
neighbor LSR ID, the message window size will only take effect on
that interface of the neighbor.
▪ If ip-address is set to a neighbor LSR ID, the message window size
will take effect on all interfaces of the neighbor.
Run mpls rsvp-te authentication handshake
The handshake function is enabled.
The task of \"Configuring an RSVP Authentication Mode\" must be complete
before the RSVP handshake function is configured. The handshake can only take
effect after it is configured on both ends of an RSVP authentication relationship.
e.
Run mpls rsvp-te authentication window-size window-size
The message window function is configured. The value is the number of
valid sequence numbers of received RSVP messages that can be stored.
If RSVP is enabled on an Eth-Trunk interface, only one neighbor
relationship is established on the trunk interface between RSVP
neighbors. This means any trunk member interface receives RSVP
messages in a random order, which results in message mis-sequence. An
RSVP message window size is configured to address this problem. If the
sliding window is too small, received RSVP messages with sequence
numbers outside the window size are discarded, which terminates an
RSVP neighbor relationship.
f.
Run commit
The configuration is committed."
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "mpls rsvp-te authentication window-size"
</custom_item>


<custom_item>
  description : "(Optional) Configuring the handshake function - MPLS RSVP"
  info        : "(Optional) Configuring the handshake function in the interface view
The handshake function helps RSVP key authentication prevent replay attacks."
  solution    : "Run system-view
The system view is displayed.

Run interface interface-type interface-number
The view of the interface on which the MPLS TE tunnel is established is displayed.

Run mpls rsvp-te authentication handshake
The handshake function is enabled.


The task of \"Configuring an RSVP Authentication Mode\" must be complete before the RSVP handshake function is configured.

The handshake function helps a device to establish an RSVP neighbor relationship with its neighbor. If a device receives RSVP messages from a neighbor, with which the device has not established an RSVP authentication relationship, the device will send Challenge messages carrying local identifier to this neighbor. After receiving the Challenge messages, the neighbor returns Response messages carrying the identifier the same as that in the Challenge messages. After receiving the Response messages, the local end checks identifier carried in the Response messages. If identifier in the Response messages is the same as the local one, the device determines to establish an RSVP authentication relationship with its neighbor.

Run commit
The configuration is committed."
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "mpls rsvp-te authentication handshake"
</custom_item>


<custom_item>
  description : "(Optional) Configuring RSVP authentication lifetime"
  info        : "(Optional) Configuring RSVP authentication lifetime in the interface view
When no CR-LSP is reachable between RSVP neighbors, they can keep the neighbor relationship until the configured TTL of RSVP authentication elapses. The configured TTL of RSVP authentication does not affect existing CR-LSPs."
  solution    : "Run system-view
The system view is displayed.

Run interface interface-type interface-number
The view of an RSVP-enabled interface is displayed.

Run mpls rsvp-te authentication lifetime lifetime
The RSVP authentication lifetime is set.

Run commit
The configuration is committed."
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "mpls rsvp-te authentication lifetime"
</custom_item>


<custom_item>
  description : "Configure RSVP key authentication in neighbor address-based mode."
  info        : "RSVP authentication modes

RSVP supports two authentication modes:

Neighbor-oriented authentication

In this mode, you can configure authentication information, such as authentication keys based on different neighbor addresses. RSVP then authenticates each neighbor.

Neighbor-oriented authentication can be configured in either of the following ways:

1. Configured based on an interface IP address of a neighbor.

2. Configured based on the LSR ID of a neighbor.

Interface-oriented authentication

If interface-oriented authentication is configured, RSVP authenticates packets based on their inbound interfaces.
Neighbor-oriented authentication takes precedence over interface-oriented authentication. Packets that fail authentication are discarded. If neighbor-oriented authentication is not enabled, interface-oriented authentication takes effect.
Attack Methods
The most common attacks and prevention methods are as follows:

Replay attacks

When processing packets, RSVP checks various information, including parameters, formats, and types. The information can be easily obtained by attackers. Therefore, attackers can intercept RSVP packets and repeatedly send packets to the device to increase the load of the device. Object verification is added to RSVP messages to protect the messages from being tampered with and forgery attacks, enhancing network reliability and security.

Error packet attacks

Attackers construct various types of error packets, such as super long packets, packets with incorrect headers, packets of incorrect lengths, and packets with invalid next hops, to initiate attacks. RSVP uses strict rules for outgoing packets. It discards error packets without ending neighbor relationships, ensuring service continuity. It does not accept or advertise packets with serious errors, such as extremely long packets or invalid packet types."
  solution    : "Procedure
Configure RSVP key authentication in neighbor address-based mode.
Run system-view
The system view is displayed.

Run interface interface-type interface-number
The view of the interface on which the MPLS TE tunnel is established is displayed.

Run mpls rsvp-te authentication { { cipher | plain } auth-key | keychain keychain-name }
The key for RSVP authentication is configured.

HMAC-MD5 or keychain authentication can be configured based on the selected parameter:

cipher: HMAC-MD5 authentication is used, and a key is displayed in ciphertext.

plain: HMAC-MD5 authentication is used, and a key is displayed in simple text.

keychain: Keychain authentication is used, and a globally configured keychain is referenced.


If you configure a simple password, it will be saved in the configuration file in plaintext that has a high security risk. Therefore, configuring a ciphertext password is recommended. To improve the device security, periodically change the password.

Configuration must be complete on the two directly connected interfaces within three update periods. If configuration is not complete after three update periods elapse, the session goes Down.

Run commit
The configuration is committed.

Configure RSVP key authentication in neighbor-based mode.
Run system-view
The system view is displayed.

Run mpls
The MPLS view is displayed.

Run mpls rsvp-te peer peer-address
The RSVP neighbor view is displayed.

Run mpls rsvp-te authentication { { cipher | plain } auth-key | keychain keychain-name }
The key for RSVP authentication is configured.

HMAC-MD5 or keychain authentication can be configured based on the selected parameter:

cipher: HMAC-MD5 authentication is used, and a key is displayed in ciphertext.

plain: HMAC-MD5 authentication is used, and a key is displayed in simple text.

keychain: Keychain authentication is used, and a globally configured keychain is referenced.


If you configure a simple password, it will be saved in the configuration file in plaintext that has a high security risk. Therefore, configuring a ciphertext password is recommended. To improve the device security, periodically change the password.

Configuration must be complete on the two neighboring nodes within three update periods. If configuration is not complete after three update periods elapse, the session goes Down.

(Optional) Run mpls rsvp-te challenge-lost peer-address
The maximum number of allowable discarded challenge messages that are sent by the supplicant to the authenticator during RSVP authentication is set.

(Optional) Run mpls rsvp-te retrans-timer challenge retransmission-interval
The interval at which challenge messages are retransmitted is set.

Run commit
The configuration is committed."
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "mpls rsvp-te authentication"
</custom_item>


<custom_item>
  description : "Configure IS-IS interface authentication."
  info        : "Configure IS-IS interface authentication."
  solution    : "Run system-view
The system view is displayed.

Run interface interface-type interface-number
The interface view is displayed.

Run isis authentication-mode { simple { plain plain-text | cipher plain-cipher-text } | md5 { [ cipher ] plain-cipher-text | plain plain-text } } [ level-1 | level-2 ] [ ip | osi ] [ send-only ]
Or isis authentication-mode keychain keychain-name [ Level-1 areas | level-2 ] [ send-only ]

Or isis authentication-mode hmac-sha256 key-id key-id { plain plain-text | [ cipher ] plain-cipher-text } [ level-1 | level-2 ] [ send-only ]

The IS-IS authentication mode and password are configured on the interface.


To ensure high security, do not use the MD5 algorithm. It is recommended that you enable authentication and use the HMAC-SHA256 algorithm to improve security, preventing route information from being modified by unauthorized users.

When you select parameters, note the following rules:
If send-only is specified, the router encapsulates authentication information to Hello packets to be sent but does not authenticate received Hello packets. The neighbor relationships can be set up when the authentication is not required or packets are authenticated.

If send-only is not configured, ensure that passwords of all interfaces with the same level in the same network are consistent.

Level-1 areas and level-2 can be set only on Ethernet interfaces.

When IS-IS interfaces are Level-1-2 interfaces and Level-1 areas or level-2 is not specified in the command, authentication modes and passwords are configured for both Level-1 areas and Level-2 Hello packets.

Run commit
The configuration is committed."
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "isis authentication-mode"
</custom_item>


<custom_item>
  description : "Configure IS-IS routing domain authentication."
  info        : "After the area-authentication-mode command is run, IS-IS does not process received unauthenticated Level-2 LSPs that have been stored in the local LSDB and newly received unauthenticated Level-2 LSPs and SNPs that have not been stored in the local LSDB. Those packets are discarded automatically after being aged out. To prevent those packets from being discarded due to this command configuration, specify the send-only parameter in the command.

To ensure high security, do not use the MD5 algorithm. It is recommended that you enable authentication and use the HMAC-SHA256 algorithm to improve security, preventing route information from being modified by unauthorized users"
  solution    : "Run system-view
The system view is displayed.

Run isis [ process-id ]
The IS-IS view is displayed.

Run domain-authentication-mode { simple { plain plain-text | cipher plain-cipher-text } | md5 { [ cipher ] plain-cipher-text | plain plain-text } } [ ip | osi ] [ snp-packet { authentication-avoid | send-only } | all-send-only ]
Or domain-authentication-mode keychain keychain-name [ snp-packet { authentication-avoid | send-only } | all-send-only ]

Or domain-authentication-mode hmac-sha256 key-id key-id { plain plain-text | [ cipher ] plain-cipher-text } [ snp-packet { authentication-avoid | send-only } | all-send-only ]

The routing domain authentication mode is configured.
IS-IS authentication involves the following situations:
The device encapsulates the authentication mode into LSPs and SNPs to be sent and authenticate received LSPs and SNPs. The LSPs and SNPs that cannot be authenticated are discarded. In this case, the parameter snp-packet or all-send-only is not specified.

The device encapsulates authentication information into LSPs to be sent and authenticate received LSPs but neither encapsulates the SNPs to be sent with authentication information nor authenticate received SNPs. In this case, the parameter snp-packet authentication-avoid needs to be specified.

The device encapsulates the LSPs and SNPs to be sent with authentication information but authenticate only the received LSPs. In this case, the parameter snp-packet send-only needs to be specified.

The device encapsulates the LSPs and SNPs to be sent with authentication information but does not authenticate received LSPs or SNPs. In this case, the parameter all-send-only needs to be specified.

Run commit
The configuration is committed.

Configure IS-IS interface authentication.
Run system-view
The system view is displayed.

Run interface interface-type interface-number
The interface view is displayed.

Run isis authentication-mode { simple { plain plain-text | cipher plain-cipher-text } | md5 { [ cipher ] plain-cipher-text | plain plain-text } } [ level-1 | level-2 ] [ ip | osi ] [ send-only ]
Or isis authentication-mode keychain keychain-name [ Level-1 areas | level-2 ] [ send-only ]

Or isis authentication-mode hmac-sha256 key-id key-id { plain plain-text | [ cipher ] plain-cipher-text } [ level-1 | level-2 ] [ send-only ]

The IS-IS authentication mode and password are configured on the interface.


To ensure high security, do not use the MD5 algorithm. It is recommended that you enable authentication and use the HMAC-SHA256 algorithm to improve security, preventing route information from being modified by unauthorized users.

When you select parameters, note the following rules:
If send-only is specified, the router encapsulates authentication information to Hello packets to be sent but does not authenticate received Hello packets. The neighbor relationships can be set up when the authentication is not required or packets are authenticated.

If send-only is not configured, ensure that passwords of all interfaces with the same level in the same network are consistent.

Level-1 areas and level-2 can be set only on Ethernet interfaces.

When IS-IS interfaces are Level-1-2 interfaces and Level-1 areas or level-2 is not specified in the command, authentication modes and passwords are configured for both Level-1 areas and Level-2 Hello packets.

Run commit
The configuration is committed."
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "add domain-authentication-mode"
</custom_item>


<custom_item>
  description : "Configuring IPsec Authentication on a RIPng Interface"
  info        : "Configuring IPsec Authentication on a RIPng Interface"
  solution    : "Run system-view
The system view is displayed.

Run interface interface-type interface-number
The interface view is displayed.

Run ripng ipsec sa sa-name
IPsec authentication is enabled on the interface, and the name of an SA is specified.


The ripng ipsec sa command takes precedence over the ipsec sa command. If both commands are run in respective views and different SA names are specified, only the configuration of the ripng ipsec sa command takes effect.

Run commit
The configuration is committed.

Configure RIP/RIPng whitelist security.
No specific configuration is provided for RIP/RIPng."
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "ripng ipsec sa"
</custom_item>


<custom_item>
  description : "RIP/RIPng authentication"
  info        : "Security Policy
Rapid development of networks poses higher network security requirements. Routing protocol packets transmitted over networks may be intercepted, changed, or forged, and packet attacks may cause network interruptions. Therefore, packets need to be protected.

Protocol-specific security mechanism

RIP/RIPng supports the following security policies:

TTL/hop limit:

A source device can transmit RIP/RIPng packets to a device that is only a hop far from the source. When RIP/RIPng packets are sent on broadcast or multicast networks (except for unicast peers), RIP/RIPng sets the TTL/hop limit value to 1.

Whitelist

RIP/RIPng supports a whitelist in a CP-CAR policy. Packets sent by a neighbor listed in a whitelist are accepted, but not discarded.

GTSM

RIP uses GTSM to protect devices from potential attacks by checking whether the TTL value in each IP packet header is within a pre-defined range. TTL specifies the maximum number of devices through which a packet can pass. If the TTL value in an IP packet header is not within the pre-defined range, the forwarding plane discards the packet, protecting the control plane from being attacked.

Authentication

RIP-2 supports authentication to prevent receiving bad routing data, error packets, and replay attacks.

RIPng does not define any authentication mechanism to prevent receiving bad routing data, error packets, or replay attacks. RIPng supports IPsec authentication for RIPng packets.

Route limit

RIP/RIPng supports the limit on the number of routes that can be added to the RIP/RIPng database for each RIP/RIPng process.

Handling policies for massive packets attacks and error packet attacks

RIP uses the interface security mechanism and whitelist to handle massive attacks.

Other policies

The system supports the CP defense policy (CAR) for each interface to define the bandwidth which new sources assign RIP packets.

Attack Methods
DoS attacks

To protect from DoS attacks, RIP uses the CP defense policy.

Routers can be subjected to DoS attacks by transmitting RIP protocol packets from random sources. These packets are processed by an interface board and sent to a main control board on which they are dropped by RIP/RIPng. This results in wasted bandwidth and CPU resources, and can reduce system performance.

To prevent this type of unnecessary packet processing from unknown sources, a whitelist can be configured.

As a further protection mechanism, only a limited bandwidth is allocated by default to unknown sources of protocol packets. When valid associations with other routers are formed (either by dynamic discovery or configuration), the protocol has to explicitly set up a whitelist security entry for each known source so that packets can be exchanged from that source at a faster rate. This is necessary to ensure quick learning/convergence on the network. Packets which are received by sources which are not in the whitelist will only be assigned a default lower bandwidth.

Injection of massive routing information

The number of routes supported for RIP/RIPng processes will depend on available CPU and memory resources on a device. If the number of routes received is greater than the device capacity, CPU and memory usage increases, causing the device to become unstable. To prevent this device instability, RIP/RIPng supports a maximum number of routes.

Injection of bad routing information

RIP/RIPng will accept any packet from a valid packet source address that matches the configured network. RIP/RIPng carries direct route data in its RIP/RIPng packet, and therefore, it may be used to attack by inserting invalid or incorrect routing information in the RIP/RIPng packet. The incorrect information causes the generated routing database to be incorrect and leads to network failures.

If authentication is configured on the RIP interface on both sides, RIP only accepts packets if they are authenticated in order to prevent accepting routes from unauthenticated peers.

If IPsec is configured on both sides, RIP/RIPng will only accept packets that are authenticated in order to prevent accepting routes from unauthenticated peers.

Replay attacks

RIP supports sequence numbers in MD5 authenticated packets to prevent replay attacks."
  solution    : "Procedure
Configure RIP authentication.
Run system-view
The system view is displayed.

Run interface interface-type interface-number
The interface view is displayed.

Perform the following operations as required:
Run rip authentication-mode simple { plain plain-text | [ cipher ] password-key }

Simple authentication is configured for RIP-2 packets.

In simple authentication mode, the password in simple text mode is transmitted along with each authentication packet. Therefore, simple authentication is not recommended on networks requiring high security.

Run rip authentication-mode md5 { nonstandard { { plain plain-text | [ cipher ] password-key } key-id | keychain keychain-name } | usual { plain plain-text | [ cipher ] password-key } }

Message Digest 5 (MD5) authentication is configured for RIP-2 packets.

In MD5 authentication mode, the MD5 password is used for packet encapsulation and decapsulation. MD5 authentication is more secure than simple authentication.

nonstandard supports nonstandard authentication packets.

usual supports Internet Engineering Task Force (IETF) standard authentication packets.

Run rip authentication-mode hmac-sha256 { plain plain-text | [ cipher ] password-key } key-id

Hash Message Authentication Code for Secure Hash Algorithm 256 (HMAC-SHA256) authentication is configured for RIP-2 packets.


When configuring an authentication password, select the ciphertext mode because the password is saved in configuration files in simple text if you select simple text mode, which has a high risk. To ensure device security, change the password periodically.

Run commit
The configuration is committed."
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "rip authentication-mode"
</custom_item>


<custom_item>
  description : "Configure OSPFv3 interface authentication."
  info        : "Security Policy
OSPF/OSPFv3 packet authentication

OSPF/OSPFv3 supports packet authentication. Only OSPF/OSPFv3 packets that are authenticated can be received. If packets fail to be authenticated, a neighbor relationship cannot be established. When area authentication is used, all the routers in an area must have the same area authentication mode and password. Interface authentication is implemented by setting an authentication mode and password between neighboring routers. Interface authentication takes precedence over area authentication.

OSPFv3 IPsec

Relevant standards(Authentication/Confidentiality for OSPFv3) define the use of the IP Security (IPsec) mechanism to authenticate OSPFv3 packets.

Confidentiality: ESP is used to provide confidentiality. When confidentiality is enabled, a device discards the OSPFv3 packets that are not protected with ESP and the packets that fail confidentiality checks.

Data authentication: When OSPFv3 authentication is enabled, a device discards the OSPFv3 packets that are not protected with AH or ESP and the packets that fail authentication checks.

All OSPFv3 instances running over the same interface use the same SA.

OSPFv3 starts sending packets using IPsec authentication and notifies the lower layers to check received packets with IPsec authentication. The lower layers will check all the received packets, and the packets which fail the check will be discarded silently.

Attack Methods
OSPF

Packets are often forged to attack OSPF on the network. Measures, such as MD5 authentication, can be taken to identify and discard these packets.

An attacker may use the following methods to initiate attacks:

Changes the aging time of a packet to the maximum aging time so that all routers flush this packet.

Advertises the LSAs with valid Max Sequence Numbers or packets similar to valid LSAs.

Changes the sequence number when a peer router restarts and resets the state of the encryption sequence number.

Changes peer list information in a Hello packet.

OSPFv3
DoS attacks

Routers can be subjected to DoS attacks by pumping OSPFv3 protocol packets from random sources. These packets will be processed by an interface board and sent to a main control board on which they will be dropped by OSPFv3. This wastes bandwidth and CPU resources and reduces system performance.

Injection of bad routing information

OSPFv3 will accept any packet from a valid source. It may be possible to attack the device with invalid or incorrect routing information in OSPFv3 packets. With this information the calculated routing database may not be correct, which results in network failures. OSPFv3-IPsec authentication can be used to prevent this problem. When IPsec is configured for OSPFv3 on both communicating neighbors, OSPFv3 will process packets only if the packets are authenticated, which prevents OSPFv3 from accepting incorrect routing data from unauthenticated neighbors."
  solution    : "Configure OSPFv3 interface authentication.

Run system-view

The system view is displayed.

Run interface interface-type interface-number

The interface view is displayed.

Run ospfv3 authentication-mode hmac-sha256 key-id key-id { plain plain-text | [ cipher ] cipher-text }

OSPFv3 interface authentication is configured.


OSPFv3 interface authentication takes precedence over OSPFv3 area authentication. If you use HMAC-SHA256 authentication, the authentication and password configurations on all the interfaces on the same network segment must be the same.

Run commit

The configuration is committed."
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "ospfv3 authentication-mode hmac-sha256 key-id"
</custom_item>


<custom_item>
  description : "Configure OSPF interface authentication."
  info        : "Configure OSPF interface authentication."
  solution    : "Run system-view

The system view is displayed.

Run interface interface-type interface-number

The OSPF interface view is displayed.

Run any of the following commands to configure interface authentication as needed:

To configure simple authentication for the OSPF interface, run:

ospf authentication-mode simple [ [ plain ] plain-text | [ cipher ] cipher-text ]
To configure ciphertext authentication for the OSPF interface, run:

ospf authentication-mode { md5 | hmac-md5 | hmac-sha256 } [ key-id { plain plain-text | [ cipher ] cipher-text } ]
To configure keychain authentication for the OSPF interface, run:

ospf authentication-mode keychain keychain-name

Before using keychain authentication, run the keychain command to create a keychain. Then, run the key-id, key-string, and algorithm commands to configure a key ID, a password, and an authentication algorithm, respectively, for this keychain. If a keychain or its parameters are not configured, the OSPF authentication will fail.

For the sake of security, using the HMAC-SHA256 algorithm rather than the MD5 and HMAC-MD5 algorithm is recommended.

Run ospf authentication-mode null

The OSPF interface does not perform authentication.

Run commit

The configuration is committed."
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "ospf authentication-mode"
</custom_item>


<custom_item>
  description : "BGP TLS authentication"
  info        : "The Secure Sockets Layer (SSL) protocol protects data privacy on the Internet by preventing attackers from eavesdropping on data exchanged between a client and a server."
  solution    : "BGP TLS authentication
The Secure Sockets Layer (SSL) protocol protects data privacy on the Internet by preventing attackers from eavesdropping on data exchanged between a client and a server. The Transport Layer Security (TLS) protocol, as the SSL successor, also ensures data integrity and privacy. 
To enable SSL/TLS certification on an SSL server, run the \"peer ssl-server certificate\" command. BGP messages are then encrypted to ensure data transmission security on the network."
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "peer.*ssl-server certificate"
</custom_item>


<custom_item>
  description : "BMP"
  info        : "Configure BMP.
Run system-view
The system view is displayed.

Run bmp
BMP is enabled, and the BMP view is displayed.

(Optional) Run statistics-timer time
An interval at which the BMP device sends BGP/BGP4+ running statistics to a monitoring server is set.

You can set the interval based on the actual requirements on BGP/BGP4+ stability. Usually, a shorter interval is set for a network with higher stability, but this consumes more bandwidth resources because the device sends BGP/BGP4+ running statistics more frequently.

Run bmp-session [ vpn-instance vrf-name ] ip-address [ alias alias-name ]
An IPv4/IPv6 BMP session address is specified for the TCP connection to be established between the device and the monitoring server.

alias alias-name specifies an alias for a BMP session. If the BMP device needs to establish multiple TCP connections with the same monitoring server through different port numbers, specify one IPv4/IPv6 address and different session aliases (through the alias alias-name parameter) to differentiate each connection.

Configure the BMP device to send statistics about routes of specific types to the monitoring server."
  solution    : "Refer to :
  https://support.huawei.com/enterprise/en/doc/EDOC1100147903/3a1d1df9/control-plane#EN-US_TASK_0192251883"
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "bmp-session"
</custom_item>


<custom_item>
  description : "RPKI"
  info        : "BGP RPKI"
  solution    : "Configure RPKI.
Enable RPKI and configure RPKI session parameters on a client.

Run system-view
The system view is displayed.

Run rpki
RPKI is started, and the RPKI view is displayed.

Run session ipv4-address
An address of the RPKI server is specified for a TCP connection to be set up between the client and RPKI server.

Run tcp port port-number [ password md5 cipher-password | | keychain keychain-name ]
Parameters are configured for the TCP connection to be set up between the client and RPKI server.


MD5 authentication is not recommended if high security is required.


The new password is at least eight characters long and contains at least two of the following types: upper-case letters, lower-case letters, digits, and special characters, except the question mark (?) and space.

For security purposes, you are advised to configure a password in ciphertext mode. To further improve device security, periodically change the password.

(Optional) Run timer { aging aging-time | refresh refresh-time }
Timers are configured for the RPKI session between the client and the RPKI server.

(Optional) Run rpki-limit limit [ alert-only | idle-forever | idle-timeout times ]
The maximum number of Route Origination Authorization (ROA) entries that the device is allowed to receive from an RPKI session is configured.

Run commit
The configuration is committed.


After configuring RPKI session parameters, run the reset rpki session command to reset the RPKI session for the new RPKI session parameters to take effect.

Apply the BGP origin AS validation result to route selection.

Run system-view
The system view is displayed.

Run bgp as-number
The BGP view is displayed.

Run prefix origin-validation enable
BGP origin AS validation is enabled.

After BGP origin AS validation is enabled, the client periodically queries ROAs from the RPKI server and matches the origin AS of each received BGP route against the ROAs. The validation result can be Valid, Not Found, or Invalid.


Run the display rpki table command to view the ROAs.

RPKI validates origin ASs of BGP routes, and the validation takes effect only on EBGP peers.

Run bestroute origin-as-validation [ allow-invalid ]
The BGP origin AS validation result is applied to route selection.

BGP selects routes in the order of Valid, Not Found, and Invalid.

If allow-invalid is not specified in the command, BGP ignores the routes with the validation result being Invalid during route selection.

Run peer { ipv4-address | group-name } advertise origin-as-validation
The BGP device is enabled to advertise the origin AS validation result to the specified BGP peer or peer group.


The BGP origin AS validation result can be advertised only to IBGP peers.

Run commit
The configuration is committed.

"
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprise/en/doc/EDOC1100147903/3a1d1df9/control-plane#EN-US_TASK_0192251883"
  expect  : "prefix origin-validation enable"
</custom_item>


<custom_item>
  description : "Set the BGP default GTSM action."
  info        : "GTSM checks TTL values to defend against attacks. If an attacker simulates real BGP packets and sends packets continuously to a Router, an interface board of the Router receives these packets, determines that these packets are destined for the Router, and sends the packets to the BGP protocol on the control plane without verifying the packets. The Router becomes extremely busy, and CPU usage is high because the control plane of the Router needs to process these unchecked messages.

GTSM protects the Router by checking whether the TTL value within the IP packet header is in a pre-defined range to improve system security."
  solution    : "Set the default GTSM action.
Perform the following steps on a GTSM-enabled Router:

Run system-view
The system view is displayed.

Run gtsm default-action { drop | pass }
The default action to be taken for packets that do not match the GTSM policy is set.


If the default action is configured but no GTSM policy is configured, GTSM does not take effect.

This command is supported only on the Admin-VS and cannot be configured in other VSs. This command takes effect on all VSs.

Run commit
The configuration is committed."
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "gtsm default-action (drop|pass)"
</custom_item>


<custom_item>
  description : "Configure the BGP GTSM function."
  info        : "A BGP device that is enabled with GTSM checks the TTL values in all BGP packets on interface boards. As required by the actual networking, packets whose TTL values are not within the specified range are discarded. In scenarios where GTSM is not configured on a BGP device, the received BGP messages are forwarded if the BGP peer configuration exists. Otherwise, the received BGP messages are discarded. This prevents bogus BGP messages from consuming CPU resources."
  solution    : "Configure the BGP GTSM function.
GTSM protects Routers from attacks by checking whether the TTL in the header of an IP packet is in the pre-defined range. Perform the following steps on both ends of a link:

Run system-view
The system view is displayed.

Run bgp as-number
The BGP view is displayed.

Run peer { group-name | ipv4-address } valid-ttl-hops [ hops ]
The BGP GTSM is configured.

The valid TTL range of detected packets is [255 - hops + 1, 255]. For example, for an EBGP directly connected route, the value of hops is 1. That is, the valid TTL value is 255. By default, the value of hops is 255. That is, the valid TTL range is [1, 255].


After GTSM is configured in the BGP view, the configuration also takes effect in the MP-BGP VPNv4 address family view because BGP and MP-BGP VPNv4 share a TCP connection.
GTSM and EBGP-max-hop are mutually exclusive because they both affect the TTL values in sent BGP messages. Therefore, only one of them can be used for a peer or peer group.
A BGP device that is enabled with GTSM checks the TTL values in all BGP packets on interface boards. As required by the actual networking, packets whose TTL values are not within the specified range are discarded. In scenarios where GTSM is not configured on a BGP device, the received BGP messages are forwarded if the BGP peer configuration exists. Otherwise, the received BGP messages are discarded. This prevents bogus BGP messages from consuming CPU resources.

Run commit
The configuration is committed."
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "peer.*valid-ttl-hops"
</custom_item>


<custom_item>
  description : "BGP keychain authentication"
  info        : "SSL/TLS certification can be enabled only on servers. BGP MD5 authentication is mutually exclusive with BGP keychain authentication and only one of them can be configured for a BGP peer."
  solution    : "Configure TLS authentication.
The Secure Sockets Layer (SSL) protocol protects data privacy based on the Internet. It allows a client and a server to communicate in a way designed to prevent eavesdropping. Specifically, to ensure data transmission security on a network, a peer or peer group needs to be configured as an SSL client using the peer ssl-policy role client or as a server using the peer ssl-policy role server command, and the SSL data encryption, identity authentication, and message integrity verification mechanisms need to be used.

Run system-view
The system view is displayed.

Run bgp { as-number-plain | as-number-dot }
The BGP view is displayed.

Run peer { group-name | ipv4-address } ssl-server certificate
SSL/TLS certification is enabled on an SSL server.

Run peer { group-name | ipv4-address } ssl-policy name ssl-policy-name
The SSL policy is applied to the SSL client or server.

Run peer { group-name | ipv4-address } ssl-policy role { client | server }
A peer or peer group is configured as an SSL client or server.

Run commit
The configuration is committed.


The peer as-number command has been run to create a peer.

SSL/TLS certification can be enabled only on servers. BGP MD5 authentication is mutually exclusive with BGP keychain authentication and only one of them can be configured for a BGP peer.

The configuration of a peer takes precedence over that of the peer group to which the peer belongs.

SSL/TLS certification takes effect only when SSL/TLS certification is enabled on the server (SSL/TLS certification is not required on the client), the SSL client and server are configured, SSL policies are applied to the client and server."
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "peer.*keychain"
</custom_item>


<custom_item>
  description : "Configure BGP TLS authentication."
  info        : "The Secure Sockets Layer (SSL) protocol protects data privacy based on the Internet. It allows a client and a server to communicate in a way designed to prevent eavesdropping. Specifically, to ensure data transmission security on a network, a peer or peer group needs to be configured as an SSL client using the peer ssl-policy role client or as a server using the peer ssl-policy role server command, and the SSL data encryption, identity authentication, and message integrity verification mechanisms need to be used."
  solution    : "
a.
Run system-view
The system view is displayed.
b.
Run bgp { as-number-plain | as-number-dot }
The BGP view is displayed.
c.
Run peer { group-name | ipv4-address } ssl-server certificate
SSL/TLS certification is enabled on an SSL server.
d.
Run peer { group-name | ipv4-address } ssl-policy name ssl-policy-name
The SSL policy is applied to the SSL client or server.
e.
Run peer { group-name | ipv4-address } ssl-policy role { client | server }
A peer or peer group is configured as an SSL client or server.
f.
Run commit
The configuration is committed.
The peer as-number command has been run to create a peer.
SSL/TLS certification can be enabled only on servers. BGP MD5 authentication is
mutually exclusive with BGP keychain authentication and only one of them can be
configured for a BGP peer.
The configuration of a peer takes precedence over that of the peer group to which the
peer belongs.
SSL/TLS certification takes effect only when SSL/TLS certification is enabled on the
server (SSL/TLS certification is not required on the client), the SSL client and server are
configured, SSL policies are applied to the client and server."
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "peer.*(group-name|ipv4-address).*ssl-policy"
</custom_item>


<custom_item>
  description : "Application Layer Association"
  info        : "Security Policy:
The control plane is associated with the forwarding plane to control invalid packets, reduce attacks caused by device vulnerabilities, and ensure security on the control and forwarding planes. The control plane detects changes in protocols, centrally processes the characteristics of these changes, establishes a characteristics status table, and informs the forwarding plane of the changed status.

Protocol switch: Security policies can be configured on interfaces, boards, and an entire device. Packets for which the protocol switch is disabled are discarded or sent using very little bandwidth. This prevents exhaustion of CPU resources and ensures proper network operations.

Whitelist: A whitelist protects dynamic protocol sessions. Once a session is successfully established using TCP or UDP, the device dynamically sends a whitelist for this protocol and ensures that packets are sent reliably using sufficient bandwidth. The whitelist matching condition contains a quintuple, which includes the source IP address, destination IP address, source port ID, destination port ID, and protocol ID.

When processing protocol packets, an application layer association first matches them with the whitelist. The packets matching the whitelist are sent using sufficient bandwidth at a higher rate. Secondly, the application layer association matches protocol packets with an enabled protocol and then sends the packets matching the protocol at a specified rate. If the protocol has not been configured, the system assigns the default minimum bandwidth to packets of this protocol.

Finally, policies can be set for the packets that do not match any whitelist or protocol so that packets are either discarded or sent at a specified low rate.

Attack Methods
In Figure 7-4, a device is connected to a large number of users. Additionally, several services (such as routing, HWTACACS, ICMP, IGMP, and MPLS) are enabled on the device, but these services do not need to be transmitted using Telnet. If an attacker sends an excessive number of Telnet requests, the device has to waste resources processing these requests. To prevent this risk, you can disable Telnet on the device. The device then assigns the default minimum bandwidth to Telnet packets, regardless of how many Telnet packets need to be processed. This implementation helps improve system security and prevent Telnet packets from consuming excessive resources."
  solution    : "Configuration and Maintenance Methods
Run the application-apperceive default-action { drop | min-to-cp } command to configure the default action for packets. The default action is taken when no matching application layer association policy is found. The default action is min-to-cp, indicating that the system assigns the default minimum bandwidth to packets that do not match any policies.

Configuration and Maintenance Suggestions
Configuration and maintenance methods are irrelevant to configurations."
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "application-apperceive default-action (drop|min-to-cp)"
</custom_item>


<custom_item>
  description : "IPv4 Management Plane Access Control"
  info        : "Security Policy:
Management Plane Access Control (MPAC) enhances system security by protecting devices against Denial of Service (DoS) attacks.

In a common deployment scenario, the Router may run multiple services at the same time, such as Layer 2 services MSTP, RRPP, routing services OSPF and BGP, MPLS services LDP and RSVP, system service TFTP server, and diagnostic functions ping and tracert.

This enables attackers to send various attack packets to the Router. Unless protective features such as MPAC are enabled, the Router sends packets destined for its interfaces (including the loopback interface) directly to the CPU without any filtering. As a result, CPU and system resources are wasted and the system comes under DoS attacks.

To prevent such attacks, define an MPAC policy to filter packets.

The NE40E supports definitions of Management Plane Access Control (MPAC) policies that can be applied to sub-interfaces, to interfaces, or globally on the NE40E.

After you define the rules for an MPAC policy, the NE40E filters packets destined for the CPU. If no such policy is defined, the CPU remains vulnerable to attacks.

Attack Modes
To prevent an attacker from sending various types of TCP/IP attack packets to paralyze Device A, MPAC is deployed on Device A"
  solution    : "Configuration and Maintenance Methods
Configure IPv4 MPAC on Device A.

<DeviceA> system-view
[~DeviceA] service-security policy ipv4 test
[*DeviceA-service-sec-test] rule 10 deny protocol ip source-ip 10.10.1.1 0
[*DeviceA-service-sec-test] step 10
[*DeviceA-service-sec-test] description rule 10 is deny ip packet which from 10.10.1.1
[*DeviceA-service-sec-test] commit
[~DeviceA-service-sec-test] quit
[~DeviceA] service-security global-binding ipv4 test
[*DeviceA] commit
[~DeviceA] interface gigabitethernet 0/1/0
[~DeviceA-GigabitEthernet0/1/0] service-security binding ipv4 test
[*DeviceA-GigabitEthernet0/1/0] commit"
  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
  expect  : "service-security global-binding ipv4"
</custom_item>



#####TEMPLATE:
#<custom_item>
#  description : ""
#  info        : ""
#  solution    : ""
#  reference   : "800-171|3.5.1,800-53|IA-2.,CN-L3|7.1.3.1(a),CN-L3|7.1.3.1(e),CN-L3|8.1.4.1(a),CN-L3|8.1.4.2(a),CN-L3|8.5.4.1(a),SANS-CSC|16-12,CSF|PR.AC-1,ITSG-33|IA-2,ITSG-33|IA-2a.,NESA|T2.3.8,NESA|T5.3.1,NESA|T5.4.2,NESA|T5.5.1,NESA|T5.5.2,NESA|T5.5.3,NIAv2|AM2,NIAv2|AM8,NIAv2|AM14b,PCI-DSS|7.2,QCSC-v1|5.2.2,QCSC-v1|13.2,TBA-FIISB|35.1,TBA-FIISB|36.1"
#  see_also    : "https://support.huawei.com/enterprisesearch/?lang=en#keyword=router%2520security%2520hardening&type=ALL&lang=en&searchType=ALL&searchCount=1"
#  expect  : ""
#</custom_item>
#####TEMPLATE:

##################################################################
##################################################################
######################### MANUAL ADD ONS #########################
</check_type>
